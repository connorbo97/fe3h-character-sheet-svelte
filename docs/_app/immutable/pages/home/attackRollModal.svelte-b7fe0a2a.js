import{S as Wl,i as Pl,s as Fl,l as h,r as k,a as A,m as b,n as p,u as C,h as u,c as E,p as g,q as rl,Q as Oe,b as V,J as r,K as Be,f as ve,t as Ue,d as tl,v as L,L as Hl,a3 as Ll,g as sl,w as Nl,x as Ml,y as wl,B as Bl,T as Ol,E as jl,e as Je}from"../../chunks/index-d5d48e27.js";import{S as Ul}from"../../chunks/SvelteTip-cf62352a.js";import{C as ql}from"../../chunks/constants-56e6b6a8.js";import{p as Ke,H as Gl,g as Kl,j as qe,r as xe,D as ll,l as $e,m as Jl,n as Ql,d as Xe,o as il,q as Xl,t as nl}from"../../chunks/weaponLevel-1d872777.js";import{c as el,T as zl}from"../../chunks/enums-eee6a708.js";import{a as Qe}from"../../chunks/utils-edd64bc1.js";function fl(t){let e,l,s,i,a,o,f,c,n=t[11]&&cl(t);return{c(){e=h("div"),l=h("h3"),s=k("Attack"),i=A(),a=h("div"),o=k(t[25]),f=A(),n&&n.c(),this.h()},l(_){e=b(_,"DIV",{class:!0});var m=p(e);l=b(m,"H3",{class:!0});var v=p(l);s=C(v,"Attack"),v.forEach(u),i=E(m),a=b(m,"DIV",{class:!0});var R=p(a);o=C(R,t[25]),R.forEach(u),f=E(m),n&&n.l(m),m.forEach(u),this.h()},h(){g(l,"class","svelte-inr05g"),g(a,"class","content svelte-inr05g"),g(e,"class","attack svelte-inr05g")},m(_,m){V(_,e,m),r(e,l),r(l,s),r(e,i),r(e,a),r(a,o),r(e,f),n&&n.m(e,null),c=!0},p(_,m){(!c||m[0]&33554432)&&L(o,_[25]),_[11]?n?(n.p(_,m),m[0]&2048&&ve(n,1)):(n=cl(_),n.c(),ve(n,1),n.m(e,null)):n&&(sl(),Ue(n,1,1,()=>{n=null}),tl())},i(_){c||(ve(n),c=!0)},o(_){Ue(n),c=!1},d(_){_&&u(e),n&&n.d()}}}function cl(t){let e,l;return e=new Ul({props:{$$slots:{t:[Zl],default:[Yl]},$$scope:{ctx:t}}}),{c(){Nl(e.$$.fragment)},l(s){Ml(e.$$.fragment,s)},m(s,i){wl(e,s,i),l=!0},p(s,i){const a={};i[0]&262144|i[2]&16&&(a.$$scope={dirty:i,ctx:s}),e.$set(a)},i(s){l||(ve(e.$$.fragment,s),l=!0)},o(s){Ue(e.$$.fragment,s),l=!1},d(s){Bl(e,s)}}}function Yl(t){let e,l,s,i;return{c(){e=h("button"),l=k("Re-roll"),this.h()},l(a){e=b(a,"BUTTON",{class:!0});var o=p(e);l=C(o,"Re-roll"),o.forEach(u),this.h()},h(){g(e,"class","re-roller svelte-inr05g")},m(a,o){V(a,e,o),r(e,l),s||(i=Be(e,"click",function(){Ol(t[18])&&t[18].apply(this,arguments)}),s=!0)},p(a,o){t=a},d(a){a&&u(e),s=!1,i()}}}function Zl(t){let e,l;return{c(){e=h("div"),l=k(`Only meant to be used for advantage/disadvantage. Will not automatically decrement
									your superiority die or weapon uses`),this.h()},l(s){e=b(s,"DIV",{slot:!0,class:!0});var i=p(e);l=C(i,`Only meant to be used for advantage/disadvantage. Will not automatically decrement
									your superiority die or weapon uses`),i.forEach(u),this.h()},h(){g(e,"slot","t"),g(e,"class","svelte-inr05g")},m(s,i){V(s,e,i),r(e,l)},p:jl,d(s){s&&u(e)}}}function ul(t){let e,l,s,i,a,o,f;return{c(){e=h("div"),l=h("h3"),s=k("Crit Range"),i=A(),a=h("div"),o=h("span"),f=k(t[21]),this.h()},l(c){e=b(c,"DIV",{class:!0});var n=p(e);l=b(n,"H3",{class:!0});var _=p(l);s=C(_,"Crit Range"),_.forEach(u),i=E(n),a=b(n,"DIV",{class:!0});var m=p(a);o=b(m,"SPAN",{});var v=p(o);f=C(v,t[21]),v.forEach(u),m.forEach(u),n.forEach(u),this.h()},h(){g(l,"class","svelte-inr05g"),g(a,"class","content svelte-inr05g"),g(e,"class","crit svelte-inr05g")},m(c,n){V(c,e,n),r(e,l),r(l,s),r(e,i),r(e,a),r(a,o),r(o,f)},p(c,n){n[0]&2097152&&L(f,c[21])},d(c){c&&u(e)}}}function dl(t){let e,l;return e=new Ul({props:{tooltipStyle:zl.CENTER,$$slots:{t:[$l],default:[xl]},$$scope:{ctx:t}}}),{c(){Nl(e.$$.fragment)},l(s){Ml(e.$$.fragment,s)},m(s,i){wl(e,s,i),l=!0},p(s,i){const a={};i[0]&48|i[2]&16&&(a.$$scope={dirty:i,ctx:s}),e.$set(a)},i(s){l||(ve(e.$$.fragment,s),l=!0)},o(s){Ue(e.$$.fragment,s),l=!1},d(s){Bl(e,s)}}}function _l(t){let e,l,s;return{c(){e=h("span"),l=k("DC "),s=k(t[5])},l(i){e=b(i,"SPAN",{});var a=p(e);l=C(a,"DC "),s=C(a,t[5]),a.forEach(u)},m(i,a){V(i,e,a),r(e,l),r(e,s)},p(i,a){a[0]&32&&L(s,i[5])},d(i){i&&u(e)}}}function xl(t){let e,l,s,i=il[t[4]]+"",a,o,f,c=t[5]&&t[5]<=20&&_l(t);return{c(){e=h("div"),l=h("h3"),s=k("Crest of "),a=k(i),o=A(),f=h("div"),c&&c.c(),this.h()},l(n){e=b(n,"DIV",{class:!0});var _=p(e);l=b(_,"H3",{class:!0});var m=p(l);s=C(m,"Crest of "),a=C(m,i),m.forEach(u),o=E(_),f=b(_,"DIV",{class:!0});var v=p(f);c&&c.l(v),v.forEach(u),_.forEach(u),this.h()},h(){g(l,"class","svelte-inr05g"),g(f,"class","content svelte-inr05g"),g(e,"class","crest svelte-inr05g")},m(n,_){V(n,e,_),r(e,l),r(l,s),r(l,a),r(e,o),r(e,f),c&&c.m(f,null)},p(n,_){_[0]&16&&i!==(i=il[n[4]]+"")&&L(a,i),n[5]&&n[5]<=20?c?c.p(n,_):(c=_l(n),c.c(),c.m(f,null)):c&&(c.d(1),c=null)},d(n){n&&u(e),c&&c.d()}}}function $l(t){let e,l=Xe[t[4]].description+"",s;return{c(){e=h("div"),s=k(l),this.h()},l(i){e=b(i,"DIV",{slot:!0,class:!0});var a=p(e);s=C(a,l),a.forEach(u),this.h()},h(){g(e,"slot","t"),g(e,"class","svelte-inr05g")},m(i,a){V(i,e,a),r(e,s)},p(i,a){a[0]&16&&l!==(l=Xe[i[4]].description+"")&&L(s,l)},d(i){i&&u(e)}}}function ml(t){var m;let e,l,s=t[11]!==""&&t[12]!==""?`${t[11]} + ${t[12]} = ${t[11]+t[12]}`:"...",i,a,o,f,c=t[11]!==""&&((m=t[1].fullFeatures[t[8]])==null?void 0:m.description)&&vl(t),n=t[16]>1&&hl(t),_=t[16]<1&&bl();return{c(){e=h("div"),l=h("div"),i=k(s),a=A(),c&&c.c(),o=A(),n&&n.c(),f=A(),_&&_.c(),this.h()},l(v){e=b(v,"DIV",{class:!0});var R=p(e);l=b(R,"DIV",{});var D=p(l);i=C(D,s),D.forEach(u),a=E(R),c&&c.l(R),o=E(R),n&&n.l(R),f=E(R),_&&_.l(R),R.forEach(u),this.h()},h(){g(e,"class","attack svelte-inr05g")},m(v,R){V(v,e,R),r(e,l),r(l,i),r(e,a),c&&c.m(e,null),r(e,o),n&&n.m(e,null),r(e,f),_&&_.m(e,null)},p(v,R){var D;R[0]&6144&&s!==(s=v[11]!==""&&v[12]!==""?`${v[11]} + ${v[12]} = ${v[11]+v[12]}`:"...")&&L(i,s),v[11]!==""&&((D=v[1].fullFeatures[v[8]])==null?void 0:D.description)?c?c.p(v,R):(c=vl(v),c.c(),c.m(e,o)):c&&(c.d(1),c=null),v[16]>1?n?n.p(v,R):(n=hl(v),n.c(),n.m(e,f)):n&&(n.d(1),n=null),v[16]<1?_||(_=bl(),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(v){v&&u(e),c&&c.d(),n&&n.d(),_&&_.d()}}}function vl(t){var i;let e,l=((i=t[1].fullFeatures[t[8]])==null?void 0:i.description)+"",s;return{c(){e=h("div"),s=k(l),this.h()},l(a){e=b(a,"DIV",{class:!0});var o=p(e);s=C(o,l),o.forEach(u),this.h()},h(){g(e,"class","combat-art-note svelte-inr05g")},m(a,o){V(a,e,o),r(e,s)},p(a,o){var f;o[0]&258&&l!==(l=((f=a[1].fullFeatures[a[8]])==null?void 0:f.description)+"")&&L(s,l)},d(a){a&&u(e)}}}function hl(t){let e,l,s=t[16]-1+"",i,a;return{c(){e=h("div"),l=k("Cost "),i=k(s),a=k(" extra superiority die"),this.h()},l(o){e=b(o,"DIV",{class:!0});var f=p(e);l=C(f,"Cost "),i=C(f,s),a=C(f," extra superiority die"),f.forEach(u),this.h()},h(){g(e,"class","cf svelte-inr05g")},m(o,f){V(o,e,f),r(e,l),r(e,i),r(e,a)},p(o,f){f[0]&65536&&s!==(s=o[16]-1+"")&&L(i,s)},d(o){o&&u(e)}}}function bl(t){let e,l;return{c(){e=h("div"),l=k("Cost 0 superiority die"),this.h()},l(s){e=b(s,"DIV",{class:!0});var i=p(e);l=C(i,"Cost 0 superiority die"),i.forEach(u),this.h()},h(){g(e,"class","cs svelte-inr05g")},m(s,i){V(s,e,i),r(e,l)},d(s){s&&u(e)}}}function pl(t){let e,l,s=t[14]!==""&&gl(t),i=t[14]===""&&Cl();return{c(){e=h("div"),s&&s.c(),l=A(),i&&i.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var o=p(e);s&&s.l(o),l=E(o),i&&i.l(o),o.forEach(u),this.h()},h(){g(e,"class","crit svelte-inr05g")},m(a,o){V(a,e,o),s&&s.m(e,null),r(e,l),i&&i.m(e,null)},p(a,o){a[14]!==""?s?s.p(a,o):(s=gl(a),s.c(),s.m(e,l)):s&&(s.d(1),s=null),a[14]===""?i||(i=Cl(),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(a){a&&u(e),s&&s.d(),i&&i.d()}}}function gl(t){let e,l,s=t[14]>=20-t[3]?"CRIT":"Normal",i,a,o,f,c,n,_,m,v,R,D=t[14]>=20-t[3]&&kl(t);return{c(){e=h("div"),l=h("span"),i=k(s),o=A(),f=h("span"),c=k("("),n=k(t[14]),_=k(")"),v=A(),D&&D.c(),R=Je(),this.h()},l(y){e=b(y,"DIV",{class:!0});var B=p(e);l=b(B,"SPAN",{class:!0});var he=p(l);i=C(he,s),he.forEach(u),o=E(B),f=b(B,"SPAN",{class:!0});var X=p(f);c=C(X,"("),n=C(X,t[14]),_=C(X,")"),X.forEach(u),B.forEach(u),v=E(y),D&&D.l(y),R=Je(),this.h()},h(){g(l,"class",a=Oe(t[14]>=20-t[3]?"cs":"")+" svelte-inr05g"),g(f,"class",m=Oe(t[14]===20?"cs":"")+" svelte-inr05g"),g(e,"class","")},m(y,B){V(y,e,B),r(e,l),r(l,i),r(e,o),r(e,f),r(f,c),r(f,n),r(f,_),V(y,v,B),D&&D.m(y,B),V(y,R,B)},p(y,B){B[0]&16392&&s!==(s=y[14]>=20-y[3]?"CRIT":"Normal")&&L(i,s),B[0]&16392&&a!==(a=Oe(y[14]>=20-y[3]?"cs":"")+" svelte-inr05g")&&g(l,"class",a),B[0]&16384&&L(n,y[14]),B[0]&16384&&m!==(m=Oe(y[14]===20?"cs":"")+" svelte-inr05g")&&g(f,"class",m),y[14]>=20-y[3]?D?D.p(y,B):(D=kl(y),D.c(),D.m(R.parentNode,R)):D&&(D.d(1),D=null)},d(y){y&&u(e),y&&u(v),D&&D.d(y),y&&u(R)}}}function kl(t){let e,l=t[14]===20?"3":"2",s,i;return{c(){e=h("div"),s=k(l),i=k("x Damage")},l(a){e=b(a,"DIV",{});var o=p(e);s=C(o,l),i=C(o,"x Damage"),o.forEach(u)},m(a,o){V(a,e,o),r(e,s),r(e,i)},p(a,o){o[0]&16384&&l!==(l=a[14]===20?"3":"2")&&L(s,l)},d(a){a&&u(e)}}}function Cl(t){let e;return{c(){e=k("...")},l(l){e=C(l,"...")},m(l,s){V(l,e,s)},d(l){l&&u(e)}}}function Dl(t){let e,l,s=t[15]!==""&&Rl(t),i=t[15]===""&&El();return{c(){e=h("div"),s&&s.c(),l=A(),i&&i.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var o=p(e);s&&s.l(o),l=E(o),i&&i.l(o),o.forEach(u),this.h()},h(){g(e,"class","crest svelte-inr05g")},m(a,o){V(a,e,o),s&&s.m(e,null),r(e,l),i&&i.m(e,null)},p(a,o){a[15]!==""?s?s.p(a,o):(s=Rl(a),s.c(),s.m(e,l)):s&&(s.d(1),s=null),a[15]===""?i||(i=El(),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(a){a&&u(e),s&&s.d(),i&&i.d()}}}function Rl(t){let e,l,s=t[20]&&yl(t),i=!t[20]&&Al(t);return{c(){s&&s.c(),e=A(),i&&i.c(),l=Je()},l(a){s&&s.l(a),e=E(a),i&&i.l(a),l=Je()},m(a,o){s&&s.m(a,o),V(a,e,o),i&&i.m(a,o),V(a,l,o)},p(a,o){a[20]?s?s.p(a,o):(s=yl(a),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),a[20]?i&&(i.d(1),i=null):i?i.p(a,o):(i=Al(a),i.c(),i.m(l.parentNode,l))},d(a){s&&s.d(a),a&&u(e),i&&i.d(a),a&&u(l)}}}function yl(t){let e,l,s,i,a,o,f,c,n,_=t[4]&&Tl(t);return{c(){e=h("div"),l=h("span"),s=k("ACTIVATED"),i=h("span"),a=k("("),o=k(t[15]),f=k(")"),c=A(),_&&_.c(),n=Je(),this.h()},l(m){e=b(m,"DIV",{});var v=p(e);l=b(v,"SPAN",{class:!0});var R=p(l);s=C(R,"ACTIVATED"),R.forEach(u),i=b(v,"SPAN",{});var D=p(i);a=C(D,"("),o=C(D,t[15]),f=C(D,")"),D.forEach(u),v.forEach(u),c=E(m),_&&_.l(m),n=Je(),this.h()},h(){g(l,"class","cs svelte-inr05g")},m(m,v){V(m,e,v),r(e,l),r(l,s),r(e,i),r(i,a),r(i,o),r(i,f),V(m,c,v),_&&_.m(m,v),V(m,n,v)},p(m,v){v[0]&32768&&L(o,m[15]),m[4]?_?_.p(m,v):(_=Tl(m),_.c(),_.m(n.parentNode,n)):_&&(_.d(1),_=null)},d(m){m&&u(e),m&&u(c),_&&_.d(m),m&&u(n)}}}function Tl(t){var i;let e,l=((i=Xe[t[4]])==null?void 0:i.description)+"",s;return{c(){e=h("div"),s=k(l),this.h()},l(a){e=b(a,"DIV",{class:!0});var o=p(e);s=C(o,l),o.forEach(u),this.h()},h(){g(e,"class","description svelte-inr05g")},m(a,o){V(a,e,o),r(e,s)},p(a,o){var f;o[0]&16&&l!==(l=((f=Xe[a[4]])==null?void 0:f.description)+"")&&L(s,l)},d(a){a&&u(e)}}}function Al(t){let e,l,s,i,a,o;return{c(){e=h("span"),l=k("Normal"),s=h("span"),i=k("("),a=k(t[15]),o=k(")")},l(f){e=b(f,"SPAN",{});var c=p(e);l=C(c,"Normal"),c.forEach(u),s=b(f,"SPAN",{});var n=p(s);i=C(n,"("),a=C(n,t[15]),o=C(n,")"),n.forEach(u)},m(f,c){V(f,e,c),r(e,l),V(f,s,c),r(s,i),r(s,a),r(s,o)},p(f,c){c[0]&32768&&L(a,f[15])},d(f){f&&u(e),f&&u(s)}}}function El(t){let e;return{c(){e=k("...")},l(l){e=C(l,"...")},m(l,s){V(l,e,s)},d(l){l&&u(e)}}}function Il(t){let e,l,s,i,a,o=parseInt(t[23])!==t[13],f=o&&Vl(t);return{c(){e=h("div"),l=h("span"),s=k(t[23]),a=A(),f&&f.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var n=p(e);l=b(n,"SPAN",{class:!0});var _=p(l);s=C(_,t[23]),_.forEach(u),a=E(n),f&&f.l(n),n.forEach(u),this.h()},h(){g(l,"class",i=Oe(el({mini:parseInt(t[23])!==t[13]}))+" svelte-inr05g"),g(e,"class","damage-text svelte-inr05g")},m(c,n){V(c,e,n),r(e,l),r(l,s),r(e,a),f&&f.m(e,null)},p(c,n){n[0]&8388608&&L(s,c[23]),n[0]&8396800&&i!==(i=Oe(el({mini:parseInt(c[23])!==c[13]}))+" svelte-inr05g")&&g(l,"class",i),n[0]&8396800&&(o=parseInt(c[23])!==c[13]),o?f?f.p(c,n):(f=Vl(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(c){c&&u(e),f&&f.d()}}}function Vl(t){let e,l,s;return{c(){e=h("span"),l=k("= "),s=k(t[24]),this.h()},l(i){e=b(i,"SPAN",{class:!0});var a=p(e);l=C(a,"= "),s=C(a,t[24]),a.forEach(u),this.h()},h(){g(e,"class","final-damage svelte-inr05g")},m(i,a){V(i,e,a),r(e,l),r(e,s)},p(i,a){a[0]&16777216&&L(s,i[24])},d(i){i&&u(e)}}}function Sl(t){let e;return{c(){e=k("...")},l(l){e=C(l,"...")},m(l,s){V(l,e,s)},d(l){l&&u(e)}}}function et(t){let e,l,s,i,a,o,f,c,n,_,m,v,R,D,y,B,he,X,Ge,We,ie,ae,F,Te,be,Re,oe,Ae,re=t[17]?"HP Restored":"Damage",Pe,Ee,x,pe=Ke(t[2])+"",Ie,Fe,Ve,w,$,ye,fe,H,ce,ge,j,S,ke=t[30]?t[26]<=0?"Out of weapon uses":"Out of Superiority Dies":t[7]?"Roll Attack":"Select a weapon",Se,ue,Ne,le,te,z,ne,ee,O,P,Y,He,M=!t[17]&&fl(t),U=!t[17]&&t[3]>=0&&ul(t),W=t[4]&&dl(t),q=!t[17]&&ml(t),G=!t[17]&&t[3]>=0&&pl(t),K=t[4]&&Dl(t),J=t[13]&&Il(t),Z=!t[13]&&Sl();return{c(){e=h("div"),l=h("div"),s=h("button"),i=k("Copy Results"),o=A(),f=h("button"),c=k("Copy Attack Result Only"),_=A(),m=h("button"),v=k("Copy Damage Result Only"),D=A(),y=h("button"),B=k("Copy Attack Command"),he=A(),X=h("button"),Ge=k("Back to Breakdown"),We=A(),ie=h("div"),ae=h("div"),F=h("div"),M&&M.c(),Te=A(),U&&U.c(),be=A(),W&&W.c(),Re=A(),oe=h("div"),Ae=h("h3"),Pe=k(re),Ee=A(),x=h("div"),Ie=k(pe),Fe=A(),Ve=A(),w=h("div"),q&&q.c(),$=A(),G&&G.c(),ye=A(),K&&K.c(),fe=A(),H=h("div"),J&&J.c(),ce=A(),Z&&Z.c(),ge=A(),j=h("div"),S=h("button"),Se=k(ke),le=A(),te=h("span"),z=h("span"),ne=k("Roll visual dice?"),ee=A(),O=h("input"),this.h()},l(de){e=b(de,"DIV",{class:!0});var N=p(e);l=b(N,"DIV",{class:!0});var d=p(l);s=b(d,"BUTTON",{class:!0});var T=p(s);i=C(T,"Copy Results"),T.forEach(u),o=E(d),f=b(d,"BUTTON",{class:!0});var I=p(f);c=C(I,"Copy Attack Result Only"),I.forEach(u),_=E(d),m=b(d,"BUTTON",{class:!0});var Q=p(m);v=C(Q,"Copy Damage Result Only"),Q.forEach(u),D=E(d),y=b(d,"BUTTON",{class:!0});var _e=p(y);B=C(_e,"Copy Attack Command"),_e.forEach(u),he=E(d),X=b(d,"BUTTON",{class:!0});var se=p(X);Ge=C(se,"Back to Breakdown"),se.forEach(u),d.forEach(u),We=E(N),ie=b(N,"DIV",{class:!0});var me=p(ie);ae=b(me,"DIV",{class:!0});var Le=p(ae);F=b(Le,"DIV",{class:!0});var Ce=p(F);M&&M.l(Ce),Te=E(Ce),U&&U.l(Ce),be=E(Ce),W&&W.l(Ce),Re=E(Ce),oe=b(Ce,"DIV",{class:!0});var Me=p(oe);Ae=b(Me,"H3",{class:!0});var De=p(Ae);Pe=C(De,re),De.forEach(u),Ee=E(Me),x=b(Me,"DIV",{class:!0});var je=p(x);Ie=C(je,pe),Fe=E(je),je.forEach(u),Me.forEach(u),Ce.forEach(u),Ve=E(Le),w=b(Le,"DIV",{class:!0});var we=p(w);q&&q.l(we),$=E(we),G&&G.l(we),ye=E(we),K&&K.l(we),fe=E(we),H=b(we,"DIV",{class:!0});var ze=p(H);J&&J.l(ze),ce=E(ze),Z&&Z.l(ze),ze.forEach(u),we.forEach(u),Le.forEach(u),ge=E(me),j=b(me,"DIV",{class:!0});var Ye=p(j);S=b(Ye,"BUTTON",{class:!0});var al=p(S);Se=C(al,ke),al.forEach(u),le=E(Ye),te=b(Ye,"SPAN",{});var Ze=p(te);z=b(Ze,"SPAN",{});var ol=p(z);ne=C(ol,"Roll visual dice?"),ol.forEach(u),ee=E(Ze),O=b(Ze,"INPUT",{type:!0}),Ze.forEach(u),Ye.forEach(u),me.forEach(u),N.forEach(u),this.h()},h(){s.disabled=a=t[11]==="",g(s,"class","svelte-inr05g"),f.disabled=n=t[11]==="",g(f,"class","svelte-inr05g"),m.disabled=R=t[11]==="",g(m,"class","svelte-inr05g"),g(y,"class","svelte-inr05g"),g(X,"class","svelte-inr05g"),rl(X,"flex","1",!1),g(l,"class","actions svelte-inr05g"),g(Ae,"class","svelte-inr05g"),g(x,"class","content svelte-inr05g"),g(oe,"class","damage svelte-inr05g"),g(F,"class","rolls svelte-inr05g"),g(H,"class","damage svelte-inr05g"),rl(H,"flex-direction","column",!1),g(w,"class","result svelte-inr05g"),g(ae,"class","rolls-container svelte-inr05g"),S.disabled=ue=t[30]||!t[7],g(S,"class",Ne=Oe(el("attack-button",{disabled:t[30]||!t[7]}))+" svelte-inr05g"),g(O,"type","checkbox"),O.checked=t[9],g(j,"class","attack-button-container svelte-inr05g"),g(ie,"class","content svelte-inr05g"),g(e,"class","container svelte-inr05g")},m(de,N){V(de,e,N),r(e,l),r(l,s),r(s,i),r(l,o),r(l,f),r(f,c),r(l,_),r(l,m),r(m,v),r(l,D),r(l,y),r(y,B),r(l,he),r(l,X),r(X,Ge),r(e,We),r(e,ie),r(ie,ae),r(ae,F),M&&M.m(F,null),r(F,Te),U&&U.m(F,null),r(F,be),W&&W.m(F,null),r(F,Re),r(F,oe),r(oe,Ae),r(Ae,Pe),r(oe,Ee),r(oe,x),r(x,Ie),r(x,Fe),r(ae,Ve),r(ae,w),q&&q.m(w,null),r(w,$),G&&G.m(w,null),r(w,ye),K&&K.m(w,null),r(w,fe),r(w,H),J&&J.m(H,null),r(H,ce),Z&&Z.m(H,null),r(ie,ge),r(ie,j),r(j,S),r(S,Se),r(j,le),r(j,te),r(te,z),r(z,ne),r(te,ee),r(te,O),P=!0,Y||(He=[Be(s,"click",t[56]),Be(f,"click",t[57]),Be(m,"click",t[58]),Be(y,"click",t[59]),Be(X,"click",function(){Ol(t[0])&&t[0].apply(this,arguments)}),Be(S,"click",t[60]),Be(O,"click",t[61])],Y=!0)},p(de,N){t=de,(!P||N[0]&2048&&a!==(a=t[11]===""))&&(s.disabled=a),(!P||N[0]&2048&&n!==(n=t[11]===""))&&(f.disabled=n),(!P||N[0]&2048&&R!==(R=t[11]===""))&&(m.disabled=R),t[17]?M&&(sl(),Ue(M,1,1,()=>{M=null}),tl()):M?(M.p(t,N),N[0]&131072&&ve(M,1)):(M=fl(t),M.c(),ve(M,1),M.m(F,Te)),!t[17]&&t[3]>=0?U?U.p(t,N):(U=ul(t),U.c(),U.m(F,be)):U&&(U.d(1),U=null),t[4]?W?(W.p(t,N),N[0]&16&&ve(W,1)):(W=dl(t),W.c(),ve(W,1),W.m(F,Re)):W&&(sl(),Ue(W,1,1,()=>{W=null}),tl()),(!P||N[0]&131072)&&re!==(re=t[17]?"HP Restored":"Damage")&&L(Pe,re),(!P||N[0]&4)&&pe!==(pe=Ke(t[2])+"")&&L(Ie,pe),t[17]?q&&(q.d(1),q=null):q?q.p(t,N):(q=ml(t),q.c(),q.m(w,$)),!t[17]&&t[3]>=0?G?G.p(t,N):(G=pl(t),G.c(),G.m(w,ye)):G&&(G.d(1),G=null),t[4]?K?K.p(t,N):(K=Dl(t),K.c(),K.m(w,fe)):K&&(K.d(1),K=null),t[13]?J?J.p(t,N):(J=Il(t),J.c(),J.m(H,ce)):J&&(J.d(1),J=null),t[13]?Z&&(Z.d(1),Z=null):Z||(Z=Sl(),Z.c(),Z.m(H,null)),(!P||N[0]&1140850816)&&ke!==(ke=t[30]?t[26]<=0?"Out of weapon uses":"Out of Superiority Dies":t[7]?"Roll Attack":"Select a weapon")&&L(Se,ke),(!P||N[0]&1073741952&&ue!==(ue=t[30]||!t[7]))&&(S.disabled=ue),(!P||N[0]&1073741952&&Ne!==(Ne=Oe(el("attack-button",{disabled:t[30]||!t[7]}))+" svelte-inr05g"))&&g(S,"class",Ne),(!P||N[0]&512)&&(O.checked=t[9])},i(de){P||(ve(M),ve(W),P=!0)},o(de){Ue(M),Ue(W),P=!1},d(de){de&&u(e),M&&M.d(),U&&U.d(),W&&W.d(),q&&q.d(),G&&G.d(),K&&K.d(),J&&J.d(),Z&&Z.d(),Y=!1,Hl(He)}}}function lt(t,e,l){let s,i,a,o,f,c,n,_,m,v,R,D,y,B,he,X,Ge,We,ie,ae,F,Te;var be=this&&this.__awaiter||function(d,T,I,Q){function _e(se){return se instanceof I?se:new I(function(me){me(se)})}return new(I||(I=Promise))(function(se,me){function Le(De){try{Me(Q.next(De))}catch(je){me(je)}}function Ce(De){try{Me(Q.throw(De))}catch(je){me(je)}}function Me(De){De.done?se(De.value):_e(De.value).then(Le,Ce)}Me((Q=Q.apply(d,T||[])).next())})},Re,oe;const Ae=Ll(ql.DB);let{playerName:re}=e,{onCloseModal:Pe}=e,{allWeapons:Ee}=e,{allCombatArts:x}=e,{weaponUses:pe}=e,{onUpdateWeaponUses:Ie}=e,{crestConservesResource:Fe}=e,{attackCalc:Ve}=e,{damageCalc:w}=e,{critModifier:$}=e,{combatArtDamageBonus:ye}=e,{crestType:fe}=e,{crestDC:H}=e,{crestDamage:ce}=e,{crestCombatArtDamageModifier:ge}=e,{selectedWeapon:j}=e,{selectedCombatArt:S}=e,{curSuperiorityDies:ke}=e,{setCurSuperiorityDie:Se}=e,{shouldDoVisualRolls:ue}=e,{toggleVisualRolls:Ne}=e,le="",te="",z="",ne="",ee="",O="",P=1,Y="",He=1,M=1,U=1;const W=()=>be(void 0,void 0,void 0,function*(){if(l(13,z=""),l(43,ne=""),Xl(w)){const d=w.filter(I=>!nl(I)),T=w.filter(nl);if(ue){const I=yield xe(T,{modifier:d});l(13,z=I.value),l(43,ne=I.resultText)}else{const{value:I,resultText:Q}=qe(w,{returnAsString:!0});l(13,z=I),l(43,ne=Q)}}else l(13,z=qe(w)),l(43,ne=z+"")}),q=()=>be(void 0,void 0,void 0,function*(){l(14,O=""),ue?l(14,O=yield xe([ll.d20],{clearTimeout:250,disableResultBox:!0}).then(d=>d.value)):l(14,O=$e(20)),l(45,P=O>=20-$?O===20?3:2:1)}),G=()=>{Qe(F())},K=()=>Qe(ie(!0)),J=()=>Qe(ae(!0)),Z=()=>Qe(We()),de=()=>Te().then(()=>Qe(F())),N=()=>Ne();return t.$$set=d=>{"playerName"in d&&l(31,re=d.playerName),"onCloseModal"in d&&l(0,Pe=d.onCloseModal),"allWeapons"in d&&l(32,Ee=d.allWeapons),"allCombatArts"in d&&l(1,x=d.allCombatArts),"weaponUses"in d&&l(33,pe=d.weaponUses),"onUpdateWeaponUses"in d&&l(34,Ie=d.onUpdateWeaponUses),"crestConservesResource"in d&&l(35,Fe=d.crestConservesResource),"attackCalc"in d&&l(36,Ve=d.attackCalc),"damageCalc"in d&&l(2,w=d.damageCalc),"critModifier"in d&&l(3,$=d.critModifier),"combatArtDamageBonus"in d&&l(37,ye=d.combatArtDamageBonus),"crestType"in d&&l(4,fe=d.crestType),"crestDC"in d&&l(5,H=d.crestDC),"crestDamage"in d&&l(6,ce=d.crestDamage),"crestCombatArtDamageModifier"in d&&l(38,ge=d.crestCombatArtDamageModifier),"selectedWeapon"in d&&l(7,j=d.selectedWeapon),"selectedCombatArt"in d&&l(8,S=d.selectedCombatArt),"curSuperiorityDies"in d&&l(39,ke=d.curSuperiorityDies),"setCurSuperiorityDie"in d&&l(40,Se=d.setCurSuperiorityDie),"shouldDoVisualRolls"in d&&l(9,ue=d.shouldDoVisualRolls),"toggleVisualRolls"in d&&l(10,Ne=d.toggleVisualRolls)},t.$$.update=()=>{t.$$.dirty[0]&128&&(l(11,le=""),l(12,te=""),l(13,z=""),l(43,ne=""),l(44,ee=""),l(44,ee=""),l(14,O=""),l(45,P=1),l(15,Y="")),t.$$.dirty[0]&128&&l(17,s=Gl.has(j)),t.$$.dirty[0]&256&&l(50,i=()=>{var d;const T=(d=Kl[S])===null||d===void 0?void 0:d.dieCost;if(!S||!T)return 1;const I=qe([T.roll])>=T.target,Q=(T==null?void 0:T.mod)||0;return I?Math.max(1+Q,0):1}),t.$$.dirty[0]&128|t.$$.dirty[1]&4&&l(26,a=pe[j]===void 0?1/0:pe[j]),t.$$.dirty[0]&33376|t.$$.dirty[1]&8384&&l(49,_=()=>be(void 0,void 0,void 0,function*(){return l(15,Y=""),ue?l(15,Y=yield xe([ll.d20],{clearTimeout:250,disableResultBox:!0}).then(d=>d.value)):l(15,Y=$e(20)),Y>=H?ce.length?l(44,ee=qe(ce)):ge>1&&l(44,ee=Math.round(qe(ye)*ge)):l(44,ee=""),ee})),t.$$.dirty[0]&512|t.$$.dirty[1]&32&&l(18,c=()=>be(void 0,void 0,void 0,function*(){l(11,le=""),ue?l(11,le=yield xe([ll.d20],{clearTimeout:250,disableResultBox:!0}).then(d=>d.value)):l(11,le=$e(20)),l(12,te=qe(Ve))})),t.$$.dirty[0]&128|t.$$.dirty[1]&2050&&l(52,v=l(42,oe=Ee.fullFeatures[j])===null||oe===void 0?void 0:oe.label),t.$$.dirty[0]&258|t.$$.dirty[1]&1024&&l(55,m=S?` (${l(41,Re=x.fullFeatures[S])===null||Re===void 0?void 0:Re.label})`:""),t.$$.dirty[1]&18874368&&l(48,R=`${v}`+m),t.$$.dirty[0]&522680|t.$$.dirty[1]&1041179&&l(27,Te=()=>be(void 0,void 0,void 0,function*(){var d;l(16,He=1),l(47,U=1),l(46,M=1),l(11,le=""),l(13,z=""),l(43,ne=""),l(14,O=""),l(15,Y="");try{s||(yield c());const{roll:I=0,target:Q=1,mult:_e=1}=((d=Ee.fullFeatures[j])===null||d===void 0?void 0:d.dieCost)||{};l(16,He=i()*(qe([I])>=Q?_e:1)),!s&&$>=0&&(yield q()),fe&&(yield _(),Y>=H&&Fe&&(S?l(46,M=0):Jl.includes(j)&&l(47,U=0))),yield W()}catch(I){console.error(I),alert("wait until all rolls have finished")}const T={playerName:re,type:"ATTACK_ROLL",attackName:R};le!==""&&(T.attackRoll=le+te),O!==""&&(T.critRoll=O>=20-$?`CRIT${O===20?"(20)":""}`:"--"),Y!==""&&(T.crestName=il[fe]||"",T.crestRoll=Y>=H?"ACTIVATED":"--"),z!==""&&(T.damageRoll=(parseInt(z)+parseInt(ee||0))*P,s&&(T.isHealWeapon=!0)),Ql(Ae,T),U!==0&&Ie(j,-1*U),S&&Se(ke-He*M)})),t.$$.dirty[0]&32800&&l(20,o=Y>=H),t.$$.dirty[1]&32&&l(25,f=Ke(Ve,!0)),t.$$.dirty[0]&64|t.$$.dirty[1]&192&&l(53,n=()=>ce.length?Ke(ce):ge>1?`${ge}*${Ke(ye)}`:"0"),t.$$.dirty[0]&16392&&l(51,D=O>=20-$),t.$$.dirty[0]&8192|t.$$.dirty[1]&8192&&l(54,y=parseInt(z)+parseInt(ee||0)),t.$$.dirty[1]&1077248&&l(23,B=`${D?"(":""}${ne}${ee?` + ${ee}(crest)`:""}${D?`) * ${P} (crit)`:""}`),t.$$.dirty[1]&8404992&&l(24,he=P*y),t.$$.dirty[0]&8&&l(21,X=$===0?20:`${20-$} - 20`),t.$$.dirty[0]&67109120|t.$$.dirty[1]&256&&l(30,Ge=S&&ke<=0||a<=0),t.$$.dirty[0]&33554734|t.$$.dirty[1]&6291457&&l(29,We=()=>{var d;const I=$e(20),Q=20>20-$,_e=20>20-$,se=`${Ke(w)}${_e&&I>=H?`+${n()}`:""}`,me=`/roll ${se}${Q?"+"+(se+"+"+se):""}${_e?` [Crest Activated [${I}]]`:""}${Q?` [CRIT[${20}]]`:""} [ID${Math.floor(Math.random()*1e6)}]`;return`&{template:atk} {{rname=[${v}](\`${me})}} {{mod=${S?(d=x.fullFeatures[S])===null||d===void 0?void 0:d.label:"+0"}}} {{r1=[[1d20${f}]]}} {{normal=1}} {{charname=${re}}}`}),t.$$.dirty[0]&6402|t.$$.dirty[1]&2097153&&l(22,ie=(d=!1)=>{var T;const I=`&{template:simple} {{rname=Attack Roll}} {{normal=1}} {{r1=${le+te}}} {{charname=${le} + ${te}}}`;return d?[`&{template:desc} {{desc=${v}${S?` (${(T=x.fullFeatures[S])===null||T===void 0?void 0:T.label})`:""} attack roll from ${re}}}`,I].join(`
`):I}),t.$$.dirty[0]&25166082|t.$$.dirty[1]&2097153&&l(19,ae=(d=!1)=>{var T;const I=`&{template:simple} {{rname=Damage}} {{normal=1}} {{r1=${he}}} {{charname=${B}}}`;return d?[`&{template:desc} {{desc=${v}${S?` (${(T=x.fullFeatures[S])===null||T===void 0?void 0:T.label})`:""} damage roll from ${re}}}`,I].join(`
`):I}),t.$$.dirty[0]&7913778|t.$$.dirty[1]&3162113&&l(28,F=()=>{var d;const T=`&{template:desc} {{desc=${v}${S?` (${(d=x.fullFeatures[S])===null||d===void 0?void 0:d.label})`:""} attack from ${re}}}`,I=ie(),Q=O!==""?`&{template:simple} {{rname=Crit Roll}} {{mod=${X}}} {{r1=${D?"CRIT":"normal"} (${O})}} {{normal=1}} ${D?`{{charname=${P}x damage}}`:""}`:"",_e=fe&&Y!==""?`&{template:simple} {{rname=Crest Roll}} {{mod=DC ${H}}} {{r1=${o?"ACTIVATED":"normal"} (${Y})}}$ {{normal=1}} ${o?`{{charname=${Xe[fe].description}}}`:""}`:"",se=ae();return[T,I,Q,_e,se].join(`
`)})},[Pe,x,w,$,fe,H,ce,j,S,ue,Ne,le,te,z,O,Y,He,s,c,ae,o,X,ie,B,he,f,a,Te,F,We,Ge,re,Ee,pe,Ie,Fe,Ve,ye,ge,ke,Se,Re,oe,ne,ee,P,M,U,R,_,i,D,v,n,y,m,G,K,J,Z,de,N]}class nt extends Wl{constructor(e){super(),Pl(this,e,lt,et,Fl,{playerName:31,onCloseModal:0,allWeapons:32,allCombatArts:1,weaponUses:33,onUpdateWeaponUses:34,crestConservesResource:35,attackCalc:36,damageCalc:2,critModifier:3,combatArtDamageBonus:37,crestType:4,crestDC:5,crestDamage:6,crestCombatArtDamageModifier:38,selectedWeapon:7,selectedCombatArt:8,curSuperiorityDies:39,setCurSuperiorityDie:40,shouldDoVisualRolls:9,toggleVisualRolls:10},null,[-1,-1,-1])}}export{nt as default};
