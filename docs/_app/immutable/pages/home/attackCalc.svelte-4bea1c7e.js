import{S as ft,i as ut,s as ct,l as A,w as Cl,a as P,m as g,n as C,x as kl,c as M,h as u,p as T,Q as pt,b as N,J as f,y as Sl,f as ge,t as Ye,d as Nl,B as El,a3 as dt,r as h,u as m,v as R,e as pl,K as yl,Y as _t,q as ht,T as mt,g as Dl}from"../../chunks/index-d5d48e27.js";import{C as bt}from"../../chunks/constants-56e6b6a8.js";import{P as fl,W as vt,c as ul,d as Ke,e as ol,f as Pl,H as bl,b as Ml,g as vl,B as At,s as ll,h as gl,i as Al,j as gt,k as Ct,p as z}from"../../chunks/weaponLevel-1d872777.js";import{c as kt,a as dl,g as Rl}from"../../chunks/enums-eee6a708.js";import{g as cl,c as St,s as Et}from"../../chunks/utils-edd64bc1.js";import yt from"./attackCalcHeader.svelte-e2ccc629.js";import Tt from"./attackRollModal.svelte-b7fe0a2a.js";import Nt from"./queryPicker.svelte-52650412.js";import"../../chunks/SvelteTip-cf62352a.js";function Wl(t,l,e){const o=t.slice();return o[98]=l[e],o}function Ol(t){let l,e,o,s,r,a,i,n,c,p,b,k,v,d,E,ne,Ge,Ce=z(t[48])+"",ke,Je,fe,ee,pe=t[41]?"HP Restored":"Damage",Se,Oe,we,ie,Xe,le,de=z(t[46])+"",qe,Be,ue,x,Ie,_e=t[23]+t[22]+"",Ue,te,He,he=(t[22]>0?"+"+t[22]:t[22])+"",Ee,ze,ye,G,me,be,Te,$,Ne,Ze,ve,ae,De,Pe,ce,Me,I=t[31]&&wl(t),U=t[33]&&ql(t),H=t[34].length&&Bl(t),V=t[32]&&Il(t),L=t[35].length&&Ul(t),Q=t[30].length>0&&Hl(t),j=t[8]&&Vl(t),F=t[21]&&Jl(t),K=t[20].length&&Xl(t),O=t[19].length&&zl(t),w=t[45]>=0&&Zl(t),Y=t[45]<0&&xl(),q=t[8]&&$l(t),B=t[37]&&lt(t);return{c(){l=A("div"),e=A("div"),o=A("h2"),s=A("span"),r=h("Attack: 1d20"),a=P(),i=A("span"),I&&I.c(),n=P(),U&&U.c(),c=P(),H&&H.c(),p=P(),V&&V.c(),b=P(),L&&L.c(),k=P(),Q&&Q.c(),v=P(),d=A("h2"),E=h("= 1d20 "),ne=A("span"),Ge=h("+ "),ke=h(Ce),Je=P(),fe=A("div"),ee=A("h2"),Se=h(pe),Oe=h(": "),j&&j.c(),we=P(),ie=A("h2"),Xe=h("= "),le=A("span"),qe=h(de),Be=P(),ue=A("div"),x=A("h2"),Ie=h("Crit Modifier: "),Ue=h(_e),te=A("span"),He=h("(Dex"),Ee=h(he),ze=h(")"),ye=P(),G=A("span"),F&&F.c(),me=P(),K&&K.c(),be=P(),O&&O.c(),Te=P(),$=A("h2"),w&&w.c(),Ne=P(),Y&&Y.c(),Ze=P(),ve=A("div"),ae=A("h2"),De=h("Range: "),q&&q.c(),Pe=P(),ce=A("div"),Me=P(),B&&B.c(),this.h()},l(S){l=g(S,"DIV",{class:!0});var y=C(l);e=g(y,"DIV",{class:!0});var tl=C(e);o=g(tl,"H2",{class:!0});var se=C(o);s=g(se,"SPAN",{class:!0});var sl=C(s);r=m(sl,"Attack: 1d20"),sl.forEach(u),a=M(se),i=g(se,"SPAN",{class:!0});var J=C(i);I&&I.l(J),n=M(J),U&&U.l(J),c=M(J),H&&H.l(J),p=M(J),V&&V.l(J),b=M(J),L&&L.l(J),k=M(J),Q&&Q.l(J),J.forEach(u),se.forEach(u),tl.forEach(u),v=M(y),d=g(y,"H2",{class:!0});var oe=C(d);E=m(oe,"= 1d20 "),ne=g(oe,"SPAN",{class:!0});var Re=C(ne);Ge=m(Re,"+ "),ke=m(Re,Ce),Re.forEach(u),oe.forEach(u),Je=M(y),fe=g(y,"DIV",{class:!0});var Ve=C(fe);ee=g(Ve,"H2",{class:!0});var Le=C(ee);Se=m(Le,pe),Oe=m(Le,": "),j&&j.l(Le),Le.forEach(u),Ve.forEach(u),we=M(y),ie=g(y,"H2",{class:!0});var xe=C(ie);Xe=m(xe,"= "),le=g(xe,"SPAN",{});var W=C(le);qe=m(W,de),W.forEach(u),xe.forEach(u),Be=M(y),ue=g(y,"DIV",{class:!0});var il=C(ue);x=g(il,"H2",{class:!0});var Z=C(x);Ie=m(Z,"Crit Modifier: "),Ue=m(Z,_e),te=g(Z,"SPAN",{class:!0});var Qe=C(te);He=m(Qe,"(Dex"),Ee=m(Qe,he),ze=m(Qe,")"),Qe.forEach(u),ye=M(Z),G=g(Z,"SPAN",{class:!0});var Ae=C(G);F&&F.l(Ae),me=M(Ae),K&&K.l(Ae),be=M(Ae),O&&O.l(Ae),Ae.forEach(u),Z.forEach(u),il.forEach(u),Te=M(y),$=g(y,"H2",{class:!0});var je=C($);w&&w.l(je),Ne=M(je),Y&&Y.l(je),je.forEach(u),Ze=M(y),ve=g(y,"DIV",{class:!0});var $e=C(ve);ae=g($e,"H2",{class:!0});var al=C(ae);De=m(al,"Range: "),q&&q.l(al),al.forEach(u),$e.forEach(u),Pe=M(y),ce=g(y,"DIV",{class:!0}),C(ce).forEach(u),Me=M(y),B&&B.l(y),y.forEach(u),this.h()},h(){T(s,"class","calc-label"),T(i,"class","modifiers svelte-bl52el"),T(o,"class","content svelte-bl52el"),T(e,"class","calc attack-container svelte-bl52el"),T(ne,"class","modifiers svelte-bl52el"),T(d,"class","result attack-condensed svelte-bl52el"),T(ee,"class","content svelte-bl52el"),T(fe,"class","calc damage-container svelte-bl52el"),T(ie,"class","result damage-condensed svelte-bl52el"),T(te,"class","source svelte-bl52el"),T(G,"class","modifiers svelte-bl52el"),T(x,"class","content svelte-bl52el"),T(ue,"class","calc crit-container svelte-bl52el"),T($,"class","result crit-condensed svelte-bl52el"),T(ae,"class","content svelte-bl52el"),T(ve,"class","calc range-container svelte-bl52el"),T(ce,"class","empty range-condensed"),T(l,"class","calcs svelte-bl52el")},m(S,y){N(S,l,y),f(l,e),f(e,o),f(o,s),f(s,r),f(o,a),f(o,i),I&&I.m(i,null),f(i,n),U&&U.m(i,null),f(i,c),H&&H.m(i,null),f(i,p),V&&V.m(i,null),f(i,b),L&&L.m(i,null),f(i,k),Q&&Q.m(i,null),f(l,v),f(l,d),f(d,E),f(d,ne),f(ne,Ge),f(ne,ke),f(l,Je),f(l,fe),f(fe,ee),f(ee,Se),f(ee,Oe),j&&j.m(ee,null),f(l,we),f(l,ie),f(ie,Xe),f(ie,le),f(le,qe),f(l,Be),f(l,ue),f(ue,x),f(x,Ie),f(x,Ue),f(x,te),f(te,He),f(te,Ee),f(te,ze),f(x,ye),f(x,G),F&&F.m(G,null),f(G,me),K&&K.m(G,null),f(G,be),O&&O.m(G,null),f(l,Te),f(l,$),w&&w.m($,null),f($,Ne),Y&&Y.m($,null),f(l,Ze),f(l,ve),f(ve,ae),f(ae,De),q&&q.m(ae,null),f(l,Pe),f(l,ce),f(l,Me),B&&B.m(l,null)},p(S,y){S[31]?I?I.p(S,y):(I=wl(S),I.c(),I.m(i,n)):I&&(I.d(1),I=null),S[33]?U?U.p(S,y):(U=ql(S),U.c(),U.m(i,c)):U&&(U.d(1),U=null),S[34].length?H?H.p(S,y):(H=Bl(S),H.c(),H.m(i,p)):H&&(H.d(1),H=null),S[32]?V?V.p(S,y):(V=Il(S),V.c(),V.m(i,b)):V&&(V.d(1),V=null),S[35].length?L?L.p(S,y):(L=Ul(S),L.c(),L.m(i,k)):L&&(L.d(1),L=null),S[30].length>0?Q?Q.p(S,y):(Q=Hl(S),Q.c(),Q.m(i,null)):Q&&(Q.d(1),Q=null),y[1]&131072&&Ce!==(Ce=z(S[48])+"")&&R(ke,Ce),y[1]&1024&&pe!==(pe=S[41]?"HP Restored":"Damage")&&R(Se,pe),S[8]?j?j.p(S,y):(j=Vl(S),j.c(),j.m(ee,null)):j&&(j.d(1),j=null),y[1]&32768&&de!==(de=z(S[46])+"")&&R(qe,de),y[0]&12582912&&_e!==(_e=S[23]+S[22]+"")&&R(Ue,_e),y[0]&4194304&&he!==(he=(S[22]>0?"+"+S[22]:S[22])+"")&&R(Ee,he),S[21]?F?F.p(S,y):(F=Jl(S),F.c(),F.m(G,me)):F&&(F.d(1),F=null),S[20].length?K?K.p(S,y):(K=Xl(S),K.c(),K.m(G,be)):K&&(K.d(1),K=null),S[19].length?O?O.p(S,y):(O=zl(S),O.c(),O.m(G,null)):O&&(O.d(1),O=null),S[45]>=0?w?w.p(S,y):(w=Zl(S),w.c(),w.m($,Ne)):w&&(w.d(1),w=null),S[45]<0?Y||(Y=xl(),Y.c(),Y.m($,null)):Y&&(Y.d(1),Y=null),S[8]?q?q.p(S,y):(q=$l(S),q.c(),q.m(ae,null)):q&&(q.d(1),q=null),S[37]?B?B.p(S,y):(B=lt(S),B.c(),B.m(l,null)):B&&(B.d(1),B=null)},d(S){S&&u(l),I&&I.d(),U&&U.d(),H&&H.d(),V&&V.d(),L&&L.d(),Q&&Q.d(),j&&j.d(),F&&F.d(),K&&K.d(),O&&O.d(),w&&w.d(),Y&&Y.d(),q&&q.d(),B&&B.d()}}}function wl(t){let l,e,o,s,r;return{c(){l=A("span"),e=h("+ "),o=h(t[31]),s=A("span"),r=h("(dex)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);e=m(i,"+ "),o=m(i,t[31]),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(dex)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,e),f(l,o),f(l,s),f(s,r)},p(a,i){i[1]&1&&R(o,a[31])},d(a){a&&u(l)}}}function ql(t){let l,e=dl(t[33],!0)+"",o,s,r;return{c(){l=A("span"),o=h(e),s=A("span"),r=h("(weapon)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);o=m(i,e),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(weapon)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,o),f(l,s),f(s,r)},p(a,i){i[1]&4&&e!==(e=dl(a[33],!0)+"")&&R(o,e)},d(a){a&&u(l)}}}function Bl(t){let l,e,o=z(t[34])+"",s,r,a;return{c(){l=A("span"),e=h("+ "),s=h(o),r=A("span"),a=h("(combat art)"),this.h()},l(i){l=g(i,"SPAN",{});var n=C(l);e=m(n,"+ "),s=m(n,o),r=g(n,"SPAN",{class:!0});var c=C(r);a=m(c,"(combat art)"),c.forEach(u),n.forEach(u),this.h()},h(){T(r,"class","source svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(l,s),f(l,r),f(r,a)},p(i,n){n[1]&8&&o!==(o=z(i[34])+"")&&R(s,o)},d(i){i&&u(l)}}}function Il(t){let l,e=dl(t[32],!0)+"",o,s,r;return{c(){l=A("span"),o=h(e),s=A("span"),r=h("(distance)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);o=m(i,e),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(distance)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,o),f(l,s),f(s,r)},p(a,i){i[1]&2&&e!==(e=dl(a[32],!0)+"")&&R(o,e)},d(a){a&&u(l)}}}function Ul(t){let l,e,o=z(t[35])+"",s,r,a;return{c(){l=A("span"),e=h("+ "),s=h(o),r=A("span"),a=h("(combat skills)"),this.h()},l(i){l=g(i,"SPAN",{});var n=C(l);e=m(n,"+ "),s=m(n,o),r=g(n,"SPAN",{class:!0});var c=C(r);a=m(c,"(combat skills)"),c.forEach(u),n.forEach(u),this.h()},h(){T(r,"class","source svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(l,s),f(l,r),f(r,a)},p(i,n){n[1]&16&&o!==(o=z(i[35])+"")&&R(s,o)},d(i){i&&u(l)}}}function Hl(t){let l,e,o=z(ll(t[30]))+"",s,r,a;return{c(){l=A("span"),e=h("+ "),s=h(o),r=A("span"),a=h("(optionals)"),this.h()},l(i){l=g(i,"SPAN",{});var n=C(l);e=m(n,"+ "),s=m(n,o),r=g(n,"SPAN",{class:!0});var c=C(r);a=m(c,"(optionals)"),c.forEach(u),n.forEach(u),this.h()},h(){T(r,"class","source svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(l,s),f(l,r),f(r,a)},p(i,n){n[0]&1073741824&&o!==(o=z(ll(i[30]))+"")&&R(s,o)},d(i){i&&u(l)}}}function Vl(t){let l,e,o,s,r,a,i,n=t[16]&&(t[29]||[]).length<=1&&Ll(t),c=t[29]&&t[29].length>1&&Ql(t),p=t[27].length&&Fl(t),b=t[25]&&Kl(t),k=t[26].length&&Yl(t),v=t[24].length&&Gl(t);return{c(){l=h(t[28]),n&&n.c(),e=pl(),c&&c.c(),o=P(),s=A("span"),p&&p.c(),r=P(),b&&b.c(),a=P(),k&&k.c(),i=P(),v&&v.c(),this.h()},l(d){l=m(d,t[28]),n&&n.l(d),e=pl(),c&&c.l(d),o=M(d),s=g(d,"SPAN",{class:!0});var E=C(s);p&&p.l(E),r=M(E),b&&b.l(E),a=M(E),k&&k.l(E),i=M(E),v&&v.l(E),E.forEach(u),this.h()},h(){T(s,"class","modifiers svelte-bl52el")},m(d,E){N(d,l,E),n&&n.m(d,E),N(d,e,E),c&&c.m(d,E),N(d,o,E),N(d,s,E),p&&p.m(s,null),f(s,r),b&&b.m(s,null),f(s,a),k&&k.m(s,null),f(s,i),v&&v.m(s,null)},p(d,E){E[0]&268435456&&R(l,d[28]),d[16]&&(d[29]||[]).length<=1?n?n.p(d,E):(n=Ll(d),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),d[29]&&d[29].length>1?c?c.p(d,E):(c=Ql(d),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null),d[27].length?p?p.p(d,E):(p=Fl(d),p.c(),p.m(s,r)):p&&(p.d(1),p=null),d[25]?b?b.p(d,E):(b=Kl(d),b.c(),b.m(s,a)):b&&(b.d(1),b=null),d[26].length?k?k.p(d,E):(k=Yl(d),k.c(),k.m(s,i)):k&&(k.d(1),k=null),d[24].length?v?v.p(d,E):(v=Gl(d),v.c(),v.m(s,null)):v&&(v.d(1),v=null)},d(d){d&&u(l),n&&n.d(d),d&&u(e),c&&c.d(d),d&&u(o),d&&u(s),p&&p.d(),b&&b.d(),k&&k.d(),v&&v.d()}}}function Ll(t){let l,e,o,s,r;return{c(){l=A("span"),e=h("("),o=h(t[47]),s=h(")"),r=P()},l(a){l=g(a,"SPAN",{});var i=C(l);e=m(i,"("),o=m(i,t[47]),s=m(i,")"),i.forEach(u),r=M(a)},m(a,i){N(a,l,i),f(l,e),f(l,o),f(l,s),N(a,r,i)},p(a,i){i[1]&65536&&R(o,a[47])},d(a){a&&u(l),a&&u(r)}}}function Ql(t){let l,e,o,s,r,a=t[29],i=[];for(let n=0;n<a.length;n+=1)i[n]=jl(Wl(t,a,n));return{c(){l=A("select"),e=A("option"),o=h("-");for(let n=0;n<i.length;n+=1)i[n].c();this.h()},l(n){l=g(n,"SELECT",{});var c=C(l);e=g(c,"OPTION",{});var p=C(e);o=m(p,"-"),p.forEach(u);for(let b=0;b<i.length;b+=1)i[b].l(c);c.forEach(u),this.h()},h(){e.__value="",e.value=e.__value},m(n,c){N(n,l,c),f(l,e),f(e,o);for(let p=0;p<i.length;p+=1)i[p].m(l,null);s||(r=yl(l,"change",t[93]),s=!0)},p(n,c){if(c[0]&536936448){a=n[29];let p;for(p=0;p<a.length;p+=1){const b=Wl(n,a,p);i[p]?i[p].p(b,c):(i[p]=jl(b),i[p].c(),i[p].m(l,null))}for(;p<i.length;p+=1)i[p].d(1);i.length=a.length}},d(n){n&&u(l),_t(i,n),s=!1,r()}}}function jl(t){let l,e=gl[t[98]]+"",o,s,r;return{c(){l=A("option"),o=h(e),this.h()},l(a){l=g(a,"OPTION",{});var i=C(l);o=m(i,e),i.forEach(u),this.h()},h(){l.__value=s=t[98],l.value=l.__value,l.selected=r=t[98]===t[16]},m(a,i){N(a,l,i),f(l,o)},p(a,i){i[0]&536870912&&e!==(e=gl[a[98]]+"")&&R(o,e),i[0]&536870912&&s!==(s=a[98])&&(l.__value=s,l.value=l.__value),i[0]&536936448&&r!==(r=a[98]===a[16])&&(l.selected=r)},d(a){a&&u(l)}}}function Fl(t){let l,e,o=z(t[27])+"",s,r,a;return{c(){l=A("span"),e=h("+ "),s=h(o),r=A("span"),a=h("(weapon)"),this.h()},l(i){l=g(i,"SPAN",{});var n=C(l);e=m(n,"+ "),s=m(n,o),r=g(n,"SPAN",{class:!0});var c=C(r);a=m(c,"(weapon)"),c.forEach(u),n.forEach(u),this.h()},h(){T(r,"class","source svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(l,s),f(l,r),f(r,a)},p(i,n){n[0]&134217728&&o!==(o=z(i[27])+"")&&R(s,o)},d(i){i&&u(l)}}}function Kl(t){let l,e,o,s,r;return{c(){l=A("span"),e=h("+ "),o=h(t[25]),s=A("span"),r=h("(Heal Plus)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);e=m(i,"+ "),o=m(i,t[25]),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(Heal Plus)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,e),f(l,o),f(l,s),f(s,r)},p(a,i){i[0]&33554432&&R(o,a[25])},d(a){a&&u(l)}}}function Yl(t){let l,e,o,s,r;return{c(){l=A("span"),e=h("+ "),o=h(t[26]),s=A("span"),r=h("(combat art)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);e=m(i,"+ "),o=m(i,t[26]),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(combat art)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,e),f(l,o),f(l,s),f(s,r)},p(a,i){i[0]&67108864&&R(o,a[26])},d(a){a&&u(l)}}}function Gl(t){let l,e,o=z(ll(t[24]))+"",s,r,a;return{c(){l=A("span"),e=h("+ "),s=h(o),r=A("span"),a=h("(options)"),this.h()},l(i){l=g(i,"SPAN",{});var n=C(l);e=m(n,"+ "),s=m(n,o),r=g(n,"SPAN",{class:!0});var c=C(r);a=m(c,"(options)"),c.forEach(u),n.forEach(u),this.h()},h(){T(r,"class","source svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(l,s),f(l,r),f(r,a)},p(i,n){n[0]&16777216&&o!==(o=z(ll(i[24]))+"")&&R(s,o)},d(i){i&&u(l)}}}function Jl(t){let l,e=(t[21]>0?"+ "+t[21]:t[21])+"",o,s,r;return{c(){l=A("span"),o=h(e),s=A("span"),r=h("(weapon)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);o=m(i,e),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(weapon)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,o),f(l,s),f(s,r)},p(a,i){i[0]&2097152&&e!==(e=(a[21]>0?"+ "+a[21]:a[21])+"")&&R(o,e)},d(a){a&&u(l)}}}function Xl(t){let l,e,o=z(t[20])+"",s,r,a;return{c(){l=A("span"),e=h("+ "),s=h(o),r=A("span"),a=h("(combat art)"),this.h()},l(i){l=g(i,"SPAN",{});var n=C(l);e=m(n,"+ "),s=m(n,o),r=g(n,"SPAN",{class:!0});var c=C(r);a=m(c,"(combat art)"),c.forEach(u),n.forEach(u),this.h()},h(){T(r,"class","source svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(l,s),f(l,r),f(r,a)},p(i,n){n[0]&1048576&&o!==(o=z(i[20])+"")&&R(s,o)},d(i){i&&u(l)}}}function zl(t){let l,e,o,s,r;return{c(){l=A("span"),e=h("+ "),o=h(t[19]),s=A("span"),r=h("(options)"),this.h()},l(a){l=g(a,"SPAN",{});var i=C(l);e=m(i,"+ "),o=m(i,t[19]),s=g(i,"SPAN",{class:!0});var n=C(s);r=m(n,"(options)"),n.forEach(u),i.forEach(u),this.h()},h(){T(s,"class","source svelte-bl52el")},m(a,i){N(a,l,i),f(l,e),f(l,o),f(l,s),f(s,r)},p(a,i){i[0]&524288&&R(o,a[19])},d(a){a&&u(l)}}}function Zl(t){let l,e=Rl(t[45])+"",o;return{c(){l=h("= "),o=h(e)},l(s){l=m(s,"= "),o=m(s,e)},m(s,r){N(s,l,r),N(s,o,r)},p(s,r){r[1]&16384&&e!==(e=Rl(s[45])+"")&&R(o,e)},d(s){s&&u(l),s&&u(o)}}}function xl(t){let l;return{c(){l=h("= Can't Crit")},l(e){l=m(e,"= Can't Crit")},m(e,o){N(e,l,o)},d(e){e&&u(l)}}}function $l(t){let l,e,o,s=t[43]!==t[44]&&et(t);return{c(){l=h(t[44]),e=P(),s&&s.c(),o=pl()},l(r){l=m(r,t[44]),e=M(r),s&&s.l(r),o=pl()},m(r,a){N(r,l,a),N(r,e,a),s&&s.m(r,a),N(r,o,a)},p(r,a){a[1]&8192&&R(l,r[44]),r[43]!==r[44]?s?s.p(r,a):(s=et(r),s.c(),s.m(o.parentNode,o)):s&&(s.d(1),s=null)},d(r){r&&u(l),r&&u(e),s&&s.d(r),r&&u(o)}}}function et(t){let l,e;return{c(){l=h("to "),e=h(t[43])},l(o){l=m(o,"to "),e=m(o,t[43])},m(o,s){N(o,l,s),N(o,e,s)},p(o,s){s[1]&4096&&R(e,o[43])},d(o){o&&u(l),o&&u(e)}}}function lt(t){let l,e,o,s,r,a,i,n,c;return{c(){l=A("div"),e=A("h2"),o=h("Crest of "),s=h(t[53]),r=h(" (DC "),a=h(t[49]),i=h(`):
							`),n=A("span"),c=h("Hover your crest to see its effect"),this.h()},l(p){l=g(p,"DIV",{class:!0});var b=C(l);e=g(b,"H2",{class:!0});var k=C(e);o=m(k,"Crest of "),s=m(k,t[53]),r=m(k," (DC "),a=m(k,t[49]),i=m(k,`):
							`),n=g(k,"SPAN",{class:!0});var v=C(n);c=m(v,"Hover your crest to see its effect"),v.forEach(u),k.forEach(u),b.forEach(u),this.h()},h(){T(n,"class","crest-description svelte-bl52el"),T(e,"class","content svelte-bl52el"),T(l,"class","crest-container svelte-bl52el")},m(p,b){N(p,l,b),f(l,e),f(e,o),f(e,s),f(e,r),f(e,a),f(e,i),f(e,n),f(n,c)},p(p,b){b[1]&4194304&&R(s,p[53]),b[1]&262144&&R(a,p[49])},d(p){p&&u(l)}}}function tt(t){let l,e,o;return e=new Tt({props:{playerName:t[0],critModifier:t[45],crestCombatArtDamageModifier:t[51],selectedWeapon:t[8],weaponUses:t[6],onUpdateWeaponUses:t[7],crestConservesResource:t[50],selectedCombatArt:t[10],allWeapons:t[4],allCombatArts:t[5],curSuperiorityDies:t[12],setCurSuperiorityDie:t[13],onCloseModal:t[94],attackCalc:t[48],damageCalc:t[46],crestDC:t[37]?t[49]:1/0,crestDamage:t[52],crestType:t[37]?t[36]:"",combatArtDamageBonus:t[26],shouldDoVisualRolls:t[17],toggleVisualRolls:t[40]}}),{c(){l=A("div"),Cl(e.$$.fragment),this.h()},l(s){l=g(s,"DIV",{class:!0});var r=C(l);kl(e.$$.fragment,r),r.forEach(u),this.h()},h(){T(l,"class","attack-roll-container")},m(s,r){N(s,l,r),Sl(e,l,null),o=!0},p(s,r){const a={};r[0]&1&&(a.playerName=s[0]),r[1]&16384&&(a.critModifier=s[45]),r[1]&1048576&&(a.crestCombatArtDamageModifier=s[51]),r[0]&256&&(a.selectedWeapon=s[8]),r[0]&64&&(a.weaponUses=s[6]),r[0]&128&&(a.onUpdateWeaponUses=s[7]),r[1]&524288&&(a.crestConservesResource=s[50]),r[0]&1024&&(a.selectedCombatArt=s[10]),r[0]&16&&(a.allWeapons=s[4]),r[0]&32&&(a.allCombatArts=s[5]),r[0]&4096&&(a.curSuperiorityDies=s[12]),r[0]&8192&&(a.setCurSuperiorityDie=s[13]),r[1]&256&&(a.onCloseModal=s[94]),r[1]&131072&&(a.attackCalc=s[48]),r[1]&32768&&(a.damageCalc=s[46]),r[1]&262208&&(a.crestDC=s[37]?s[49]:1/0),r[1]&2097152&&(a.crestDamage=s[52]),r[1]&96&&(a.crestType=s[37]?s[36]:""),r[0]&67108864&&(a.combatArtDamageBonus=s[26]),r[0]&131072&&(a.shouldDoVisualRolls=s[17]),r[1]&512&&(a.toggleVisualRolls=s[40]),e.$set(a)},i(s){o||(ge(e.$$.fragment,s),o=!0)},o(s){Ye(e.$$.fragment,s),o=!1},d(s){s&&u(l),El(e)}}}function st(t){let l,e,o,s,r,a;return{c(){l=A("div"),e=A("button"),o=h("ATTACK"),this.h()},l(i){l=g(i,"DIV",{class:!0});var n=C(l);e=g(n,"BUTTON",{class:!0});var c=C(e);o=m(c,"ATTACK"),c.forEach(u),n.forEach(u),this.h()},h(){e.disabled=s=!t[8],T(e,"class","svelte-bl52el"),ht(e,"height","100%",!1),T(l,"class","rolls svelte-bl52el")},m(i,n){N(i,l,n),f(l,e),f(e,o),r||(a=yl(e,"click",function(){mt(t[42])&&t[42].apply(this,arguments)}),r=!0)},p(i,n){t=i,n[0]&256&&s!==(s=!t[8])&&(e.disabled=s)},d(i){i&&u(l),r=!1,a()}}}function it(t){let l,e,o,s,r,a,i,n;return e=new Nt({props:{queries:t[38],selections:t[15],onUpdateQuerySelection:t[54]}}),{c(){l=A("div"),Cl(e.$$.fragment),o=P(),s=A("button"),r=h("Reset Queries"),this.h()},l(c){l=g(c,"DIV",{class:!0});var p=C(l);kl(e.$$.fragment,p),o=M(p),s=g(p,"BUTTON",{class:!0});var b=C(s);r=m(b,"Reset Queries"),b.forEach(u),p.forEach(u),this.h()},h(){T(s,"class","reset svelte-bl52el"),T(l,"class","options svelte-bl52el")},m(c,p){N(c,l,p),Sl(e,l,null),f(l,o),f(l,s),f(s,r),a=!0,i||(n=yl(s,"click",t[95]),i=!0)},p(c,p){const b={};p[1]&128&&(b.queries=c[38]),p[0]&32768&&(b.selections=c[15]),p[1]&8388608&&(b.onUpdateQuerySelection=c[54]),e.$set(b)},i(c){a||(ge(e.$$.fragment,c),a=!0)},o(c){Ye(e.$$.fragment,c),a=!1},d(c){c&&u(l),El(e),i=!1,n()}}}function Dt(t){let l,e,o,s,r,a,i,n;o=new yt({props:{damageTypeSelection:t[16],weaponsToFeatures:t[18],allCombatArts:t[5],allWeapons:t[4],equippedCombatArts:t[2],equippedWeapons:t[3],selectedWeapon:t[8],setSelectedWeapon:t[9],selectedCombatArt:t[10],setSelectedCombatArt:t[11],distanceToTarget:t[14],setDistanceToTarget:t[55],equippedClass:t[1]}});let c=!t[39]&&Ol(t),p=t[39]&&tt(t),b=!t[39]&&st(t),k=t[38].length>0&&it(t);return{c(){l=A("div"),e=A("div"),Cl(o.$$.fragment),s=P(),c&&c.c(),r=P(),p&&p.c(),a=P(),b&&b.c(),i=P(),k&&k.c(),this.h()},l(v){l=g(v,"DIV",{class:!0});var d=C(l);e=g(d,"DIV",{class:!0});var E=C(e);kl(o.$$.fragment,E),s=M(E),c&&c.l(E),r=M(E),p&&p.l(E),a=M(E),b&&b.l(E),i=M(E),k&&k.l(E),E.forEach(u),d.forEach(u),this.h()},h(){T(e,"class",pt(kt("container"))+" svelte-bl52el"),T(l,"class","outer svelte-bl52el")},m(v,d){N(v,l,d),f(l,e),Sl(o,e,null),f(e,s),c&&c.m(e,null),f(e,r),p&&p.m(e,null),f(e,a),b&&b.m(e,null),f(e,i),k&&k.m(e,null),n=!0},p(v,d){const E={};d[0]&65536&&(E.damageTypeSelection=v[16]),d[0]&262144&&(E.weaponsToFeatures=v[18]),d[0]&32&&(E.allCombatArts=v[5]),d[0]&16&&(E.allWeapons=v[4]),d[0]&4&&(E.equippedCombatArts=v[2]),d[0]&8&&(E.equippedWeapons=v[3]),d[0]&256&&(E.selectedWeapon=v[8]),d[0]&512&&(E.setSelectedWeapon=v[9]),d[0]&1024&&(E.selectedCombatArt=v[10]),d[0]&2048&&(E.setSelectedCombatArt=v[11]),d[0]&16384&&(E.distanceToTarget=v[14]),d[0]&2&&(E.equippedClass=v[1]),o.$set(E),v[39]?c&&(c.d(1),c=null):c?c.p(v,d):(c=Ol(v),c.c(),c.m(e,r)),v[39]?p?(p.p(v,d),d[1]&256&&ge(p,1)):(p=tt(v),p.c(),ge(p,1),p.m(e,a)):p&&(Dl(),Ye(p,1,1,()=>{p=null}),Nl()),v[39]?b&&(b.d(1),b=null):b?b.p(v,d):(b=st(v),b.c(),b.m(e,i)),v[38].length>0?k?(k.p(v,d),d[1]&128&&ge(k,1)):(k=it(v),k.c(),ge(k,1),k.m(e,null)):k&&(Dl(),Ye(k,1,1,()=>{k=null}),Nl())},i(v){n||(ge(o.$$.fragment,v),ge(p),ge(k),n=!0)},o(v){Ye(o.$$.fragment,v),Ye(p),Ye(k),n=!1},d(v){v&&u(l),El(o),c&&c.d(),p&&p.d(),b&&b.d(),k&&k.d()}}}function Pt(t,l,e){let o,s,r,a,i,n,c,p,b,k,v,d,E,ne,Ge,Ce,ke,Je,fe,ee,pe,Se,Oe,we,ie,Xe,le,de,qe,Be,ue,x,Ie,_e,Ue,te,He,he,Ee,ze,ye,G,me,be,Te,$,Ne,Ze,ve,ae;var De,Pe,ce,Me,I,U,H,V,L,Q,j,F,K,O,w,Y,q,B;dt(bt.MODAL);let{playerName:S}=l,{equippedClass:y}=l,{equippedCombatArts:tl}=l,{equippedCombatSkills:se}=l,{equippedWeapons:sl}=l,{playerCrest:J}=l,{playerStats:oe}=l,{allWeapons:Re}=l,{allCombatArts:Ve}=l,{weaponUses:Le}=l,{onUpdateWeaponUses:xe}=l,{selectedWeapon:W}=l,{setSelectedWeapon:il}=l,{selectedCombatArt:Z}=l,{setSelectedCombatArt:Qe}=l,{curSuperiorityDies:Ae}=l,{setCurSuperiorityDie:je}=l,$e=1;const al=_=>e(14,$e=_);let _l,rl={current:null},X,nl={current:le},Fe="",hl=!0;const at=_=>{e(16,Fe=_.currentTarget.value)},ot=()=>e(39,_l=!1),rt=()=>{e(15,X=void 0)};return t.$$set=_=>{"playerName"in _&&e(0,S=_.playerName),"equippedClass"in _&&e(1,y=_.equippedClass),"equippedCombatArts"in _&&e(2,tl=_.equippedCombatArts),"equippedCombatSkills"in _&&e(56,se=_.equippedCombatSkills),"equippedWeapons"in _&&e(3,sl=_.equippedWeapons),"playerCrest"in _&&e(57,J=_.playerCrest),"playerStats"in _&&e(58,oe=_.playerStats),"allWeapons"in _&&e(4,Re=_.allWeapons),"allCombatArts"in _&&e(5,Ve=_.allCombatArts),"weaponUses"in _&&e(6,Le=_.weaponUses),"onUpdateWeaponUses"in _&&e(7,xe=_.onUpdateWeaponUses),"selectedWeapon"in _&&e(8,W=_.selectedWeapon),"setSelectedWeapon"in _&&e(9,il=_.setSelectedWeapon),"selectedCombatArt"in _&&e(10,Z=_.selectedCombatArt),"setSelectedCombatArt"in _&&e(11,Qe=_.setSelectedCombatArt),"curSuperiorityDies"in _&&e(12,Ae=_.curSuperiorityDies),"setCurSuperiorityDie"in _&&e(13,je=_.setCurSuperiorityDie)},t.$$.update=()=>{t.$$.dirty[0]&16&&e(18,o=Re.fullFeatures),t.$$.dirty[1]&134217728&&e(23,s=cl(oe[fl.DEX])),t.$$.dirty[0]&2|t.$$.dirty[1]&33554432&&e(85,r=St(y,se)),t.$$.dirty[0]&256&&e(87,a=vt[W]),t.$$.dirty[0]&262400|t.$$.dirty[1]&33554432&&e(92,i=()=>se.reduce((D,re)=>((ul[re].queries||[]).forEach((el,Tl)=>{var ml;if(el.compatibleWeapons.includes((ml=o[W])===null||ml===void 0?void 0:ml.type)){const nt=re+"__"+Tl;D[nt]=Object.assign(Object.assign({},el),{key:re+"__"+Tl})}}),D),{})),t.$$.dirty[2]&1073741824&&e(91,n=i()),t.$$.dirty[2]&536870912&&e(38,c=Object.values(n)),t.$$.dirty[1]&128&&e(90,p=c.map(_=>_.key)),t.$$.dirty[0]&32768|t.$$.dirty[1]&128|t.$$.dirty[2]&268468224&&(X?Et(new Set(rl.current),new Set(p))||(e(77,rl.current=p,rl),e(15,X=c.reduce((_,D)=>(_[D.key||""]=D.options[0],_),{}))):e(15,X=c.reduce((_,D)=>(_[D.key||""]=D.options[0],_),{}))),t.$$.dirty[0]&32768&&e(54,b=(_,D)=>{e(15,X=Object.assign(Object.assign({},X),{[_]:D}))}),t.$$.dirty[1]&335544320&&e(89,k=new Set(e(59,De=Ke[J.type])===null||De===void 0?void 0:De.triggersOn)),t.$$.dirty[0]&263424|t.$$.dirty[2]&167772160&&e(88,v=()=>{var _,D;return Z?k.has(ol.COMBAT_ART)||k.has(ol.ATTACK):a===Pl.REASON||a===Pl.FAITH?k.has(ol.MAGIC_ATTACK)&&((D=(_=o[W])===null||_===void 0?void 0:_.damage)===null||D===void 0?void 0:D[0])!==0&&!bl.has(W)||k.has(ol.HEAL)&&bl.has(W):k.has(ol.ATTACK)}),t.$$.dirty[1]&67108864&&e(36,d=J.type),t.$$.dirty[1]&536870944&&e(53,E=e(60,Pe=Ke[d])===null||Pe===void 0?void 0:Pe.label),t.$$.dirty[1]&1073741856&&(e(61,ce=Ke[d])===null||ce===void 0||ce.description),t.$$.dirty[1]&32|t.$$.dirty[2]&1&&e(52,ne=(e(62,Me=Ke[d])===null||Me===void 0?void 0:Me.damageBonus)||[]),t.$$.dirty[1]&32|t.$$.dirty[2]&2&&e(51,Ge=(e(63,I=Ke[d])===null||I===void 0?void 0:I.combatArtDamageMultiplier)||1),t.$$.dirty[1]&32|t.$$.dirty[2]&4&&e(50,Ce=(e(64,U=Ke[d])===null||U===void 0?void 0:U.conservesResource)||!1),t.$$.dirty[2]&67108864&&e(37,ke=v()),t.$$.dirty[1]&67108960&&e(49,Je=ke?Ke[d].activationDC[J.isMajor?Ml.MAJOR:Ml.MINOR]:1/0),t.$$.dirty[0]&8388608&&e(31,fe=s),t.$$.dirty[0]&262400|t.$$.dirty[2]&8&&e(33,ee=(e(65,H=o[W])===null||H===void 0?void 0:H.attackBonus)||0),t.$$.dirty[0]&1024|t.$$.dirty[2]&16&&e(34,pe=(e(66,V=vl[Z])===null||V===void 0?void 0:V.attackBonus)||[]),t.$$.dirty[1]&33554432|t.$$.dirty[2]&33554432&&e(35,Se=se.reduce((_,D)=>{var re,We;return[..._,...((re=ul[D].attackBonus)===null||re===void 0?void 0:re[a])||((We=ul[D].attackBonus)===null||We===void 0?void 0:We.ANY)||[]]},[])),t.$$.dirty[0]&32768&&e(30,Oe=Object.keys(X||{}).reduce((_,D)=>(X!=null&&X[D].attackBonus&&(_=[..._,...X[D].attackBonus||[]]),_),[])),t.$$.dirty[0]&16640&&e(32,we=At.includes(W)?Math.max($e-2,0)*-2:0),t.$$.dirty[0]&1073741824|t.$$.dirty[1]&31&&e(86,ie=[...Se,...pe,ee,we,fe,...Oe].filter(_=>_!==0)),t.$$.dirty[2]&16777216&&e(48,Xe=ll(ie)),t.$$.dirty[0]&262400|t.$$.dirty[2]&32&&e(29,le=e(67,L=o[W])===null||L===void 0?void 0:L.damageType),t.$$.dirty[0]&536936448|t.$$.dirty[2]&65536&&(!Fe||nl.current!==le)&&(e(78,nl.current=le,nl),le?e(16,Fe=le[0]):e(16,Fe=fl.STR)),t.$$.dirty[0]&65536|t.$$.dirty[1]&134217728&&e(28,de=cl(oe[Fe]||10)),t.$$.dirty[0]&65536&&e(47,qe=gl[Fe]),t.$$.dirty[0]&262400|t.$$.dirty[2]&64&&e(27,Be=[...(e(68,Q=o[W])===null||Q===void 0?void 0:Q.damage)||[]]),t.$$.dirty[0]&256|t.$$.dirty[2]&8388608&&e(25,ue=W===Al.HEAL&&r?2:0),t.$$.dirty[0]&1024|t.$$.dirty[2]&128&&e(26,x=(e(69,j=vl[Z])===null||j===void 0?void 0:j.damageBonus)||[]),t.$$.dirty[0]&32768&&e(24,Ie=Object.keys(X||{}).reduce((_,D)=>(X!=null&&X[D].damageBonus&&(_=[..._,...X[D].damageBonus||[]]),_),[])),t.$$.dirty[0]&520093696&&e(84,_e=[de,...Be,...x,ue,...Ie].filter(_=>_!==0)),t.$$.dirty[2]&4194304&&e(46,Ue=ll(_e)),t.$$.dirty[0]&262400|t.$$.dirty[2]&256&&e(21,He=(e(70,F=o[W])===null||F===void 0?void 0:F.critBonus)||0),t.$$.dirty[0]&1024|t.$$.dirty[2]&512&&e(20,he=(e(71,K=vl[Z])===null||K===void 0?void 0:K.critBonus)||[]),t.$$.dirty[0]&16252928&&e(45,ze=gt([s,te,He,...he,...Ee])),t.$$.dirty[0]&262402|t.$$.dirty[2]&15360&&e(82,ye=(e(74,Y=e(73,w=e(72,O=Ct[y])===null||O===void 0?void 0:O.whenEquipped)===null||w===void 0?void 0:w.bonusRange)===null||Y===void 0?void 0:Y[e(75,q=o[W])===null||q===void 0?void 0:q.type])||0),t.$$.dirty[0]&1056|t.$$.dirty[2]&16384&&e(83,G=e(76,B=Ve.fullFeatures[Z])===null||B===void 0?void 0:B.range),t.$$.dirty[0]&262400|t.$$.dirty[1]&33554432&&e(81,me=se.reduce((_,D)=>{var re,We,el;return _+(((We=(re=ul[D])===null||re===void 0?void 0:re.bonusRange)===null||We===void 0?void 0:We[(el=o[W])===null||el===void 0?void 0:el.type])||0)},0)),t.$$.dirty[0]&262400|t.$$.dirty[1]&134217728|t.$$.dirty[2]&3932160&&e(79,Te=()=>{var _;let D=G?[...G]:[...((_=o[W])===null||_===void 0?void 0:_.range)||[1]];return W===Al.RESTORE?D=[1,2+cl(oe[fl.INT])]:W===Al.PHYSIC&&(D=[1,2+2*cl(oe[fl.INT])]),D[1]===void 0&&(D[1]=D[0]),D[1]=parseInt(D[1]+"")+ye+me+be,D}),t.$$.dirty[2]&131072&&e(44,[$,Ne]=Te(),$,(e(43,Ne),e(79,Te),e(83,G),e(18,o),e(8,W),e(58,oe),e(82,ye),e(81,me),e(80,be),e(5,Ve),e(10,Z),e(76,B),e(4,Re),e(1,y),e(72,O),e(73,w),e(74,Y),e(75,q),e(56,se))),t.$$.dirty[0]&256&&e(41,ve=bl.has(W)),t.$$.dirty[0]&131072&&e(40,ae=()=>{e(17,hl=!hl)})},e(22,te=-1),e(19,Ee=[]),e(80,be=0),e(42,Ze=()=>e(39,_l=!0)),[S,y,tl,sl,Re,Ve,Le,xe,W,il,Z,Qe,Ae,je,$e,X,Fe,hl,o,Ee,he,He,te,s,Ie,ue,x,Be,de,le,Oe,fe,we,ee,pe,Se,d,ke,c,_l,ae,ve,Ze,Ne,$,ze,Ue,qe,Xe,Je,Ce,Ge,ne,E,b,al,se,J,oe,De,Pe,ce,Me,I,U,H,V,L,Q,j,F,K,O,w,Y,q,B,rl,nl,Te,be,me,ye,G,_e,r,ie,a,v,k,p,n,i,at,ot,rt]}class Ht extends ft{constructor(l){super(),ut(this,l,Pt,Dt,ct,{playerName:0,equippedClass:1,equippedCombatArts:2,equippedCombatSkills:56,equippedWeapons:3,playerCrest:57,playerStats:58,allWeapons:4,allCombatArts:5,weaponUses:6,onUpdateWeaponUses:7,selectedWeapon:8,setSelectedWeapon:9,selectedCombatArt:10,setSelectedCombatArt:11,curSuperiorityDies:12,setCurSuperiorityDie:13},null,[-1,-1,-1,-1])}}export{Ht as default};
