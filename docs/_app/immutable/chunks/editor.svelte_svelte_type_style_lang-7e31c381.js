function ln(n,e=!!vh("debug")){if(e){const t=wh(n);return function(...i){console.log(`%c${n}`,`color:${t}`,...i)}}else return yh}function yh(){}function vh(n){try{if(typeof window<"u"&&typeof window.localStorage<"u")return window.localStorage[n]}catch{}}function wh(n){let e=0;for(let t=0;t<n.length;t++)e=(e<<5)-e+n.charCodeAt(t),e|=0;return Js[Math.abs(e)%Js.length]}const Js=["#0000CC","#0099FF","#009400","#8dd200","#CCCC00","#CC9933","#ae04e7","#ff35d7","#FF3333","#FF6600","#FF9933","#FFCC33"];const sp=300,op=300,ap=300,lp=300,Ys=50,bh=200,Sh=400,_h=1200,hp=1e3,kh=100,cp=2e4,up=[{start:0,end:kh}],xh=100*1024*1024,Ch=1024*1024,fp=10*1024*1024,dp=10*1024,Ea={closeButton:!1,classBg:"jse-modal-bg",classWindow:"jse-modal-window",classWindowWrap:"jse-modal-window-wrap",classContent:"jse-modal-content"},pp={...Ea,classWindow:"jse-modal-window jse-modal-window-sort"},mp={...Ea,classWindow:"jse-modal-window jse-modal-window-transform"},gp="Insert or paste contents, enter [ insert a new array, enter { to insert a new object, or start typing to insert a new value",yp="Open context menu (Click here, right click on the selection, or use the context menu button or Ctrl+Q)",vp="hover-insert-inside",wp="hover-insert-after",bp="hover-collection",Sp="valid",_p="repairable",kp="invalid",xp=(40+2)*8,Cp=260,Ep={NO:"NO",SELF:"SELF",NEXT_INSIDE:"NEXT_INSIDE"};function Eh(n){var e=n.split("/");return e.shift(),e.map(function(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")})}function Fr(n){return n.map(Oa).join("")}function Oa(n){return"/"+String(n).replace(/~/g,"~0").replace(/\//g,"~1")}function Op(n,e){return n+Oa(e)}function Tp(n,e){return n.startsWith(e)&&(n.length===e.length||n[e.length]==="/")}var Os={},Xs={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"/":"/","\\":"\\"},Oh="a".charCodeAt();Os.parse=function(n,e,t){var r={},i=0,s=0,o=0,a=t&&t.bigint&&typeof BigInt<"u";return{data:l("",!0),pointers:r};function l(D,R){h();var W;w(D,"value");var B=g();switch(B){case"t":d("rue"),W=!0;break;case"f":d("alse"),W=!1;break;case"n":d("ull"),W=null;break;case'"':W=c();break;case"[":W=f(D);break;case"{":W=p(D);break;default:S(),"-0123456789".indexOf(B)>=0?W=u():T()}return w(D,"valueEnd"),h(),R&&o<n.length&&T(),W}function h(){e:for(;o<n.length;){switch(n[o]){case" ":s++;break;case"	":s+=4;break;case"\r":s=0;break;case`
`:s=0,i++;break;default:break e}o++}}function c(){for(var D="",R;R=g(),R!='"';)R=="\\"?(R=g(),R in Xs?D+=Xs[R]:R=="u"?D+=m():N()):D+=R;return D}function u(){var D="",R=!0;n[o]=="-"&&(D+=g()),D+=n[o]=="0"?g():y(),n[o]=="."&&(D+=g()+y(),R=!1),(n[o]=="e"||n[o]=="E")&&(D+=g(),(n[o]=="+"||n[o]=="-")&&(D+=g()),D+=y(),R=!1);var W=+D;return a&&R&&(W>Number.MAX_SAFE_INTEGER||W<Number.MIN_SAFE_INTEGER)?BigInt(D):W}function f(D){h();var R=[],W=0;if(g()=="]")return R;for(S();;){var B=D+"/"+W;R.push(l(B)),h();var F=g();if(F=="]")break;F!=","&&N(),h(),W++}return R}function p(D){h();var R={};if(g()=="}")return R;for(S();;){var W=C();g()!='"'&&N();var B=c(),F=D+"/"+Vn(B);x(F,"key",W),w(F,"keyEnd"),h(),g()!=":"&&N(),h(),R[B]=l(F),h();var se=g();if(se=="}")break;se!=","&&N(),h()}return R}function d(D){for(var R=0;R<D.length;R++)g()!==D[R]&&N()}function g(){z();var D=n[o];return o++,s++,D}function S(){o--,s--}function m(){for(var D=4,R=0;D--;){R<<=4;var W=g().toLowerCase();W>="a"&&W<="f"?R+=W.charCodeAt()-Oh+10:W>="0"&&W<="9"?R+=+W:N()}return String.fromCharCode(R)}function y(){for(var D="";n[o]>="0"&&n[o]<="9";)D+=g();if(D.length)return D;z(),T()}function w(D,R){x(D,R,C())}function x(D,R,W){r[D]=r[D]||{},r[D][R]=W}function C(){return{line:i,column:s,pos:o}}function T(){throw new SyntaxError("Unexpected token "+n[o]+" in JSON at position "+o)}function N(){S(),T()}function z(){if(o>=n.length)throw new SyntaxError("Unexpected end of JSON input")}};Os.stringify=function(n,e,t){if(!mr(n))return;var r=0,i,s,o=typeof t=="object"?t.space:t;switch(typeof o){case"number":var a=o>10?10:o<0?0:Math.floor(o);o=a&&x(a," "),i=a,s=a;break;case"string":o=o.slice(0,10),i=0,s=0;for(var l=0;l<o.length;l++){var h=o[l];switch(h){case" ":s++;break;case"	":s+=4;break;case"\r":s=0;break;case`
`:s=0,r++;break;default:throw new Error("whitespace characters not allowed in JSON")}i++}break;default:o=void 0}var c="",u={},f=0,p=0,d=0,g=t&&t.es6&&typeof Map=="function";return S(n,0,""),{json:c,pointers:u};function S(C,T,N){switch(w(N,"value"),typeof C){case"number":case"bigint":case"boolean":m(""+C);break;case"string":m(gr(C));break;case"object":C===null?m("null"):typeof C.toJSON=="function"?m(gr(C.toJSON())):Array.isArray(C)?z():g?C.constructor.BYTES_PER_ELEMENT?z():C instanceof Map?R():C instanceof Set?R(!0):D():D()}w(N,"valueEnd");function z(){if(C.length){m("[");for(var W=T+1,B=0;B<C.length;B++){B&&m(","),y(W);var F=mr(C[B])?C[B]:null,se=N+"/"+B;S(F,W,se)}y(T),m("]")}else m("[]")}function D(){var W=Object.keys(C);if(W.length){m("{");for(var B=T+1,F=0;F<W.length;F++){var se=W[F],Y=C[se];if(mr(Y)){F&&m(",");var ie=N+"/"+Vn(se);y(B),w(ie,"key"),m(gr(se)),w(ie,"keyEnd"),m(":"),o&&m(" "),S(Y,B,ie)}}y(T),m("}")}else m("{}")}function R(W){if(C.size){m("{");for(var B=T+1,F=!0,se=C.entries(),Y=se.next();!Y.done;){var ie=Y.value,le=ie[0],fe=W?!0:ie[1];if(mr(fe)){F||m(","),F=!1;var K=N+"/"+Vn(le);y(B),w(K,"key"),m(gr(le)),w(K,"keyEnd"),m(":"),o&&m(" "),S(fe,B,K)}Y=se.next()}y(T),m("}")}else m("{}")}}function m(C){p+=C.length,d+=C.length,c+=C}function y(C){if(o){for(c+=`
`+x(C,o),f++,p=0;C--;)r?(f+=r,p=s):p+=s,d+=i;d+=1}}function w(C,T){u[C]=u[C]||{},u[C][T]={line:f,column:p,pos:d}}function x(C,T){return Array(C+1).join(T)}};var Th=["number","bigint","boolean","string","object"];function mr(n){return Th.indexOf(typeof n)>=0}var Ah=/"|\\/g,$h=/[\b]/g,Ph=/\f/g,Mh=/\n/g,Nh=/\r/g,Dh=/\t/g;function gr(n){return n=n.replace(Ah,"\\$&").replace(Ph,"\\f").replace($h,"\\b").replace(Mh,"\\n").replace(Nh,"\\r").replace(Dh,"\\t"),'"'+n+'"'}var Rh=/~/g,Ih=/\//g;function Vn(n){return n.replace(Rh,"~0").replace(Ih,"~1")}function ct(n,e){if(!(this instanceof ct))throw new SyntaxError("Constructor must be called with the new operator");this.message=n+" (char "+e+")",this.char=e,this.stack=new Error().stack}ct.prototype=new Error;ct.prototype.constructor=Error;var Ts={"'":!0,"\u2018":!0,"\u2019":!0,"`":!0,"\xB4":!0},As={'"':!0,"\u201C":!0,"\u201D":!0};function Qs(n){return Lh.test(n)}var Lh=/^[a-zA-Z_]$/;function jh(n){return Bh.test(n)}var Bh=/^[0-9a-fA-F]$/;function zt(n){return Vh.test(n)}var Vh=/^[0-9]$/;function Hr(n){return n===" "||n==="	"||n===`
`||n==="\r"}function Fn(n){return n==="\xA0"||n>="\u2000"&&n<="\u200A"||n==="\u202F"||n==="\u205F"||n==="\u3000"}function Fh(n){for(var e="",t=0;t<n.length;t++){var r=n[t];e+=Fn(r)?" ":r}return e}function Hh(n){return Ts[n]===!0||As[n]===!0}function Zs(n){return Ts[n]===!0}function zh(n){return As[n]===!0}function eo(n){return Ts[n]===!0?"'":As[n]===!0?'"':n}function zr(n,e){var t=n.lastIndexOf(e);return t!==-1?n.substring(0,t)+n.substring(t+1):n}function _i(n,e){var t=n.length;if(!Hr(n[t-1]))return n+e;for(;Hr(n[t-1]);)t--;return n.substring(0,t)+e+n.substring(t)}function Wh(n,e,t){return n.substring(0,t)+e+n.substring(t)}var Qe=0,Di=1,pi=2,Ei=3,Ta=4,Hn=5,Oi=6,qh={"":!0,"{":!0,"}":!0,"[":!0,"]":!0,":":!0,",":!0,"(":!0,")":!0,";":!0,"+":!0},Uh={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},to={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},Kh={null:"null",true:"true",false:"false"},io={None:"null",True:"true",False:"false"},Kt="",Ce="",Ke=0,te="",Z="",pe=Oi;function Ui(n){Kt=n,Ce="",Ke=0,te=Kt.charAt(0),Z="",pe=Oi,Le();var e=pe;if(Qi(),ro(),Z==="")return Ce;if(e===pe&&Wr()){for(var t="";e===pe&&Wr();)Ce=_i(Ce,","),t+=Ce,Ce="",Qi(),ro();return`[
`.concat(t).concat(Ce,`
]`)}throw new ct("Unexpected characters",Ke-Z.length)}function Ue(){Ke++,te=Kt.charAt(Ke)}function Gh(){Ue(),te==="\\"&&Ue()}function Wr(){return pe===Qe&&(Z==="["||Z==="{")||pe===pi||pe===Di||pe===Ei}function Jh(){return pe===pi||pe===Di||pe===Ei}function Le(){Ce+=Z,pe=Oi,Z="",Yh(),pe===Ta&&(Z=Fh(Z),Le()),pe===Hn&&(pe=Oi,Z="",Le())}function ro(){Z===","&&(Z="",pe=Oi,Le())}function Yh(){if(qh[te]){pe=Qe,Z=te,Ue();return}Xh()}function Xh(){if(zt(te)||te==="-"){if(pe=Di,te==="-"){if(Z+=te,Ue(),!zt(te))throw new ct("Invalid number, digit expected",Ke)}else te==="0"&&(Z+=te,Ue());for(;zt(te);)Z+=te,Ue();if(te==="."){if(Z+=te,Ue(),!zt(te))throw new ct("Invalid number, digit expected",Ke);for(;zt(te);)Z+=te,Ue()}if(te==="e"||te==="E"){if(Z+=te,Ue(),(te==="+"||te==="-")&&(Z+=te,Ue()),!zt(te))throw new ct("Invalid number, digit expected",Ke);for(;zt(te);)Z+=te,Ue()}return}Qh()}function Qh(){te==="\\"&&Kt.charAt(Ke+1)==='"'?(Ue(),no(Gh)):no(Ue)}function no(n){if(Hh(te)){var e=eo(te),t=Zs(te)?Zs:zh;for(Z+='"',pe=pi,n();te!==""&&!t(te);)if(te==="\\"){n();var r=Uh[te];if(r!==void 0)Z+="\\"+te,n();else if(te==="u"){Z+="\\u",n();for(var i=0;i<4;i++){if(!jh(te))throw new ct("Invalid unicode character",Ke-Z.length);Z+=te,n()}}else if(te==="'")Z+="'",n();else throw new ct('Invalid escape character "\\'+te+'"',Ke)}else to[te]?(Z+=to[te],n()):te==='"'?(Z+='\\"',n()):(Z+=te,n());if(eo(te)!==e)throw new ct("End of string expected",Ke-Z.length);Z+='"',n();return}Zh()}function Zh(){if(Qs(te)){for(pe=Ei;Qs(te)||zt(te)||te==="$";)Z+=te,Ue();return}ec()}function ec(){if(Hr(te)||Fn(te)){for(pe=Ta;Hr(te)||Fn(te);)Z+=te,Ue();return}tc()}function tc(){if(te==="/"&&Kt[Ke+1]==="*"){for(pe=Hn;te!==""&&(te!=="*"||te==="*"&&Kt[Ke+1]!=="/");)Z+=te,Ue();te==="*"&&Kt[Ke+1]==="/"&&(Z+=te,Ue(),Z+=te,Ue());return}if(te==="/"&&Kt[Ke+1]==="/"){for(pe=Hn;te!==""&&te!==`
`;)Z+=te,Ue();return}ic()}function ic(){for(pe=Oi;te!=="";)Z+=te,Ue();throw new ct('Syntax error in part "'+Z+'"',Ke-Z.length)}function Qi(){if(pe===Qe&&Z==="{"){if(Le(),pe===Qe&&Z==="}"){Le();return}for(;;){if((pe===Ei||pe===Di)&&(pe=pi,Z='"'.concat(Z,'"')),pe!==pi)throw new ct("Object key expected",Ke-Z.length);if(Le(),pe===Qe&&Z===":")Le();else if(Wr())Ce=_i(Ce,":");else throw new ct("Colon expected",Ke-Z.length);if(Qi(),pe===Qe&&Z===","){if(Le(),pe===Qe&&Z==="}"){Ce=zr(Ce,",");break}if(Z===""){Ce=zr(Ce,",");break}}else if(Jh())Ce=_i(Ce,",");else break}pe===Qe&&Z==="}"?Le():Ce=_i(Ce,"}");return}rc()}function rc(){if(pe===Qe&&Z==="["){if(Le(),pe===Qe&&Z==="]"){Le();return}for(;;)if(Qi(),pe===Qe&&Z===","){if(Le(),pe===Qe&&Z==="]"){Ce=zr(Ce,",");break}if(Z===""){Ce=zr(Ce,",");break}}else if(Wr())Ce=_i(Ce,",");else break;pe===Qe&&Z==="]"?Le():Ce=_i(Ce,"]");return}nc()}function nc(){if(pe===pi){for(Le();pe===Qe&&Z==="+";)if(Z="",Le(),pe===pi){var n=Ce.lastIndexOf('"');Ce=Ce.substring(0,n)+Z.substring(1),Z="",Le()}return}sc()}function sc(){if(pe===Di){Le();return}oc()}function oc(){if(pe===Ei){if(Kh[Z]){Le();return}if(io[Z]){Z=io[Z],Le();return}var n=Z,e=Ce.length;if(Z="",Le(),pe===Qe&&Z==="("){Z="",Le(),Qi(),pe===Qe&&Z===")"&&(Z="",Le(),pe===Qe&&Z===";"&&(Z="",Le()));return}for(Ce=Wh(Ce,'"'.concat(n),e);pe===Ei||pe===Di;)Le();Ce+='"';return}ac()}function ac(){throw Z===""?new ct("Unexpected end of json string",Ke-Z.length):new ct("Value expected",Ke-Z.length)}function Gt(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function lc(n){return typeof n=="object"&&n!==null}function Ap(n){return n===!0||n===!1}function $p(n){return typeof n=="number"&&n>9466848e5&&isFinite(n)&&Math.floor(n)===n&&!isNaN(new Date(n).valueOf())}function hc(n){const e=window.document.createElement("div");return e.style.color=n,e.style.color.split(/\s+/).join("").toLowerCase()||null}function Pp(n){return typeof n=="string"&&!!hc(n)}function cc(n){return n===null?"null":n===void 0?"undefined":typeof n=="number"?"number":typeof n=="string"?"string":typeof n=="boolean"?"boolean":n instanceof RegExp?"regexp":Array.isArray(n)?"array":"object"}const uc=/^https?:\/\/\S+$/;function Mp(n){return typeof n=="string"&&uc.test(n)}function fc(n){if(n==="")return"";if(n==="null")return null;if(n==="true")return!0;if(n==="false")return!1;const e=Number(n);return!isNaN(e)&&!isNaN(parseFloat(n))?e:n}function Np(n){return typeof n=="string"&&typeof fc(n)!="string"}function dc(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function pc(n){var e=n==null?0:n.length;return e?dc(n,0,-1):[]}const mc=1e4,gc=[];function Dp(n,e=!1){const t={};if(!Array.isArray(n))throw new TypeError("Array expected");function r(o,a){(!Array.isArray(o)&&!Gt(o)||e&&a.length>0)&&(t[Fr(a)]=!0),Gt(o)&&Object.keys(o).forEach(h=>{r(o[h],a.concat(h))})}const i=Math.min(n.length,mc);for(let o=0;o<i;o++){const a=n[o];r(a,gc)}return Object.keys(t).sort().map(Eh)}function Rp(n,e,t){if(!(e<=n))for(let r=n;r<e;r++)t(r)}function Ip(n,e){return n.length>e?n.slice(0,e):n}function so(n){return{...n}}function oo(n){return Object.values(n)}function Lp(n,e,t,r){const i=n.slice(0),s=i.splice(e,t);return i.splice.apply(i,[e+r,0,...s]),i}function yn(n){return parseInt(n,10)}function yc(n){try{return JSON.parse(n)}catch{return JSON.parse(Ui(n))}}function jp(n){try{return yc(n)}catch{return}}function Bp(n,e=JSON.parse){n=n.replace(Aa,"");try{return e(n)}catch{}try{return e("["+n+"]")}catch{}try{return e("{"+n+"}")}catch{}throw new Error("Failed to parse partial JSON")}function Vp(n){n=n.replace(Aa,"");try{return Ui(n)}catch{}try{const e=Ui("["+n+"]");return e.substring(1,e.length-1)}catch{}try{const e=Ui("{"+n+"}");return e.substring(1,e.length-1)}catch{}throw new Error("Failed to repair partial JSON")}const Aa=/,\s*$/;function vc(n,e){const t=ao.exec(e);if(t){const r=yn(t[2]),i=bc(n,`
`,0,r),s=n.lastIndexOf(`
`,r),o=r-s-1;return{position:r,line:i,column:o,message:e.replace(ao,()=>`line ${i+1} column ${o+1}`)}}else{const r=kc.exec(e),i=r?yn(r[1]):null,s=i!==null?i-1:null,o=xc.exec(e),a=o?yn(o[1]):null,l=a!==null?a-1:null;return{position:s!==null&&l!==null?wc(n,s,l):null,line:s,column:l,message:e.replace(/^JSON.parse: /,"").replace(/ of the JSON data$/,"")}}}function wc(n,e,t){let r=n.indexOf(`
`),i=1;for(;i<e&&r!==-1;)r=n.indexOf(`
`,r+1),i++;return r!==-1?r+t+1:null}function bc(n,e,t=0,r=n.length){let i=0;for(let s=t;s<r;s++)n.charAt(s)===e&&i++;return i}function Fp(n,e){try{const t=Os.parse(n),r=Fr(e),i=t.pointers[r];if(i)return{path:e,line:i.key?i.key.line:i.value?i.value.line:0,column:i.key?i.key.column:i.value?i.value.column:0,from:i.key?i.key.pos:i.value?i.value.pos:0,to:i.keyEnd?i.keyEnd.pos:i.valueEnd?i.valueEnd.pos:0}}catch(t){console.error(t)}return null}function Hp(n,e){if(e==="array"){if(Array.isArray(n))return n;if(Gt(n))return oo(n);if(typeof n=="string"){const t=JSON.parse(n);if(Array.isArray(t))return t;if(Gt(t))return oo(t)}}if(e==="object"){if(Array.isArray(n))return so(n);if(Gt(n))return n;if(typeof n=="string"){const t=JSON.parse(n);if(Gt(t))return t;if(Array.isArray(t))return so(t)}}if(e==="value")return lc(n)?JSON.stringify(n):n;throw new Error(`Cannot convert ${cc(n)} to ${e}`)}function zp(n){return Gt(n)?n.json!==void 0?n.text!==void 0?'Content must contain either a property "json" or a property "text" but not both':null:n.text===void 0?'Content must contain either a property "json" or a property "text"':typeof n.text!="string"?'Content "text" property must be string':null:"Content must be an object"}function Sc(n){return typeof n.text=="string"}function Wp(n,e){return _c(n,e)>e}function _c(n,e=1/0){if(Sc(n))return n.text.length;const t=n.json;let r=0;function i(s){if(Array.isArray(s)){if(r+=2+(s.length-1),r>e)return r;for(let o=0;o<s.length;o++){const a=s[o];if(i(a),r>e)return r}}else if(Gt(s)){const o=Object.keys(s);r+=2+o.length+(o.length-1);for(let a=0;a<o.length;a++){const l=o[a],h=s[l];r+=l.length+2,i(h)}}else typeof s=="string"?r+=s.length+2:r+=String(s).length}return i(t),r}const ao=/(position|char) (\d+)/,kc=/line (\d+)/,xc=/column (\d+)/;var lo;(function(n){n.text="text",n.tree="tree"})(lo||(lo={}));var ho;(function(n){n.after="after",n.inside="inside",n.key="key",n.value="value",n.multi="multi"})(ho||(ho={}));var co;(function(n){n.after="after",n.key="key",n.value="value",n.inside="inside"})(co||(co={}));var zn;(function(n){n.info="info",n.warning="warning",n.error="error"})(zn||(zn={}));var uo;(function(n){n.key="key",n.value="value"})(uo||(uo={}));const qp=typeof navigator<"u"?navigator.platform.toUpperCase().indexOf("MAC")>=0:!1;const yr=ln("jsoneditor:FocusTracker");function Up({onMount:n,onDestroy:e,getWindow:t,hasFocus:r,onFocus:i,onBlur:s}){let o,a=!1;function l(){const c=r();c&&(clearTimeout(o),a||(yr("focus"),i(),a=c))}function h(){a&&(clearTimeout(o),o=setTimeout(()=>{yr("blur"),a=!1,s()}))}n(()=>{yr("mount FocusTracker");const c=t();c&&(c.addEventListener("focusin",l,!0),c.addEventListener("focusout",h,!0))}),e(()=>{yr("destroy FocusTracker");const c=t();c&&(c.removeEventListener("focusin",l,!0),c.removeEventListener("focusout",h,!0))})}class Me{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(t,this.length,i,1),Pt.from(i,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let r=[];return this.decompose(e,t,r,0),Pt.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new Ki(this),s=new Ki(e);for(let o=t,a=t;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(a+=i.value.length,i.done||a>=r)return!0}}iter(e=1){return new Ki(this,e)}iterRange(e,t=this.length){return new $a(this,e,t)}iterLines(e,t){let r;if(e==null)r=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Pa(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Me.empty:e.length<=32?new ze(e):Pt.from(ze.split(e,[]))}}class ze extends Me{constructor(e,t=Cc(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.text[s],a=i+o.length;if((t?r:a)>=e)return new Ec(i,a,r,o);i=a+1,r++}}decompose(e,t,r,i){let s=e<=0&&t>=this.length?this:new ze(fo(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let o=r.pop(),a=Dr(s.text,o.text.slice(),0,s.length);if(a.length<=32)r.push(new ze(a,o.length+s.length));else{let l=a.length>>1;r.push(new ze(a.slice(0,l)),new ze(a.slice(l)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof ze))return super.replace(e,t,r);let i=Dr(this.text,Dr(r.text,fo(this.text,0,e)),t),s=this.length+r.length-(t-e);return i.length<=32?new ze(i,s):Pt.from(ze.split(i,[]),s)}sliceString(e,t=this.length,r=`
`){let i="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(i+=r),e<l&&t>s&&(i+=a.slice(Math.max(0,e-s),t-s)),s=l+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,r.length==32&&(t.push(new ze(r,i)),r=[],i=-1);return i>-1&&t.push(new ze(r,i)),t}}class Pt extends Me{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.children[s],a=i+o.length,l=r+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,r,i);i=a+1,r=l+1}}decompose(e,t,r,i){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&t>=o){let h=i&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!h?r.push(a):a.decompose(e-o,t-o,r,h)}o=l+1}}replace(e,t,r){if(r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],a=s+o.length;if(e>=s&&t<=a){let l=o.replace(e-s,t-s,r),h=this.lines-o.lines+l.lines;if(l.lines<h>>5-1&&l.lines>h>>5+1){let c=this.children.slice();return c[i]=l,new Pt(c,this.length-(t-e)+r.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r=`
`){let i="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(i+=r),e<l&&t>o&&(i+=a.sliceString(e-o,t-o,r)),o=l+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Pt))return 0;let r=0,[i,s,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==o||s==a)return r;let l=this.children[i],h=e.children[s];if(l!=h)return r+l.scanIdentical(h,t);r+=l.length+1}}static from(e,t=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let p of e)r+=p.lines;if(r<32){let p=[];for(let d of e)d.flatten(p);return new ze(p,t)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,a=[],l=0,h=-1,c=[];function u(p){let d;if(p.lines>s&&p instanceof Pt)for(let g of p.children)u(g);else p.lines>o&&(l>o||!l)?(f(),a.push(p)):p instanceof ze&&l&&(d=c[c.length-1])instanceof ze&&p.lines+d.lines<=32?(l+=p.lines,h+=p.length+1,c[c.length-1]=new ze(d.text.concat(p.text),d.length+1+p.length)):(l+p.lines>i&&f(),l+=p.lines,h+=p.length+1,c.push(p))}function f(){l!=0&&(a.push(c.length==1?c[0]:Pt.from(c,h)),h=-1,l=c.length=0)}for(let p of e)u(p);return f(),a.length==1?a[0]:new Pt(a,t)}}Me.empty=new ze([""],0);function Cc(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Dr(n,e,t=0,r=1e9){for(let i=0,s=0,o=!0;s<n.length&&i<=r;s++){let a=n[s],l=i+a.length;l>=t&&(l>r&&(a=a.slice(0,r-i)),i<t&&(a=a.slice(t-i)),o?(e[e.length-1]+=a,o=!1):e.push(a)),i=l+1}return e}function fo(n,e,t){return Dr(n,[""],e,t)}class Ki{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ze?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,a=i instanceof ze?i.text.length:i.children.length;if(o==(t>0?a:0)){if(r==0)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[r]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof ze){let l=i.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof ze?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class $a{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new Ki(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=r?i:t<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Pa{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:i}=this.inner.next(e);return t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Me.prototype[Symbol.iterator]=function(){return this.iter()},Ki.prototype[Symbol.iterator]=$a.prototype[Symbol.iterator]=Pa.prototype[Symbol.iterator]=function(){return this});class Ec{constructor(e,t,r,i){this.from=e,this.to=t,this.number=r,this.text=i}get length(){return this.to-this.from}}let ki="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<ki.length;n++)ki[n]+=ki[n-1];function Oc(n){for(let e=1;e<ki.length;e+=2)if(ki[e]>n)return ki[e-1]<=n;return!1}function po(n){return n>=127462&&n<=127487}const mo=8205;function Rt(n,e,t=!0,r=!0){return(t?Ma:Tc)(n,e,r)}function Ma(n,e,t){if(e==n.length)return e;e&&Na(n.charCodeAt(e))&&Da(n.charCodeAt(e-1))&&e--;let r=Gi(n,e);for(e+=Wn(r);e<n.length;){let i=Gi(n,e);if(r==mo||i==mo||t&&Oc(i))e+=Wn(i),r=i;else if(po(i)){let s=0,o=e-2;for(;o>=0&&po(Gi(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function Tc(n,e,t){for(;e>0;){let r=Ma(n,e-2,t);if(r<e)return r;e--}return 0}function Na(n){return n>=56320&&n<57344}function Da(n){return n>=55296&&n<56320}function Gi(n,e){let t=n.charCodeAt(e);if(!Da(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return Na(r)?(t-55296<<10)+(r-56320)+65536:t}function Kp(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Wn(n){return n<65536?1:2}const qn=/\r\n?|\n/;var ft=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(ft||(ft={}));class Lt{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,i=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,t=!1){Un(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];i<0?e.push(r,i):e.push(i,r)}return new Lt(e)}composeDesc(e){return this.empty?e:e.empty?this:Ra(this,e)}mapDesc(e,t=!1){return e.empty?this:Kn(this,e,t)}mapPos(e,t=-1,r=ft.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],h=i+a;if(l<0){if(h>e)return s+(e-i);s+=a}else{if(r!=ft.Simple&&h>=e&&(r==ft.TrackDel&&i<e&&h>e||r==ft.TrackBefore&&i<e||r==ft.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!a)return e==i||t<0?s:s+l;s+=l}i=h}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let r=0,i=0;r<this.sections.length&&i<=t;){let s=this.sections[r++],o=this.sections[r++],a=i+s;if(o>=0&&i<=t&&a>=e)return i<e&&a>t?"cover":!0;i=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Lt(e)}static create(e){return new Lt(e)}}class Je extends Lt{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Un(this,(t,r,i,s,o)=>e=e.replace(i,i+(r-t),o),!1),e}mapDesc(e,t=!1){return Kn(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let i=0,s=0;i<t.length;i+=2){let o=t[i],a=t[i+1];if(a>=0){t[i]=a,t[i+1]=o;let l=i>>1;for(;r.length<l;)r.push(Me.empty);r.push(o?e.slice(s,s+o):Me.empty)}s+=o}return new Je(t,r)}compose(e){return this.empty?e:e.empty?this:Ra(this,e,!0)}map(e,t=!1){return e.empty?this:Kn(this,e,t,!0)}iterChanges(e,t=!1){Un(this,e,t)}get desc(){return Lt.create(this.sections)}filter(e){let t=[],r=[],i=[],s=new Zi(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);tt(i,c,-1);let u=s.ins==-1?-1:s.off==0?s.ins:0;tt(t,c,u),u>0&&Jt(r,t,s.text),s.forward(c),a+=c}let h=e[o++];for(;a<h;){if(s.done)break e;let c=Math.min(s.len,h-a);tt(t,c,-1),tt(i,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new Je(t,r),filtered:Lt.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],i=this.sections[t+1];i<0?e.push(r):i==0?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let i=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!i.length)return;o<t&&tt(i,t-o,-1);let u=new Je(i,s);a=a?a.compose(u.map(a)):u,i=[],s=[],o=0}function h(c){if(Array.isArray(c))for(let u of c)h(u);else if(c instanceof Je){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:u,to:f=u,insert:p}=c;if(u>f||u<0||f>t)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${t})`);let d=p?typeof p=="string"?Me.of(p.split(r||qn)):p:Me.empty,g=d.length;if(u==f&&g==0)return;u<o&&l(),u>o&&tt(i,u-o,-1),tt(i,f-u,g),Jt(s,i,d),o=f}}return h(e),l(!a),a}static empty(e){return new Je(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;r.length<i;)r.push(Me.empty);r[i]=Me.of(s.slice(1)),t.push(s[0],r[i].length)}}}return new Je(t,r)}static createSet(e,t){return new Je(e,t)}}function tt(n,e,t,r=!1){if(e==0&&t<=0)return;let i=n.length-2;i>=0&&t<=0&&t==n[i+1]?n[i]+=e:e==0&&n[i]==0?n[i+1]+=t:r?(n[i]+=e,n[i+1]+=t):n.push(e,t)}function Jt(n,e,t){if(t.length==0)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(Me.empty);n.push(t)}}function Un(n,e,t){let r=n.inserted;for(let i=0,s=0,o=0;o<n.sections.length;){let a=n.sections[o++],l=n.sections[o++];if(l<0)i+=a,s+=a;else{let h=i,c=s,u=Me.empty;for(;h+=a,c+=l,l&&r&&(u=u.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)a=n.sections[o++],l=n.sections[o++];e(i,h,s,c,u),i=h,s=c}}}function Kn(n,e,t,r=!1){let i=[],s=r?[]:null,o=new Zi(n),a=new Zi(e);for(let l=-1;;)if(o.ins==-1&&a.ins==-1){let h=Math.min(o.len,a.len);tt(i,h,-1),o.forward(h),a.forward(h)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!t))){let h=a.len;for(tt(i,a.ins,-1);h;){let c=Math.min(o.len,h);o.ins>=0&&l<o.i&&o.len<=c&&(tt(i,0,o.ins),s&&Jt(s,i,o.text),l=o.i),o.forward(c),h-=c}a.next()}else if(o.ins>=0){let h=0,c=o.len;for(;c;)if(a.ins==-1){let u=Math.min(c,a.len);h+=u,c-=u,a.forward(u)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;tt(i,h,l<o.i?o.ins:0),s&&l<o.i&&Jt(s,i,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?Je.createSet(i,s):Lt.create(i);throw new Error("Mismatched change set lengths")}}function Ra(n,e,t=!1){let r=[],i=t?[]:null,s=new Zi(n),o=new Zi(e);for(let a=!1;;){if(s.done&&o.done)return i?Je.createSet(r,i):Lt.create(r);if(s.ins==0)tt(r,s.len,0,a),s.next();else if(o.len==0&&!o.done)tt(r,0,o.ins,a),i&&Jt(i,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),h=r.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;tt(r,l,c,a),i&&c&&Jt(i,r,o.text)}else o.ins==-1?(tt(r,s.off?0:s.len,l,a),i&&Jt(i,r,s.textBit(l))):(tt(r,s.off?0:s.len,o.off?0:o.ins,a),i&&!o.off&&Jt(i,r,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||r.length>h),s.forward2(l),o.forward(l)}}}}class Zi{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Me.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?Me.empty:t[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class ui{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new ui(r,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return ae.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return ae.range(this.anchor,r)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ae.range(e.anchor,e.head)}static create(e,t,r){return new ui(e,t,r)}}class ae{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:ae.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ae([this.main],0)}addRange(e,t=!0){return ae.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,ae.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ae(e.ranges.map(t=>ui.fromJSON(t)),e.main)}static single(e,t=e){return new ae([ae.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return ae.normalized(e.slice(),t);r=s.to}return new ae(e,t)}static cursor(e,t=0,r,i){return ui.create(e,e,(t==0?0:t<0?4:8)|(r==null?3:Math.min(2,r))|(i!=null?i:33554431)<<5)}static range(e,t,r){let i=(r!=null?r:33554431)<<5;return t<e?ui.create(t,e,16|i|8):ui.create(e,t,i|(t>e?4:0))}static normalized(e,t=0){let r=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?ae.range(l,a):ae.range(a,l))}}return new ae(e,t)}}function Ia(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let $s=0;class he{constructor(e,t,r,i,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=i,this.id=$s++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}static define(e={}){return new he(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:Ps),!!e.static,e.enables)}of(e){return new Rr([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Rr(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Rr(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function Ps(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class Rr{constructor(e,t,r,i){this.dependencies=e,this.facet=t,this.type=r,this.value=i,this.id=$s++}dynamicSlot(e){var t;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,h=!1,c=[];for(let u of this.dependencies)u=="doc"?l=!0:u=="selection"?h=!0:(((t=e[u.id])!==null&&t!==void 0?t:1)&1)==0&&c.push(e[u.id]);return{create(u){return u.values[o]=r(u),1},update(u,f){if(l&&f.docChanged||h&&(f.docChanged||f.selection)||Gn(u,c)){let p=r(u);if(a?!go(p,u.values[o],i):!i(p,u.values[o]))return u.values[o]=p,1}return 0},reconfigure:(u,f)=>{let p=r(u),d=f.config.address[s];if(d!=null){let g=Ur(f,d);if(this.dependencies.every(S=>S instanceof he?f.facet(S)===u.facet(S):S instanceof kt?f.field(S,!1)==u.field(S,!1):!0)||(a?go(p,g,i):i(p,g)))return u.values[o]=g,0}return u.values[o]=p,1}}}}function go(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function Gn(n,e){let t=!1;for(let r of e)Ji(n,r)&1&&(t=!0);return t}function Ac(n,e,t){let r=t.map(l=>n[l.id]),i=t.map(l=>l.type),s=r.filter(l=>!(l&1)),o=n[e.id]>>1;function a(l){let h=[];for(let c=0;c<r.length;c++){let u=Ur(l,r[c]);if(i[c]==2)for(let f of u)h.push(f);else h.push(u)}return e.combine(h)}return{create(l){for(let h of r)Ji(l,h);return l.values[o]=a(l),1},update(l,h){if(!Gn(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,h){let c=Gn(l,r),u=h.config.facets[e.id],f=h.facet(e);if(u&&!c&&Ps(t,u))return l.values[o]=f,0;let p=a(l);return e.compare(p,f)?(l.values[o]=f,0):(l.values[o]=p,1)}}}const yo=he.define({static:!0});class kt{constructor(e,t,r,i,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new kt($s++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(yo).find(r=>r.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,i)=>{let s=r.values[t],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,i)=>i.config.address[this.id]!=null?(r.values[t]=i.field(this),0):(r.values[t]=this.create(r),1)}}init(e){return[this,yo.of({field:this,create:e})]}get extension(){return this}}const ci={lowest:4,low:3,default:2,high:1,highest:0};function Ii(n){return e=>new La(e,n)}const hn={highest:Ii(ci.highest),high:Ii(ci.high),default:Ii(ci.default),low:Ii(ci.low),lowest:Ii(ci.lowest)};class La{constructor(e,t){this.inner=e,this.prec=t}}class cn{of(e){return new Jn(this,e)}reconfigure(e){return cn.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Jn{constructor(e,t){this.compartment=e,this.inner=t}}class qr{constructor(e,t,r,i,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let i=[],s=Object.create(null),o=new Map;for(let f of $c(e,t,o))f instanceof kt?i.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],h=[];for(let f of i)a[f.id]=h.length<<1,h.push(p=>f.slot(p));let c=r==null?void 0:r.config.facets;for(let f in s){let p=s[f],d=p[0].facet,g=c&&c[f]||[];if(p.every(S=>S.type==0))if(a[d.id]=l.length<<1|1,Ps(g,p))l.push(r.facet(d));else{let S=d.combine(p.map(m=>m.value));l.push(r&&d.compare(S,r.facet(d))?r.facet(d):S)}else{for(let S of p)S.type==0?(a[S.id]=l.length<<1|1,l.push(S.value)):(a[S.id]=h.length<<1,h.push(m=>S.dynamicSlot(m)));a[d.id]=h.length<<1,h.push(S=>Ac(S,d,p))}}let u=h.map(f=>f(a));return new qr(e,o,u,a,l,s)}}function $c(n,e,t){let r=[[],[],[],[],[]],i=new Map;function s(o,a){let l=i.get(o);if(l!=null){if(l<=a)return;let h=r[l].indexOf(o);h>-1&&r[l].splice(h,1),o instanceof Jn&&t.delete(o.compartment)}if(i.set(o,a),Array.isArray(o))for(let h of o)s(h,a);else if(o instanceof Jn){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),s(h,a)}else if(o instanceof La)s(o.inner,o.prec);else if(o instanceof kt)r[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Rr)r[a].push(o),o.facet.extensions&&s(o.facet.extensions,ci.default);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(h,a)}}return s(n,ci.default),r.reduce((o,a)=>o.concat(a))}function Ji(n,e){if(e&1)return 2;let t=e>>1,r=n.status[t];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;n.status[t]=4;let i=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|i}function Ur(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const ja=he.define(),Ba=he.define({combine:n=>n.some(e=>e),static:!0}),Va=he.define({combine:n=>n.length?n[0]:void 0,static:!0}),Fa=he.define(),Ha=he.define(),za=he.define(),Wa=he.define({combine:n=>n.length?n[0]:!1});class ar{constructor(e,t){this.type=e,this.value=t}static define(){return new Pc}}class Pc{of(e){return new ar(this,e)}}class Mc{constructor(e){this.map=e}of(e){return new Ve(this,e)}}class Ve{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Ve(this.type,t)}is(e){return this.type==e}static define(e={}){return new Mc(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let i of e){let s=i.map(t);s&&r.push(s)}return r}}Ve.reconfigure=Ve.define();Ve.appendConfig=Ve.define();class rt{constructor(e,t,r,i,s,o){this.startState=e,this.changes=t,this.selection=r,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&Ia(r,t.newLength),s.some(a=>a.type==rt.time)||(this.annotations=s.concat(rt.time.of(Date.now())))}static create(e,t,r,i,s,o){return new rt(e,t,r,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(rt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}rt.time=ar.define();rt.userEvent=ar.define();rt.addToHistory=ar.define();rt.remote=ar.define();function Nc(n,e){let t=[];for(let r=0,i=0;;){let s,o;if(r<n.length&&(i==e.length||e[i]>=n[r]))s=n[r++],o=n[r++];else if(i<e.length)s=e[i++],o=e[i++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function qa(n,e,t){var r;let i,s,o;return t?(i=e.changes,s=Je.empty(e.changes.length),o=n.changes.compose(e.changes)):(i=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(r=n.selection)===null||r===void 0?void 0:r.map(i),effects:Ve.mapEffects(n.effects,i).concat(Ve.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Yn(n,e,t){let r=e.selection,i=xi(e.annotations);return e.userEvent&&(i=i.concat(rt.userEvent.of(e.userEvent))),{changes:e.changes instanceof Je?e.changes:Je.of(e.changes||[],t,n.facet(Va)),selection:r&&(r instanceof ae?r:ae.single(r.anchor,r.head)),effects:xi(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function Ua(n,e,t){let r=Yn(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;r=qa(r,Yn(n,e[s],o?r.changes.newLength:n.doc.length),o)}let i=rt.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return Rc(t?Dc(i):i)}function Dc(n){let e=n.startState,t=!0;for(let i of e.facet(Fa)){let s=i(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:Nc(t,s))}if(t!==!0){let i,s;if(t===!1)s=n.changes.invertedDesc,i=Je.empty(e.doc.length);else{let o=n.changes.filter(t);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=rt.create(e,i,n.selection&&n.selection.map(s),Ve.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(Ha);for(let i=r.length-1;i>=0;i--){let s=r[i](n);s instanceof rt?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof rt?n=s[0]:n=Ua(e,xi(s),!1)}return n}function Rc(n){let e=n.startState,t=e.facet(za),r=n;for(let i=t.length-1;i>=0;i--){let s=t[i](n);s&&Object.keys(s).length&&(r=qa(n,Yn(e,s,n.changes.newLength),!0))}return r==n?n:rt.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}const Ic=[];function xi(n){return n==null?Ic:Array.isArray(n)?n:[n]}var It=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(It||(It={}));const Lc=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Xn;try{Xn=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function jc(n){if(Xn)return Xn.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>"\x80"&&(t.toUpperCase()!=t.toLowerCase()||Lc.test(t)))return!0}return!1}function Bc(n){return e=>{if(!/\S/.test(e))return It.Space;if(jc(e))return It.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return It.Word;return It.Other}}class Te{constructor(e,t,r,i,s,o){this.config=e,this.doc=t,this.selection=r,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Ji(this,a<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return}return Ji(this,r),Ur(this,r)}update(...e){return Ua(this,e,!0)}applyTransaction(e){let t=this.config,{base:r,compartments:i}=t;for(let o of e.effects)o.is(cn.reconfigure)?(t&&(i=new Map,t.compartments.forEach((a,l)=>i.set(l,a)),t=null),i.set(o.value.compartment,o.value.extension)):o.is(Ve.reconfigure)?(t=null,r=o.value):o.is(Ve.appendConfig)&&(t=null,r=xi(r).concat(o.value));let s;t?s=e.startState.values.slice():(t=qr.resolve(r,i,this),s=new Te(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,l)=>l.reconfigure(a,this),null).values),new Te(t,e.newDoc,e.newSelection,s,(o,a)=>a.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:ae.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),i=this.changes(r.changes),s=[r.range],o=xi(r.effects);for(let a=1;a<t.ranges.length;a++){let l=e(t.ranges[a]),h=this.changes(l.changes),c=h.map(i);for(let f=0;f<a;f++)s[f]=s[f].map(c);let u=i.mapDesc(h,!0);s.push(l.range.map(u)),i=i.compose(c),o=Ve.mapEffects(o,c).concat(Ve.mapEffects(xi(l.effects),u))}return{changes:i,selection:ae.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Je?e:Je.of(e,this.doc.length,this.facet(Te.lineSeparator))}toText(e){return Me.of(e.split(this.facet(Te.lineSeparator)||qn))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Ji(this,t),Ur(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let i=e[r];i instanceof kt&&this.config.address[i.id]!=null&&(t[r]=i.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],a=e[s];i.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Te.create({doc:e.doc,selection:ae.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=qr.resolve(e.extensions||[],new Map),r=e.doc instanceof Me?e.doc:Me.of((e.doc||"").split(t.staticFacet(Te.lineSeparator)||qn)),i=e.selection?e.selection instanceof ae?e.selection:ae.single(e.selection.anchor,e.selection.head):ae.single(0);return Ia(i,r.length),t.staticFacet(Ba)||(i=i.asSingle()),new Te(t,r,i,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Te.tabSize)}get lineBreak(){return this.facet(Te.lineSeparator)||`
`}get readOnly(){return this.facet(Wa)}phrase(e,...t){for(let r of this.facet(Te.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(r,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>t.length?r:t[s-1]})),e}languageDataAt(e,t,r=-1){let i=[];for(let s of this.facet(ja))for(let o of s(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){return Bc(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:r,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,a=e-r;for(;o>0;){let l=Rt(t,o,!1);if(s(t.slice(l,o))!=It.Word)break;o=l}for(;a<i;){let l=Rt(t,a);if(s(t.slice(a,l))!=It.Word)break;a=l}return o==a?null:ae.range(o+r,a+r)}}Te.allowMultipleSelections=Ba;Te.tabSize=he.define({combine:n=>n.length?n[0]:4});Te.lineSeparator=Va;Te.readOnly=Wa;Te.phrases=he.define({compare(n,e){let t=Object.keys(n),r=Object.keys(e);return t.length==r.length&&t.every(i=>n[i]==e[i])}});Te.languageData=ja;Te.changeFilter=Fa;Te.transactionFilter=Ha;Te.transactionExtender=za;cn.reconfigure=Ve.define();function lr(n,e,t={}){let r={};for(let i of n)for(let s of Object.keys(i)){let o=i[s],a=r[s];if(a===void 0)r[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(t,s))r[s]=t[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)r[i]===void 0&&(r[i]=e[i]);return r}class Ti{eq(e){return this==e}range(e,t=e){return er.create(e,t,this)}}Ti.prototype.startSide=Ti.prototype.endSide=0;Ti.prototype.point=!1;Ti.prototype.mapMode=ft.TrackDel;class er{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new er(e,t,r)}}function Qn(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Ms{constructor(e,t,r,i){this.from=e,this.to=t,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,i=0){let s=r?this.to:this.from;for(let o=i,a=s.length;;){if(o==a)return o;let l=o+a>>1,h=s[l]-e||(r?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return h>=0?o:a;h>=0?a=l:o=l+1}}between(e,t,r,i){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let r=[],i=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let h=this.value[l],c=this.from[l]+e,u=this.to[l]+e,f,p;if(c==u){let d=t.mapPos(c,h.startSide,h.mapMode);if(d==null||(f=p=d,h.startSide!=h.endSide&&(p=t.mapPos(c,h.endSide),p<f)))continue}else if(f=t.mapPos(c,h.startSide),p=t.mapPos(u,h.endSide),f>p||f==p&&h.startSide>0&&h.endSide<=0)continue;(p-f||h.endSide-h.startSide)<0||(o<0&&(o=f),h.point&&(a=Math.max(a,p-f)),r.push(h),i.push(f-o),s.push(p-o))}return{mapped:r.length?new Ms(i,s,r,a):null,pos:o}}}class Ne{constructor(e,t,r,i){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=i}static create(e,t,r,i){return new Ne(e,t,r,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(r&&(t=t.slice().sort(Qn)),this.isEmpty)return t.length?Ne.of(t):this;let a=new Ka(this,null,-1).goto(0),l=0,h=[],c=new mi;for(;a.value||l<t.length;)if(l<t.length&&(a.from-t[l].from||a.startSide-t[l].value.startSide)>=0){let u=t[l++];c.addInner(u.from,u.to,u.value)||h.push(u)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(a.chunkIndex)<t[l].from)&&(!o||i>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||i>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||h.push(er.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!h.length?Ne.empty:this.nextLayer.update({add:h,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],i=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],h=e.touchesRange(a,a+l.length);if(h===!1)i=Math.max(i,l.maxPoint),t.push(l),r.push(e.mapPos(a));else if(h===!0){let{mapped:c,pos:u}=l.map(a,e);c&&(i=Math.max(i,c.maxPoint),t.push(c),r.push(u))}}let s=this.nextLayer.map(e);return t.length==0?s:new Ne(r,t,s||Ne.empty,i)}between(e,t,r){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,r)===!1)return}this.nextLayer.between(e,t,r)}}iter(e=0){return tr.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return tr.from(e).goto(t)}static compare(e,t,r,i,s=-1){let o=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),a=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=s),l=vo(o,a,r),h=new Li(o,l,s),c=new Li(a,l,s);r.iterGaps((u,f,p)=>wo(h,u,c,f,p,i)),r.empty&&r.length==0&&wo(h,0,c,0,0,i)}static eq(e,t,r=0,i){i==null&&(i=1e9);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=vo(s,o),l=new Li(s,a,0).goto(r),h=new Li(o,a,0).goto(r);for(;;){if(l.to!=h.to||!Zn(l.active,h.active)||l.point&&(!h.point||!l.point.eq(h.point)))return!1;if(l.to>i)return!0;l.next(),h.next()}}static spans(e,t,r,i,s=-1){let o=new Li(e,null,s).goto(t),a=t,l=o.openStart;for(;;){let h=Math.min(o.to,r);if(o.point?(i.point(a,h,o.point,o.activeForPoint(o.to),l,o.pointRank),l=o.openEnd(h)+(o.to>h?1:0)):h>a&&(i.span(a,h,o.active,l),l=o.openEnd(h)),o.to>r)break;a=o.to,o.next()}return l}static of(e,t=!1){let r=new mi;for(let i of e instanceof er?[e]:t?Vc(e):e)r.add(i.from,i.to,i.value);return r.finish()}}Ne.empty=new Ne([],[],null,-1);function Vc(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(Qn(e,r)>0)return n.slice().sort(Qn);e=r}return n}Ne.empty.nextLayer=Ne.empty;class mi{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new Ms(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new mi)).add(e,t,r)}addInner(e,t,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(Ne.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Ne.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function vo(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=r.get(s.chunk[o]);a!=null&&(t?t.mapPos(a):a)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(a,a+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class Ka{constructor(e,t,r,i=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class tr{constructor(e){this.heap=e}static from(e,t=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new Ka(o,t,r,s));return i.length==1?i[0]:new tr(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)vn(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)vn(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),vn(this.heap,0)}}}function vn(n,e){for(let t=n[e];;){let r=(e<<1)+1;if(r>=n.length)break;let i=n[r];if(r+1<n.length&&i.compare(n[r+1])>=0&&(i=n[r+1],r++),t.compare(i)<0)break;n[r]=t,n[e]=i,e=r}}class Li{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=tr.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){vr(this.active,e),vr(this.activeTo,e),vr(this.activeRank,e),this.minActive=bo(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=s;)t++;wr(this.active,t,r),wr(this.activeTo,t,i),wr(this.activeRank,t,s),e&&wr(e,t,this.cursor.from),this.minActive=bo(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null,i=0;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),r&&vr(r,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(r),this.cursor.from<e&&this.cursor.to>e&&i++,this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.from<e&&(i=1),this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){let s=0;for(;s<r.length&&r[s]<e;)s++;this.openStart=s+i}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function wo(n,e,t,r,i,s){n.goto(e),t.goto(r);let o=r+i,a=r,l=r-e;for(;;){let h=n.to+l-t.to||n.endSide-t.endSide,c=h<0?n.to+l:t.to,u=Math.min(c,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&Zn(n.activeForPoint(n.to+l),t.activeForPoint(t.to))||s.comparePoint(a,u,n.point,t.point):u>a&&!Zn(n.active,t.active)&&s.compareRange(a,u,n.active,t.active),c>o)break;a=c,h<=0&&n.next(),h>=0&&t.next()}}function Zn(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function vr(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function wr(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function bo(n,e){let t=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||n[i].endSide-n[t].endSide)<0&&(t=i,r=e[i]);return t}function Ns(n,e,t=n.length){let r=0;for(let i=0;i<t;)n.charCodeAt(i)==9?(r+=e-r%e,i++):(r++,i=Rt(n,i));return r}function es(n,e,t,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==n.length)break;s+=n.charCodeAt(i)==9?t-s%t:1,i=Rt(n,i)}return r===!0?-1:n.length}const ts="\u037C",So=typeof Symbol>"u"?"__"+ts:Symbol.for(ts),is=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),_o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ei{constructor(e,t){this.rules=[];let{finish:r}=t||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,h){let c=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&a==null)return l.push(o[0]+";");for(let p in a){let d=a[p];if(/&/.test(p))s(p.split(/,\s*/).map(g=>o.map(S=>g.replace(/&/,S))).reduce((g,S)=>g.concat(S)),d,l);else if(d&&typeof d=="object"){if(!u)throw new RangeError("The value of a property ("+p+") should be a primitive value.");s(i(p),d,c,f)}else d!=null&&c.push(p.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+d+";")}(c.length||f)&&l.push((r&&!u&&!h?o.map(r):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=_o[So]||1;return _o[So]=e+1,ts+e.toString(36)}static mount(e,t){(e[is]||new Fc(e)).mount(Array.isArray(t)?t:[t])}}let br=null;class Fc{constructor(e){if(!e.head&&e.adoptedStyleSheets&&typeof CSSStyleSheet<"u"){if(br)return e.adoptedStyleSheets=[br.sheet].concat(e.adoptedStyleSheets),e[is]=br;this.sheet=new CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),br=this}else{this.styleTag=(e.ownerDocument||e).createElement("style");let t=e.head||e;t.insertBefore(this.styleTag,t.firstChild)}this.modules=[],e[is]=this}mount(e){let t=this.sheet,r=0,i=0;for(let s=0;s<e.length;s++){let o=e[s],a=this.modules.indexOf(o);if(a<i&&a>-1&&(this.modules.splice(a,1),i--,a=-1),a==-1){if(this.modules.splice(i++,0,o),t)for(let l=0;l<o.rules.length;l++)t.insertRule(o.rules[l],r++)}else{for(;i<a;)r+=this.modules[i++].rules.length;r+=o.rules.length,i++}}if(!t){let s="";for(let o=0;o<this.modules.length;o++)s+=this.modules[o].getRules()+`
`;this.styleTag.textContent=s}}}var ti={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ir={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},ko=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);var Hc=typeof navigator<"u"&&/Mac/.test(navigator.platform),zc=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Wc=Hc||ko&&+ko[1]<57;for(var Ze=0;Ze<10;Ze++)ti[48+Ze]=ti[96+Ze]=String(Ze);for(var Ze=1;Ze<=24;Ze++)ti[Ze+111]="F"+Ze;for(var Ze=65;Ze<=90;Ze++)ti[Ze]=String.fromCharCode(Ze+32),ir[Ze]=String.fromCharCode(Ze);for(var wn in ti)ir.hasOwnProperty(wn)||(ir[wn]=ti[wn]);function qc(n){var e=Wc&&(n.ctrlKey||n.altKey||n.metaKey)||zc&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?ir:ti)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Kr(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Ai(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Uc(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Ir(n,e){if(!e.anchorNode)return!1;try{return Ai(n,e.anchorNode)}catch{return!1}}function rr(n){return n.nodeType==3?$i(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Gr(n,e,t,r){return t?xo(n,e,t,r,-1)||xo(n,e,t,r,1):!1}function Jr(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function xo(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:nr(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=Jr(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=i<0?nr(n):0}else return!1}}function nr(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const Ga={left:0,right:0,top:0,bottom:0};function un(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Kc(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function Gc(n,e,t,r,i,s,o,a){let l=n.ownerDocument,h=l.defaultView;for(let c=n;c;)if(c.nodeType==1){let u,f=c==l.body;if(f)u=Kc(h);else{if(c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.parentNode;continue}let g=c.getBoundingClientRect();u={left:g.left,right:g.left+c.clientWidth,top:g.top,bottom:g.top+c.clientHeight}}let p=0,d=0;if(i=="nearest")e.top<u.top?(d=-(u.top-e.top+o),t>0&&e.bottom>u.bottom+d&&(d=e.bottom-u.bottom+d+o)):e.bottom>u.bottom&&(d=e.bottom-u.bottom+o,t<0&&e.top-d<u.top&&(d=-(u.top+d-e.top+o)));else{let g=e.bottom-e.top,S=u.bottom-u.top;d=(i=="center"&&g<=S?e.top+g/2-S/2:i=="start"||i=="center"&&t<0?e.top-o:e.bottom-S+o)-u.top}if(r=="nearest"?e.left<u.left?(p=-(u.left-e.left+s),t>0&&e.right>u.right+p&&(p=e.right-u.right+p+s)):e.right>u.right&&(p=e.right-u.right+s,t<0&&e.left<u.left+p&&(p=-(u.left+p-e.left+s))):p=(r=="center"?e.left+(e.right-e.left)/2-(u.right-u.left)/2:r=="start"==a?e.left-s:e.right-(u.right-u.left)+s)-u.left,p||d)if(f)h.scrollBy(p,d);else{if(d){let g=c.scrollTop;c.scrollTop+=d,d=c.scrollTop-g}if(p){let g=c.scrollLeft;c.scrollLeft+=p,p=c.scrollLeft-g}e={left:e.left-p,top:e.top-d,right:e.right-p,bottom:e.bottom-d}}if(f)break;c=c.assignedSlot||c.parentNode,r=i="nearest"}else if(c.nodeType==11)c=c.host;else break}class Jc{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,r,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=i}}let bi=null;function Ja(n){if(n.setActive)return n.setActive();if(bi)return n.focus(bi);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(bi==null?{get preventScroll(){return bi={preventScroll:!0},!0}}:void 0),!bi){bi=!1;for(let t=0;t<e.length;){let r=e[t++],i=e[t++],s=e[t++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let Co;function $i(n,e,t=e){let r=Co||(Co=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function Yi(n,e,t){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0},i=new KeyboardEvent("keydown",r);i.synthetic=!0,n.dispatchEvent(i);let s=new KeyboardEvent("keyup",r);return s.synthetic=!0,n.dispatchEvent(s),i.defaultPrevented||s.defaultPrevented}function Yc(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function Ya(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function Xc(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(;;)if(r){if(t.nodeType!=1)return!1;let i=t.childNodes[r-1];i.contentEditable=="false"?r--:(t=i,r=nr(t))}else{if(t==n)return!0;r=Jr(t),t=t.parentNode}}class nt{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new nt(e.parentNode,Jr(e),t)}static after(e,t){return new nt(e.parentNode,Jr(e)+1,t)}}const Ds=[];class je{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(this.dirty&2){let t=this.dom,r=null,i;for(let s of this.children){if(s.dirty){if(!s.dom&&(i=r?r.nextSibling:t.firstChild)){let o=je.get(i);(!o||!o.parent&&o.constructor==s.constructor)&&s.reuseDOM(i)}s.sync(e),s.dirty=0}if(i=r?r.nextSibling:t.firstChild,e&&!e.written&&e.node==t&&i!=s.dom&&(e.written=!0),s.dom.parentNode==t)for(;i&&i!=s.dom;)i=Eo(i);else t.insertBefore(s.dom,i);r=s.dom}for(i=r?r.nextSibling:t.firstChild,i&&e&&e.node==t&&(e.written=!0);i;)i=Eo(i)}else if(this.dirty&1)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let r;if(e==this.dom)r=this.dom.childNodes[t];else{let i=nr(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!je.get(r);)r=r.nextSibling;if(!r)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==r)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,r=0){let i=-1,s=-1,o=-1,a=-1;for(let l=0,h=r,c=r;l<this.children.length;l++){let u=this.children[l],f=h+u.length;if(h<e&&f>t)return u.domBoundsAround(e,t,h);if(f>=e&&i==-1&&(i=l,s=h),h>t&&u.dom.parentNode==this.dom){o=l,a=c;break}c=f,h=f+u.breakAfter}return{from:s,to:a<0?r+this.length:a,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,r=Ds){this.markDirty();for(let i=e;i<t;i++){let s=this.children[i];s.parent==this&&s.destroy()}this.children.splice(e,t-e,...r);for(let i=0;i<r.length;i++)r[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Xa(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,r,i,s,o){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}}je.prototype.breakAfter=0;function Eo(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Xa{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function Qa(n,e,t,r,i,s,o,a,l){let{children:h}=n,c=h.length?h[e]:null,u=s.length?s[s.length-1]:null,f=u?u.breakAfter:o;if(!(e==r&&c&&!o&&!f&&s.length<2&&c.merge(t,i,s.length?u:null,t==0,a,l))){if(r<h.length){let p=h[r];p&&i<p.length?(e==r&&(p=p.split(i),i=0),!f&&u&&p.merge(0,i,u,!0,0,l)?s[s.length-1]=p:(i&&p.merge(0,i,null,!1,0,l),s.push(p))):p!=null&&p.breakAfter&&(u?u.breakAfter=1:o=1),r++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,a,0),e++));e<r&&s.length;)if(h[r-1].become(s[s.length-1]))r--,s.pop(),l=s.length?0:a;else if(h[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&r<h.length&&!h[e-1].breakAfter&&h[r].merge(0,0,h[e-1],!1,a,l)&&e--,(e<r||s.length)&&n.replaceChildren(e,r,s)}}function Za(n,e,t,r,i,s){let o=n.childCursor(),{i:a,off:l}=o.findPos(t,1),{i:h,off:c}=o.findPos(e,-1),u=e-t;for(let f of r)u+=f.length;n.length+=u,Qa(n,h,c,a,l,r,0,i,s)}let gt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},rs=typeof document<"u"?document:{documentElement:{style:{}}};const ns=/Edge\/(\d+)/.exec(gt.userAgent),el=/MSIE \d/.test(gt.userAgent),ss=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(gt.userAgent),fn=!!(el||ss||ns),Oo=!fn&&/gecko\/(\d+)/i.test(gt.userAgent),bn=!fn&&/Chrome\/(\d+)/.exec(gt.userAgent),To="webkitFontSmoothing"in rs.documentElement.style,tl=!fn&&/Apple Computer/.test(gt.vendor),Ao=tl&&(/Mobile\/\w+/.test(gt.userAgent)||gt.maxTouchPoints>2);var oe={mac:Ao||/Mac/.test(gt.platform),windows:/Win/.test(gt.platform),linux:/Linux|X11/.test(gt.platform),ie:fn,ie_version:el?rs.documentMode||6:ss?+ss[1]:ns?+ns[1]:0,gecko:Oo,gecko_version:Oo?+(/Firefox\/(\d+)/.exec(gt.userAgent)||[0,0])[1]:0,chrome:!!bn,chrome_version:bn?+bn[1]:0,ios:Ao,android:/Android\b/.test(gt.userAgent),webkit:To,safari:tl,webkit_version:To?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:rs.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Qc=256;class ii extends je{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,r){return r&&(!(r instanceof ii)||this.length-(t-e)+r.length>Qc)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new ii(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new nt(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return os(this.dom,e,t)}}class Mt extends je{constructor(e,t=[],r=0){super(),this.mark=e,this.children=t,this.length=r;for(let i of t)i.setParent(this)}setAttrs(e){if(Ya(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,r,i,s,o){return r&&(!(r instanceof Mt&&r.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(Za(this,e,t,r?r.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],r=0,i=-1,s=0;for(let a of this.children){let l=r+a.length;l>e&&t.push(r<e?a.split(e-r):a),i<0&&r>=e&&(i=s),r=l,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new Mt(this.mark,t,o)}domAtPos(e){return nl(this,e)}coordsAt(e,t){return ol(this,e,t)}}function os(n,e,t){let r=n.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;e==0&&t<0||e==r&&t>=0?oe.chrome||oe.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):t<0?i--:s<r&&s++;let a=$i(n,i,s).getClientRects();if(!a.length)return Ga;let l=a[(o?o<0:t>=0)?0:a.length-1];return oe.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,h=>h.width)||l),o?un(l,o<0):l||null}class Yt extends je{constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}static create(e,t,r){return new(e.customView||Yt)(e,t,r)}split(e){let t=Yt.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,r,i,s,o){return r&&(!(r instanceof Yt)||!this.widget.compare(r.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof Yt&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Me.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,r=t&&t.state.doc,i=this.posAtStart;return r?r.slice(i,i+this.length):Me.empty}domAtPos(e){return e==0?nt.before(this.dom):nt.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let r=this.dom.getClientRects(),i=null;if(!r.length)return Ga;for(let s=e>0?r.length-1:0;i=r[s],!(e>0?s==0:s==r.length-1||i.top<i.bottom);s+=e>0?-1:1);return e==0&&t>0||e==this.length&&t<=0?i:un(i,e==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class il extends Yt{domAtPos(e){let{topView:t,text:r}=this.widget;return t?as(e,0,t,r,(i,s)=>i.domAtPos(s),i=>new nt(r,Math.min(i,r.nodeValue.length))):new nt(r,Math.min(e,r.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:r,text:i}=this.widget;return r?rl(e,t,r,i):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:r,text:i}=this.widget;return r?as(e,t,r,i,(s,o,a)=>s.coordsAt(o,a),(s,o)=>os(i,s,o)):os(i,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}}function as(n,e,t,r,i,s){if(t instanceof Mt){for(let o=t.dom.firstChild;o;o=o.nextSibling){let a=je.get(o);if(!a)return s(n,e);let l=Ai(o,r),h=a.length+(l?r.nodeValue.length:0);if(n<h||n==h&&a.getSide()<=0)return l?as(n,e,a,r,i,s):i(a,n,e);n-=h}return i(t,t.length,-1)}else return t.dom==r?s(n,e):i(t,n,e)}function rl(n,e,t,r){if(t instanceof Mt)for(let i of t.children){let s=0,o=Ai(i.dom,r);if(Ai(i.dom,n))return s+(o?rl(n,e,i,r):i.localPosFromDOM(n,e));s+=o?r.nodeValue.length:i.length}else if(t.dom==r)return Math.min(e,r.nodeValue.length);return t.localPosFromDOM(n,e)}class Pi extends je{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Pi&&e.side==this.side}split(){return new Pi(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return nt.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),r=Zc(this,this.side>0?-1:1);return r&&r.top<t.bottom&&r.bottom>t.top?{left:t.left,right:t.right,top:r.top,bottom:r.bottom}:t}get overrideDOMText(){return Me.empty}}ii.prototype.children=Yt.prototype.children=Pi.prototype.children=Ds;function Zc(n,e){let t=n.parent,r=t?t.children.indexOf(n):-1;for(;t&&r>=0;)if(e<0?r>0:r<t.children.length){let i=t.children[r+e];if(i instanceof ii){let s=i.coordsAt(e<0?i.length:0,e);if(s)return s}r+=e}else if(t instanceof Mt&&t.parent)r=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let i=t.dom.lastChild;if(i&&i.nodeName=="BR")return i.getClientRects()[0];break}}function nl(n,e){let t=n.dom,{children:r}=n,i=0;for(let s=0;i<r.length;i++){let o=r[i],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=i;s>0;s--){let o=r[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=i;s<r.length;s++){let o=r[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new nt(t,0)}function sl(n,e,t){let r,{children:i}=n;t>0&&e instanceof Mt&&i.length&&(r=i[i.length-1])instanceof Mt&&r.mark.eq(e.mark)?sl(r,e.children[0],t-1):(i.push(e),e.setParent(n)),n.length+=e.length}function ol(n,e,t){for(let s=0,o=0;o<n.children.length;o++){let a=n.children[o],l=s+a.length,h;if((t<=0||l==n.length||a.getSide()>0?l>=e:l>e)&&(e<l||o+1==n.children.length||(h=n.children[o+1]).length||h.getSide()>0)){let c=0;if(l==s){if(a.getSide()<=0)continue;c=t=-a.getSide()}let u=a.coordsAt(Math.max(0,e-s),t);return c&&u?un(u,t<0):u}s=l}let r=n.dom.lastChild;if(!r)return n.dom.getBoundingClientRect();let i=rr(r);return i[i.length-1]||null}function ls(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}function Rs(n,e){if(n==e)return!0;if(!n||!e)return!1;let t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let i of t)if(r.indexOf(i)==-1||n[i]!==e[i])return!1;return!0}function hs(n,e,t){let r=null;if(e)for(let i in e)t&&i in t||n.removeAttribute(r=i);if(t)for(let i in t)e&&e[i]==t[i]||n.setAttribute(r=i,t[i]);return!!r}class vi{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var De=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(De||(De={}));class Ee extends Ti{constructor(e,t,r,i){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new dn(e)}static widget(e){let t=e.side||0,r=!!e.block;return t+=r?t>0?3e8:-4e8:t>0?1e8:-1e8,new gi(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,i;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=al(e,t);r=(s?t?-3e8:-1:5e8)-1,i=(o?t?2e8:1:-6e8)+1}return new gi(e,r,i,t,e.widget||null,!0)}static line(e){return new hr(e)}static set(e,t=!1){return Ne.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ee.none=Ne.empty;class dn extends Ee{constructor(e){let{start:t,end:r}=al(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof dn&&this.tagName==e.tagName&&this.class==e.class&&Rs(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}dn.prototype.point=!1;class hr extends Ee{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof hr&&Rs(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}hr.prototype.mapMode=ft.TrackBefore;hr.prototype.point=!0;class gi extends Ee{constructor(e,t,r,i,s,o){super(t,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?t<=0?ft.TrackBefore:ft.TrackAfter:ft.TrackDel}get type(){return this.startSide<this.endSide?De.WidgetRange:this.startSide<=0?De.WidgetBefore:De.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof gi&&eu(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}gi.prototype.point=!0;function al(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return t==null&&(t=n.inclusive),r==null&&(r=n.inclusive),{start:t!=null?t:e,end:r!=null?r:e}}function eu(n,e){return n==e||!!(n&&e&&n.compare(e))}function cs(n,e,t,r=0){let i=t.length-1;i>=0&&t[i]+r>=n?t[i]=Math.max(t[i],e):t.push(n,e)}class ht extends je{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,i,s,o){if(r){if(!(r instanceof ht))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),Za(this,e,t,r?r.children:[],s,o),!0}split(e){let t=new ht;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:r,off:i}=this.childPos(e);i&&(t.append(this.children[r].split(i),0),this.children[r].merge(i,this.children[r].length,null,!1,0,0),r++);for(let s=r;s<this.children.length;s++)t.append(this.children[s],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,t}transferDOM(e){!this.dom||(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Rs(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){sl(this,e,t)}addLineDeco(e){let t=e.spec.attributes,r=e.spec.class;t&&(this.attrs=ls(t,this.attrs||{})),r&&(this.attrs=ls({class:r},this.attrs||{}))}domAtPos(e){return nl(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?this.dirty&4&&(Ya(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(hs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let r=this.dom.lastChild;for(;r&&je.get(r)instanceof Mt;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((t=je.get(r))===null||t===void 0?void 0:t.isEditable)==!1&&(!oe.ios||!this.children.some(i=>i instanceof ii))){let i=document.createElement("BR");i.cmIgnore=!0,this.dom.appendChild(i)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof ii)||/[^ -~]/.test(t.text))return null;let r=rr(t.dom);if(r.length!=1)return null;e+=r[0].width}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}:null}coordsAt(e,t){return ol(this,e,t)}become(e){return!1}get type(){return De.Text}static find(e,t){for(let r=0,i=0;r<e.children.length;r++){let s=e.children[r],o=i+s.length;if(o>=t){if(s instanceof ht)return s;if(o>t)break}i=o+s.breakAfter}return null}}class fi extends je{constructor(e,t,r){super(),this.widget=e,this.length=t,this.type=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,i,s,o){return r&&(!(r instanceof fi)||!this.widget.compare(r.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?nt.before(this.dom):nt.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let r=new fi(this.widget,t,this.type);return r.breakAfter=this.breakAfter,r}get children(){return Ds}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Me.empty}domBoundsAround(){return null}become(e){return e instanceof fi&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Is{constructor(e,t,r,i){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof fi&&e.type==De.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new ht),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(Sr(new Pi(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,r){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}else this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,r)),this.getLine().append(Sr(new ii(this.text.slice(this.textOff,this.textOff+i)),t),r),this.atCursorPos=!0,this.textOff+=i,e-=i,r=0}}span(e,t,r,i){this.buildText(t-e,r,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,r,i,s,o){if(this.disallowBlockEffectsFor[o]&&r instanceof gi){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=t-e;if(r instanceof gi)if(r.block){let{type:l}=r;l==De.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new fi(r.widget||new $o("div"),a,l))}else{let l=Yt.create(r.widget||new $o("span"),a,r.startSide),h=this.atCursorPos&&!l.isEditable&&s<=i.length&&(e<t||r.startSide>0),c=!l.isEditable&&(e<t||r.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!h&&(this.pendingBuffer=0),this.flushBuffer(i),h&&(u.append(Sr(new Pi(1),i),s),s=i.length+Math.max(0,s-i.length)),u.append(Sr(l,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,r,i,s){let o=new Is(e,t,r,s);return o.openEnd=Ne.spans(i,t,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Sr(n,e){for(let t of e)n=new Mt(t,[n],n.length);return n}class $o extends vi{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const ll=he.define(),hl=he.define(),cl=he.define(),ul=he.define(),us=he.define(),fl=he.define(),dl=he.define({combine:n=>n.some(e=>e)});class Yr{constructor(e,t="nearest",r="nearest",i=5,s=5){this.range=e,this.y=t,this.x=r,this.yMargin=i,this.xMargin=s}map(e){return e.empty?this:new Yr(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const Po=Ve.define({map:(n,e)=>n.map(e)});function jt(n,e,t){let r=n.facet(ul);r.length?r[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const pn=he.define({combine:n=>n.length?n[0]:!0});let tu=0;const Vi=he.define();class ot{constructor(e,t,r,i){this.id=e,this.create=t,this.domEventHandlers=r,this.extension=i(this)}static define(e,t){const{eventHandlers:r,provide:i,decorations:s}=t||{};return new ot(tu++,e,r,o=>{let a=[Vi.of(o)];return s&&a.push(sr.of(l=>{let h=l.plugin(o);return h?s(h):Ee.none})),i&&a.push(i(o)),a})}static fromClass(e,t){return ot.define(r=>new e(r),t)}}class Sn{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(jt(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){jt(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){jt(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const pl=he.define(),ml=he.define(),sr=he.define(),gl=he.define(),yl=he.define(),Fi=he.define();class Bt{constructor(e,t,r,i){this.fromA=e,this.toA=t,this.fromB=r,this.toB=i}join(e){return new Bt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let i=0,s=0,o=0,a=0;;i++){let l=i==e.length?null:e[i],h=o-a,c=l?l.fromB:1e9;for(;s<t.length&&t[s]<c;){let u=t[s],f=t[s+1],p=Math.max(a,u),d=Math.min(c,f);if(p<=d&&new Bt(p+h,d+h,p,d).addToSet(r),f>c)break;s+=2}if(!l)return r;new Bt(l.fromA,l.toA,l.fromB,l.toB).addToSet(r),o=l.toA,a=l.toB}}}class Xr{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Je.empty(this.startState.doc.length);for(let o of r)this.changes=this.changes.compose(o.changes);let i=[];this.changes.iterChangedRanges((o,a,l,h)=>i.push(new Bt(o,a,l,h))),this.changedRanges=i;let s=e.hasFocus;s!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=s,this.flags|=1)}static create(e,t,r){return new Xr(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var We=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(We||(We={}));const fs=We.LTR,iu=We.RTL;function vl(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const ru=vl("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),nu=vl("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ds=Object.create(null),Et=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);ds[e]=t,ds[t]=-e}function su(n){return n<=247?ru[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?nu[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203?256:64336<=n&&n<=65023?4:n==8204?256:1}const ou=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ci{constructor(e,t,r){this.from=e,this.to=t,this.level=r}get dir(){return this.level%2?iu:fs}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,r,i){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==r)return o;(s<0||(i!=0?i<0?a.from<t:a.to>t:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}const Fe=[];function au(n,e){let t=n.length,r=e==fs?1:2,i=e==fs?2:1;if(!n||r==1&&!ou.test(n))return wl(t);for(let o=0,a=r,l=r;o<t;o++){let h=su(n.charCodeAt(o));h==512?h=a:h==8&&l==4&&(h=16),Fe[o]=h==4?2:h,h&7&&(l=h),a=h}for(let o=0,a=r,l=r;o<t;o++){let h=Fe[o];if(h==128)o<t-1&&a==Fe[o+1]&&a&24?h=Fe[o]=a:Fe[o]=256;else if(h==64){let c=o+1;for(;c<t&&Fe[c]==64;)c++;let u=o&&a==8||c<t&&Fe[c]==8?l==1?1:8:256;for(let f=o;f<c;f++)Fe[f]=u;o=c-1}else h==8&&l==1&&(Fe[o]=1);a=h,h&7&&(l=h)}for(let o=0,a=0,l=0,h,c,u;o<t;o++)if(c=ds[h=n.charCodeAt(o)])if(c<0){for(let f=a-3;f>=0;f-=3)if(Et[f+1]==-c){let p=Et[f+2],d=p&2?r:p&4?p&1?i:r:0;d&&(Fe[o]=Fe[Et[f]]=d),a=f;break}}else{if(Et.length==189)break;Et[a++]=o,Et[a++]=h,Et[a++]=l}else if((u=Fe[o])==2||u==1){let f=u==r;l=f?0:1;for(let p=a-3;p>=0;p-=3){let d=Et[p+2];if(d&2)break;if(f)Et[p+2]|=2;else{if(d&4)break;Et[p+2]|=4}}}for(let o=0;o<t;o++)if(Fe[o]==256){let a=o+1;for(;a<t&&Fe[a]==256;)a++;let l=(o?Fe[o-1]:r)==1,h=(a<t?Fe[a]:r)==1,c=l==h?l?1:2:r;for(let u=o;u<a;u++)Fe[u]=c;o=a-1}let s=[];if(r==1)for(let o=0;o<t;){let a=o,l=Fe[o++]!=1;for(;o<t&&l==(Fe[o]!=1);)o++;if(l)for(let h=o;h>a;){let c=h,u=Fe[--h]!=2;for(;h>a&&u==(Fe[h-1]!=2);)h--;s.push(new Ci(h,c,u?2:1))}else s.push(new Ci(a,o,0))}else for(let o=0;o<t;){let a=o,l=Fe[o++]==2;for(;o<t&&l==(Fe[o]==2);)o++;s.push(new Ci(a,o,l?1:2))}return s}function wl(n){return[new Ci(0,n,0)]}let bl="";function lu(n,e,t,r,i){var s;let o=r.head-n.from,a=-1;if(o==0){if(!i||!n.length)return null;e[0].level!=t&&(o=e[0].side(!1,t),a=0)}else if(o==n.length){if(i)return null;let f=e[e.length-1];f.level!=t&&(o=f.side(!0,t),a=e.length-1)}a<0&&(a=Ci.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc));let l=e[a];o==l.side(i,t)&&(l=e[a+=i?1:-1],o=l.side(!i,t));let h=i==(l.dir==t),c=Rt(n.text,o,h);if(bl=n.text.slice(Math.min(o,c),Math.max(o,c)),c!=l.side(i,t))return ae.cursor(c+n.from,h?-1:1,l.level);let u=a==(i?e.length-1:0)?null:e[a+(i?1:-1)];return!u&&l.level!=t?ae.cursor(i?n.to:n.from,i?-1:1,t):u&&u.level<l.level?ae.cursor(u.side(!i,t)+n.from,i?1:-1,u.level):ae.cursor(c+n.from,i?-1:1,l.level)}const Xt="\uFFFF";class Sl{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Te.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Xt}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i),this.readNode(i);let s=i.nextSibling;if(s==t)break;let o=je.get(i),a=je.get(s);(o&&a?o.breakAfter:(o?o.breakAfter:Mo(i))||Mo(s)&&(i.nodeName!="BR"||i.cmIgnore))&&this.lineBreak(),i=s}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(a=i.exec(t))&&(s=a.index,o=a[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);r=s+o}}readNode(e){if(e.cmIgnore)return;let t=je.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+Math.min(t,r.offset))}}function Mo(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class No{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Do extends je{constructor(e){super(),this.view=e,this.compositionDeco=Ee.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new ht],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Bt(0,0,0,e.state.doc.length)],0)}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:o,toA:a})=>a<this.minWidthFrom||o>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Ee.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=cu(this.view,e.changes)),(oe.ie||oe.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let r=this.decorations,i=this.updateDeco(),s=pu(r,i,e.changes);return t=Bt.extendWithRanges(t,s),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=oe.chrome||oe.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(s),this.dirty=0,s&&(s.written||r.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""});let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof fi&&s.widget instanceof Ro&&i.push(s.dom);r.updateGaps(i)}updateChildren(e,t){let r=this.childCursor(t);for(let i=e.length-1;;i--){let s=i>=0?e[i]:null;if(!s)break;let{fromA:o,toA:a,fromB:l,toB:h}=s,{content:c,breakAtStart:u,openStart:f,openEnd:p}=Is.build(this.view.state.doc,l,h,this.decorations,this.dynamicDecorationMap),{i:d,off:g}=r.findPos(a,1),{i:S,off:m}=r.findPos(o,-1);Qa(this,S,m,d,g,c,u,f,p)}}updateSelection(e=!1,t=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection())||oe.ios&&this.view.inputState.rapidCompositionStart)return;let r=this.forceSelection;this.forceSelection=!1;let i=this.view.state.selection.main,s=this.domAtPos(i.anchor),o=i.empty?s:this.domAtPos(i.head);if(oe.gecko&&i.empty&&hu(s)){let l=document.createTextNode("");this.view.observer.ignore(()=>s.node.insertBefore(l,s.node.childNodes[s.offset]||null)),s=o=new nt(l,0),r=!0}let a=this.view.observer.selectionRange;(r||!a.focusNode||!Gr(s.node,s.offset,a.anchorNode,a.anchorOffset)||!Gr(o.node,o.offset,a.focusNode,a.focusOffset))&&(this.view.observer.ignore(()=>{oe.android&&oe.chrome&&this.dom.contains(a.focusNode)&&mu(a.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let l=Kr(this.view.root);if(l)if(i.empty){if(oe.gecko){let h=fu(s.node,s.offset);if(h&&h!=3){let c=kl(s.node,s.offset,h==1?1:-1);c&&(s=new nt(c,h==1?0:c.nodeValue.length))}}l.collapse(s.node,s.offset),i.bidiLevel!=null&&a.cursorBidiLevel!=null&&(a.cursorBidiLevel=i.bidiLevel)}else if(l.extend)l.collapse(s.node,s.offset),l.extend(o.node,o.offset);else{let h=document.createRange();i.anchor>i.head&&([s,o]=[o,s]),h.setEnd(o.node,o.offset),h.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(h)}}),this.view.observer.setSelectionRange(s,o)),this.impreciseAnchor=s.precise?null:new nt(a.anchorNode,a.anchorOffset),this.impreciseHead=o.precise?null:new nt(a.focusNode,a.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=Kr(this.view.root);if(!t||!e.empty||!e.assoc||!t.modify)return;let r=ht.find(this,e.head);if(!r)return;let i=r.posAtStart;if(e.head==i||e.head==i+r.length)return;let s=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(!s||!o||s.bottom>o.top)return;let a=this.domAtPos(e.head+e.assoc);t.collapse(a.node,a.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||Ir(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let t=e;t;){let r=je.get(t);if(r&&r.rootView==this)return r;t=t.parentNode}return null}posFromDOM(e,t){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(r<i.length||i instanceof ht)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(e,t){for(let r=this.length,i=this.children.length-1;;i--){let s=this.children[i],o=r-s.breakAfter-s.length;if(e>o||e==o&&s.type!=De.WidgetBefore&&s.type!=De.WidgetAfter&&(!i||t==2||this.children[i-1].breakAfter||this.children[i-1].type==De.WidgetBefore&&t>-2))return s.coordsAt(e-o,t);r=o}}measureVisibleLineHeights(e){let t=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==We.LTR;for(let h=0,c=0;c<this.children.length;c++){let u=this.children[c],f=h+u.length;if(f>i)break;if(h>=r){let p=u.dom.getBoundingClientRect();if(t.push(p.height),o){let d=u.dom.lastChild,g=d?rr(d):[];if(g.length){let S=g[g.length-1],m=l?S.right-p.left:p.right-S.left;m>a&&(a=m,this.minWidth=s,this.minWidthFrom=h,this.minWidthTo=f)}}}h=f+u.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?We.RTL:We.LTR}measureTextSize(){for(let i of this.children)if(i instanceof ht){let s=i.measureTextSize();if(s)return s}let e=document.createElement("div"),t,r;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let i=rr(e.firstChild)[0];t=e.getBoundingClientRect().height,r=i?i.width/27:7,e.remove()}),{lineHeight:t,charWidth:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Xa(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],o=s?s.from-1:this.length;if(o>r){let a=t.lineBlockAt(o).bottom-t.lineBlockAt(r).top;e.push(Ee.replace({widget:new Ro(a),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return Ee.set(e)}updateDeco(){let e=this.view.state.facet(sr).map((t,r)=>(this.dynamicDecorationMap[r]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!r)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=0,o=0,a=0,l=0;for(let c of this.view.state.facet(yl).map(u=>u(this.view)))if(c){let{left:u,right:f,top:p,bottom:d}=c;u!=null&&(s=Math.max(s,u)),f!=null&&(o=Math.max(o,f)),p!=null&&(a=Math.max(a,p)),d!=null&&(l=Math.max(l,d))}let h={left:r.left-s,top:r.top-a,right:r.right+o,bottom:r.bottom+l};Gc(this.view.scrollDOM,h,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==We.LTR)}}function hu(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class Ro extends vi{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function _l(n){let e=n.observer.selectionRange,t=e.focusNode&&kl(e.focusNode,e.focusOffset,0);if(!t)return null;let r=n.docView.nearest(t);if(!r)return null;if(r instanceof ht){let i=t;for(;i.parentNode!=r.dom;)i=i.parentNode;let s=i.previousSibling;for(;s&&!je.get(s);)s=s.previousSibling;let o=s?je.get(s).posAtEnd:r.posAtStart;return{from:o,to:o,node:i,text:t}}else{for(;;){let{parent:s}=r;if(!s)return null;if(s instanceof ht)break;r=s}let i=r.posAtStart;return{from:i,to:i+r.length,node:r.dom,text:t}}}function cu(n,e){let t=_l(n);if(!t)return Ee.none;let{from:r,to:i,node:s,text:o}=t,a=e.mapPos(r,1),l=Math.max(a,e.mapPos(i,-1)),{state:h}=n,c=s.nodeType==3?s.nodeValue:new Sl([],h).readRange(s.firstChild,null).text;if(l-a<c.length)if(h.doc.sliceString(a,Math.min(h.doc.length,a+c.length),Xt)==c)l=a+c.length;else if(h.doc.sliceString(Math.max(0,l-c.length),l,Xt)==c)a=l-c.length;else return Ee.none;else if(h.doc.sliceString(a,l,Xt)!=c)return Ee.none;let u=je.get(s);return u instanceof il?u=u.widget.topView:u&&(u.parent=null),Ee.set(Ee.replace({widget:new uu(s,o,u),inclusive:!0}).range(a,l))}class uu extends vi{constructor(e,t,r){super(),this.top=e,this.text=t,this.topView=r}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return il}}function kl(n,e,t){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0&&t<=0)n=n.childNodes[e-1],e=nr(n);else if(n.nodeType==1&&e<n.childNodes.length&&t>=0)n=n.childNodes[e],e=0;else return null}}function fu(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class du{constructor(){this.changes=[]}compareRange(e,t){cs(e,t,this.changes)}comparePoint(e,t){cs(e,t,this.changes)}}function pu(n,e,t){let r=new du;return Ne.compare(n,e,t,r),r.changes}function mu(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function gu(n,e,t=1){let r=n.charCategorizer(e),i=n.doc.lineAt(e),s=e-i.from;if(i.length==0)return ae.cursor(e);s==0?t=1:s==i.length&&(t=-1);let o=s,a=s;t<0?o=Rt(i.text,s,!1):a=Rt(i.text,s);let l=r(i.text.slice(o,a));for(;o>0;){let h=Rt(i.text,o,!1);if(r(i.text.slice(h,o))!=l)break;o=h}for(;a<i.length;){let h=Rt(i.text,a);if(r(i.text.slice(a,h))!=l)break;a=h}return ae.range(o+i.from,a+i.from)}function yu(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function vu(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function _n(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function Io(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function Lo(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function ps(n,e,t){let r,i,s,o,a=!1,l,h,c,u;for(let d=n.firstChild;d;d=d.nextSibling){let g=rr(d);for(let S=0;S<g.length;S++){let m=g[S];i&&_n(i,m)&&(m=Io(Lo(m,i.bottom),i.top));let y=yu(e,m),w=vu(t,m);if(y==0&&w==0)return d.nodeType==3?jo(d,e,t):ps(d,e,t);(!r||o>w||o==w&&s>y)&&(r=d,i=m,s=y,o=w,a=!y||(y>0?S<g.length-1:S>0)),y==0?t>m.bottom&&(!c||c.bottom<m.bottom)?(l=d,c=m):t<m.top&&(!u||u.top>m.top)&&(h=d,u=m):c&&_n(c,m)?c=Lo(c,m.bottom):u&&_n(u,m)&&(u=Io(u,m.top))}}if(c&&c.bottom>=t?(r=l,i=c):u&&u.top<=t&&(r=h,i=u),!r)return{node:n,offset:0};let f=Math.max(i.left,Math.min(i.right,e));if(r.nodeType==3)return jo(r,f,t);if(a&&r.contentEditable!="false")return ps(r,f,t);let p=Array.prototype.indexOf.call(n.childNodes,r)+(e>=(i.left+i.right)/2?1:0);return{node:n,offset:p}}function jo(n,e,t){let r=n.nodeValue.length,i=-1,s=1e9,o=0;for(let a=0;a<r;a++){let l=$i(n,a,a+1).getClientRects();for(let h=0;h<l.length;h++){let c=l[h];if(c.top==c.bottom)continue;o||(o=e-c.left);let u=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&u<s){let f=e>=(c.left+c.right)/2,p=f;if((oe.chrome||oe.gecko)&&$i(n,a).getBoundingClientRect().left==c.right&&(p=!f),u<=0)return{node:n,offset:a+(p?1:0)};i=a+(p?1:0),s=u}}}return{node:n,offset:i>-1?i:o>0?n.nodeValue.length:0}}function xl(n,{x:e,y:t},r,i=-1){var s;let o=n.contentDOM.getBoundingClientRect(),a=o.top+n.viewState.paddingTop,l,{docHeight:h}=n.viewState,c=t-a;if(c<0)return 0;if(c>h)return n.state.doc.length;for(let m=n.defaultLineHeight/2,y=!1;l=n.elementAtHeight(c),l.type!=De.Text;)for(;c=i>0?l.bottom+m:l.top-m,!(c>=0&&c<=h);){if(y)return r?null:0;y=!0,i=-i}t=a+c;let u=l.from;if(u<n.viewport.from)return n.viewport.from==0?0:r?null:Bo(n,o,l,e,t);if(u>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:r?null:Bo(n,o,l,e,t);let f=n.dom.ownerDocument,p=n.root.elementFromPoint?n.root:f,d=p.elementFromPoint(e,t);d&&!n.contentDOM.contains(d)&&(d=null),d||(e=Math.max(o.left+1,Math.min(o.right-1,e)),d=p.elementFromPoint(e,t),d&&!n.contentDOM.contains(d)&&(d=null));let g,S=-1;if(d&&((s=n.docView.nearest(d))===null||s===void 0?void 0:s.isEditable)!=!1){if(f.caretPositionFromPoint){let m=f.caretPositionFromPoint(e,t);m&&({offsetNode:g,offset:S}=m)}else if(f.caretRangeFromPoint){let m=f.caretRangeFromPoint(e,t);m&&({startContainer:g,startOffset:S}=m,(!n.contentDOM.contains(g)||oe.safari&&wu(g,S,e)||oe.chrome&&bu(g,S,e))&&(g=void 0))}}if(!g||!n.docView.dom.contains(g)){let m=ht.find(n.docView,u);if(!m)return c>l.top+l.height/2?l.to:l.from;({node:g,offset:S}=ps(m.dom,e,t))}return n.docView.posFromDOM(g,S)}function Bo(n,e,t,r,i){let s=Math.round((r-e.left)*n.defaultCharacterWidth);n.lineWrapping&&t.height>n.defaultLineHeight*1.5&&(s+=Math.floor((i-t.top)/n.defaultLineHeight)*n.viewState.heightOracle.lineLength);let o=n.state.sliceDoc(t.from,t.to);return t.from+es(o,s,n.state.tabSize)}function wu(n,e,t){let r;if(n.nodeType!=3||e!=(r=n.nodeValue.length))return!1;for(let i=n.nextSibling;i;i=i.nextSibling)if(i.nodeType!=1||i.nodeName!="BR")return!1;return $i(n,r-1,r).getBoundingClientRect().left>t}function bu(n,e,t){if(e!=0)return!1;for(let i=n;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let r=n.nodeType==1?n.getBoundingClientRect():$i(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-r.left>5}function Su(n,e,t,r){let i=n.state.doc.lineAt(e.head),s=!r||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let l=n.dom.getBoundingClientRect(),h=n.textDirectionAt(i.from),c=n.posAtCoords({x:t==(h==We.LTR)?l.right-1:l.left+1,y:(s.top+s.bottom)/2});if(c!=null)return ae.cursor(c,t?-1:1)}let o=ht.find(n.docView,e.head),a=o?t?o.posAtEnd:o.posAtStart:t?i.to:i.from;return ae.cursor(a,t?-1:1)}function Vo(n,e,t,r){let i=n.state.doc.lineAt(e.head),s=n.bidiSpans(i),o=n.textDirectionAt(i.from);for(let a=e,l=null;;){let h=lu(i,s,o,a,t),c=bl;if(!h){if(i.number==(t?n.state.doc.lines:1))return a;c=`
`,i=n.state.doc.line(i.number+(t?1:-1)),s=n.bidiSpans(i),h=ae.cursor(t?i.from:i.to)}if(l){if(!l(c))return a}else{if(!r)return h;l=r(c)}a=h}}function _u(n,e,t){let r=n.state.charCategorizer(e),i=r(t);return s=>{let o=r(s);return i==It.Space&&(i=o),i==o}}function ku(n,e,t,r){let i=e.head,s=t?1:-1;if(i==(t?n.state.doc.length:0))return ae.cursor(i,e.assoc);let o=e.goalColumn,a,l=n.contentDOM.getBoundingClientRect(),h=n.coordsAtPos(i),c=n.documentTop;if(h)o==null&&(o=h.left-l.left),a=s<0?h.top:h.bottom;else{let p=n.viewState.lineBlockAt(i);o==null&&(o=Math.min(l.right-l.left,n.defaultCharacterWidth*(i-p.from))),a=(s<0?p.top:p.bottom)+c}let u=l.left+o,f=r!=null?r:n.defaultLineHeight>>1;for(let p=0;;p+=10){let d=a+(f+p)*s,g=xl(n,{x:u,y:d},!1,s);if(d<l.top||d>l.bottom||(s<0?g<i:g>i))return ae.cursor(g,e.assoc,void 0,o)}}function kn(n,e,t){let r=n.state.facet(gl).map(i=>i(n));for(;;){let i=!1;for(let s of r)s.between(t.from-1,t.from+1,(o,a,l)=>{t.from>o&&t.from<a&&(t=e.from>t.from?ae.cursor(o,1):ae.cursor(a,-1),i=!0)});if(!i)return t}}class xu{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let t in Ye){let r=Ye[t];e.contentDOM.addEventListener(t,i=>{!Fo(e,i)||this.ignoreDuringComposition(i)||t=="keydown"&&this.keydown(e,i)||(this.mustFlushObserver(i)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,i)?i.preventDefault():r(e,i))},ms[t]),this.registeredEvents.push(t)}oe.chrome&&oe.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,oe.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var r;let i;this.customHandlers=[];for(let s of t)if(i=(r=s.update(e).spec)===null||r===void 0?void 0:r.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:i});for(let o in i)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),e.contentDOM.addEventListener(o,a=>{!Fo(e,a)||this.runCustomHandlers(o,e,a)&&a.preventDefault()}))}}runCustomHandlers(e,t,r){for(let i of this.customHandlers){let s=i.handlers[e];if(s)try{if(s.call(i.plugin,r,t)||r.defaultPrevented)return!0}catch(o){jt(t.state,o)}}return!1}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let r of this.customHandlers){let i=r.handlers.scroll;if(i)try{i.call(r.plugin,t,e)}catch(s){jt(e.state,s)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(oe.android&&oe.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let r;return oe.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((r=Cl.find(i=>i.keyCode==t.keyCode))&&!t.ctrlKey||Cu.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=r||t,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,Yi(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:oe.safari&&!oe.ios&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229||e.type=="compositionend"&&!oe.ios}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Cl=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Cu="dthko",El=[16,17,18,20,91,92,224,225];class Eu{constructor(e,t,r,i){this.view=e,this.style=r,this.mustSelect=i,this.lastEvent=t;let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Te.allowMultipleSelections)&&Ou(e,t),this.dragMove=Tu(e,t),this.dragging=Au(e,t)&&Ls(t)==1?null:!1,this.dragging===!1&&(t.preventDefault(),this.select(t))}move(e){if(e.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=e)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Ou(n,e){let t=n.state.facet(ll);return t.length?t[0](e):oe.mac?e.metaKey:e.ctrlKey}function Tu(n,e){let t=n.state.facet(hl);return t.length?t[0](e):oe.mac?!e.altKey:!e.ctrlKey}function Au(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=Kr(n.root);if(!r||r.rangeCount==0)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Fo(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=je.get(t))&&r.ignoreEvent(e))return!1;return!0}const Ye=Object.create(null),ms=Object.create(null),Ol=oe.ie&&oe.ie_version<15||oe.ios&&oe.webkit_version<604;function $u(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),Tl(n,t.value)},50)}function Tl(n,e){let{state:t}=n,r,i=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(gs!=null&&t.selection.ranges.every(l=>l.empty)&&gs==s.toString()){let l=-1;r=t.changeByRange(h=>{let c=t.doc.lineAt(h.from);if(c.from==l)return{range:h};l=c.from;let u=t.toText((o?s.line(i++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:u},range:ae.cursor(h.from+u.length)}})}else o?r=t.changeByRange(l=>{let h=s.line(i++);return{changes:{from:l.from,to:l.to,insert:h.text},range:ae.cursor(l.from+h.length)}}):r=t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Ye.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():El.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};Ye.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};Ye.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};ms.touchstart=ms.touchmove={passive:!0};Ye.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3&&Ls(e)==1)return;let t=null;for(let r of n.state.facet(cl))if(t=r(n,e),t)break;if(!t&&e.button==0&&(t=Nu(n,e)),t){let r=n.root.activeElement!=n.contentDOM;r&&n.observer.ignore(()=>Ja(n.contentDOM)),n.inputState.startMouseSelection(new Eu(n,e,t,r))}};function Ho(n,e,t,r){if(r==1)return ae.cursor(e,t);if(r==2)return gu(n.state,e,t);{let i=ht.find(n.docView,e),s=n.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,a=i?i.posAtEnd:s.to;return a<n.state.doc.length&&a==s.to&&a++,ae.range(o,a)}}let Al=(n,e)=>n>=e.top&&n<=e.bottom,zo=(n,e,t)=>Al(e,t)&&n>=t.left&&n<=t.right;function Pu(n,e,t,r){let i=ht.find(n.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&zo(t,r,o))return-1;let a=i.coordsAt(s,1);return a&&zo(t,r,a)?1:o&&Al(r,o)?-1:1}function Wo(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Pu(n,t,e.clientX,e.clientY)}}const Mu=oe.ie&&oe.ie_version<=11;let qo=null,Uo=0,Ko=0;function Ls(n){if(!Mu)return n.detail;let e=qo,t=Ko;return qo=n,Ko=Date.now(),Uo=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(Uo+1)%3:1}function Nu(n,e){let t=Wo(n,e),r=Ls(e),i=n.state.selection,s=t,o=e;return{update(a){a.docChanged&&(t&&(t.pos=a.changes.mapPos(t.pos)),i=i.map(a.changes),o=null)},get(a,l,h){let c;if(o&&a.clientX==o.clientX&&a.clientY==o.clientY?c=s:(c=s=Wo(n,a),o=a),!c||!t)return i;let u=Ho(n,c.pos,c.bias,r);if(t.pos!=c.pos&&!l){let f=Ho(n,t.pos,t.bias,r),p=Math.min(f.from,u.from),d=Math.max(f.to,u.to);u=p<u.from?ae.range(p,d):ae.range(d,p)}return l?i.replaceRange(i.main.extend(u.from,u.to)):h&&i.ranges.length>1&&i.ranges.some(f=>f.eq(u))?Du(i,u):h?i.addRange(u):ae.create([u])}}}function Du(n,e){for(let t=0;;t++)if(n.ranges[t].eq(e))return ae.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}Ye.dragstart=(n,e)=>{let{selection:{main:t}}=n.state,{mouseSelection:r}=n.inputState;r&&(r.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function Go(n,e,t,r){if(!t)return;let i=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=n.inputState,o=r&&s&&s.dragging&&s.dragMove?{from:s.dragging.from,to:s.dragging.to}:null,a={from:i,insert:t},l=n.state.changes(o?[o,a]:a);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"})}Ye.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let r=Array(t.length),i=0,s=()=>{++i==t.length&&Go(n,e,r.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(r[o]=a.result),s()},a.readAsText(t[o])}}else Go(n,e,e.dataTransfer.getData("Text"),!0)};Ye.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let t=Ol?null:e.clipboardData;t?(Tl(n,t.getData("text/plain")),e.preventDefault()):$u(n)};function Ru(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}function Iu(n){let e=[],t=[],r=!1;for(let i of n.selection.ranges)i.empty||(e.push(n.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>i&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),i=o.number}r=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:r}}let gs=null;Ye.copy=Ye.cut=(n,e)=>{let{text:t,ranges:r,linewise:i}=Iu(n.state);if(!t&&!i)return;gs=i?t:null;let s=Ol?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",t)):Ru(n,t),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})};function $l(n){setTimeout(()=>{n.hasFocus!=n.inputState.notifiedFocused&&n.update([])},10)}Ye.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),$l(n)};Ye.blur=n=>{n.observer.clearSelectionRange(),$l(n)};function Pl(n,e){if(n.docView.compositionDeco.size){n.inputState.rapidCompositionStart=e;try{n.update([])}finally{n.inputState.rapidCompositionStart=!1}}}Ye.compositionstart=Ye.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0,n.docView.compositionDeco.size&&(n.observer.flush(),Pl(n,!0)))};Ye.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionFirstChange=null,setTimeout(()=>{n.inputState.composing<0&&Pl(n,!1)},50)};Ye.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ye.beforeinput=(n,e)=>{var t;let r;if(oe.chrome&&oe.android&&(r=Cl.find(i=>i.inputType==e.inputType))&&(n.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let i=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>i+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const Jo=["pre-wrap","normal","pre-line","break-spaces"];class Lu{constructor(){this.doc=Me.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength)),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Jo.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,r,i,s){let o=Jo.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=r,this.lineLength=i,a){this.heightSamples={};for(let l=0;l<s.length;l++){let h=s[l];h<0?l++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class ju{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Qt{constructor(e,t,r,i,s){this.from=e,this.length=t,this.top=r,this.height=i,this.type=s}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new Qt(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Ie=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(Ie||(Ie={}));const Lr=.001;class dt{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>Lr&&(e.heightChanged=!0),this.height=t)}replace(e,t,r){return dt.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,i){let s=this;for(let o=i.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:h,toB:c}=i[o],u=s.lineAt(a,Ie.ByPosNoHeight,t,0,0),f=u.to>=l?u:s.lineAt(l,Ie.ByPosNoHeight,t,0,0);for(c+=f.to-l,l=f.to;o>0&&u.from<=i[o-1].toA;)a=i[o-1].fromA,h=i[o-1].fromB,o--,a<u.from&&(u=s.lineAt(a,Ie.ByPosNoHeight,t,0,0));h+=u.from-a,a=u.from;let p=js.build(r,e,h,c);s=s.replace(a,l,p)}return s.updateHeight(r,0)}static empty(){return new mt(0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,i=0,s=0;for(;;)if(t==r)if(i>s*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),r+=1+a.break,i-=a.size}else if(s>i*2){let a=e[r];a.break?e.splice(r,1,a.left,null,a.right):e.splice(r,1,a.left,a.right),r+=2+a.break,s-=a.size}else break;else if(i<s){let a=e[t++];a&&(i+=a.size)}else{let a=e[--r];a&&(s+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,r++),new Bu(dt.of(e.slice(0,t)),o,dt.of(e.slice(r)))}}dt.prototype.size=1;class Ml extends dt{constructor(e,t,r){super(e,t),this.type=r}blockAt(e,t,r,i){return new Qt(i,this.length,r,this.height,this.type)}lineAt(e,t,r,i,s){return this.blockAt(0,r,i,s)}forEachLine(e,t,r,i,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,r,i,s))}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(e,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class mt extends Ml{constructor(e,t){super(e,t,De.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,r){let i=r[0];return r.length==1&&(i instanceof mt||i instanceof Xe&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Xe?i=new mt(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):dt.of(r)}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more?this.setHeight(e,i.heights[i.index++]):(r||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Xe extends dt{constructor(e){super(e,0)}lines(e,t){let r=e.lineAt(t).number,i=e.lineAt(t+this.length).number;return{firstLine:r,lastLine:i,lineHeight:this.height/(i-r+1)}}blockAt(e,t,r,i){let{firstLine:s,lastLine:o,lineHeight:a}=this.lines(t,i),l=Math.max(0,Math.min(o-s,Math.floor((e-r)/a))),{from:h,length:c}=t.line(s+l);return new Qt(h,c,r+a*l,a,De.Text)}lineAt(e,t,r,i,s){if(t==Ie.ByHeight)return this.blockAt(e,r,i,s);if(t==Ie.ByPosNoHeight){let{from:u,to:f}=r.lineAt(e);return new Qt(u,f-u,0,0,De.Text)}let{firstLine:o,lineHeight:a}=this.lines(r,s),{from:l,length:h,number:c}=r.lineAt(e);return new Qt(l,h,i+a*(c-o),a,De.Text)}forEachLine(e,t,r,i,s,o){let{firstLine:a,lineHeight:l}=this.lines(r,s);for(let h=Math.max(e,s),c=Math.min(s+this.length,t);h<=c;){let u=r.lineAt(h);h==e&&(i+=l*(u.number-a)),o(new Qt(u.from,u.length,i,l,De.Text)),i+=l,h=u.to+1}}replace(e,t,r){let i=this.length-t;if(i>0){let s=r[r.length-1];s instanceof Xe?r[r.length-1]=new Xe(s.length+i):r.push(null,new Xe(i-1))}if(e>0){let s=r[0];s instanceof Xe?r[0]=new Xe(e+s.length):r.unshift(new Xe(e-1),null)}return dt.of(r)}decomposeLeft(e,t){t.push(new Xe(e-1),null)}decomposeRight(e,t){t.push(null,new Xe(this.length-e-1))}updateHeight(e,t=0,r=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let o=[],a=Math.max(t,i.from),l=-1,h=e.heightChanged;for(i.from>t&&o.push(new Xe(i.from-t-1).updateHeight(e,t));a<=s&&i.more;){let u=e.doc.lineAt(a).length;o.length&&o.push(null);let f=i.heights[i.index++];l==-1?l=f:Math.abs(f-l)>=Lr&&(l=-2);let p=new mt(u,f);p.outdated=!1,o.push(p),a+=u+1}a<=s&&o.push(null,new Xe(s-a).updateHeight(e,a));let c=dt.of(o);return e.heightChanged=h||l<0||Math.abs(c.height-this.height)>=Lr||Math.abs(l-this.lines(e.doc,t).lineHeight)>=Lr,c}else(r||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Bu extends dt{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,r,i,s){let o=i+this.left.height,a=s+this.left.length+this.break,l=t==Ie.ByHeight?e<o:e<a,h=l?this.left.lineAt(e,t,r,i,s):this.right.lineAt(e,t,r,o,a);if(this.break||(l?h.to<a:h.from>a))return h;let c=t==Ie.ByPosNoHeight?Ie.ByPosNoHeight:Ie.ByPos;return l?h.join(this.right.lineAt(a,c,r,o,a)):this.left.lineAt(a,c,r,i,s).join(h)}forEachLine(e,t,r,i,s,o){let a=i+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,r,i,s,o),t>=l&&this.right.forEachLine(e,t,r,a,l,o);else{let h=this.lineAt(l,Ie.ByPos,r,i,s);e<h.from&&this.left.forEachLine(e,h.from-1,r,i,s,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,r,a,l,o)}}replace(e,t,r){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of r)s.push(a);if(e>0&&Yo(s,o-1),t<this.length){let a=s.length;this.decomposeRight(t,s),Yo(s,a)}return dt.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?dt.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,i){let{left:s,right:o}=this,a=t+s.length+this.break,l=null;return i&&i.from<=t+s.length&&i.more?l=s=s.updateHeight(e,t,r,i):s.updateHeight(e,t,r),i&&i.from<=a+o.length&&i.more?l=o=o.updateHeight(e,a,r,i):o.updateHeight(e,a,r),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Yo(n,e){let t,r;n[e]==null&&(t=n[e-1])instanceof Xe&&(r=n[e+1])instanceof Xe&&n.splice(e-1,3,new Xe(t.length+1+r.length))}const Vu=5;class js{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof mt?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new mt(r-this.pos,-1)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0;i<0&&(i=this.oracle.lineHeight);let s=t-e;r.block?this.addBlock(new Ml(s,i,r.type)):(s||i>=Vu)&&this.addLineDeco(i,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new mt(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let r=new Xe(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof mt)return e;let t=new mt(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==De.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=De.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let r=this.ensureLine();r.length+=t,r.collapsed+=t,r.widgetHeight=Math.max(r.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof mt)&&!this.isCovered?this.nodes.push(new mt(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let i of this.nodes)i instanceof mt&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,t,r,i){let s=new js(r,e);return Ne.spans(t,r,i,s,0),s.finish(r)}}function Fu(n,e,t){let r=new Hu;return Ne.compare(n,e,t,r,0),r.changes}class Hu{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,i){(e<t||r&&r.heightRelevant||i&&i.heightRelevant)&&cs(e,t,this.changes,5)}}function zu(n,e){let t=n.getBoundingClientRect(),r=Math.max(0,t.left),i=Math.min(innerWidth,t.right),s=Math.max(0,t.top),o=Math.min(innerHeight,t.bottom),a=n.ownerDocument.body;for(let l=n.parentNode;l&&l!=a;)if(l.nodeType==1){let h=l,c=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&c.overflow!="visible"){let u=h.getBoundingClientRect();r=Math.max(r,u.left),i=Math.min(i,u.right),s=Math.max(s,u.top),o=l==n.parentNode?u.bottom:Math.min(o,u.bottom)}l=c.position=="absolute"||c.position=="fixed"?h.offsetParent:h.parentNode}else if(l.nodeType==11)l=l.host;else break;return{left:r-t.left,right:Math.max(r,i)-t.left,top:s-(t.top+e),bottom:Math.max(s,o)-(t.top+e)}}function Wu(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class xn{constructor(e,t,r){this.from=e,this.to=t,this.size=r}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e){return Ee.replace({widget:new qu(this.size,e)}).range(this.from,this.to)}}class qu extends vi{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Xo{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new Lu,this.scaler=ea,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=We.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=e.facet(sr).filter(t=>typeof t!="function"),this.heightMap=dt.empty().applyChanges(this.stateDeco,Me.empty,this.heightOracle.setDoc(e.doc),[new Bt(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ee.set(this.lineGaps.map(t=>t.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let i=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new _r(s,o))}}this.viewports=e.sort((r,i)=>r.from-i.from),this.scaler=this.heightMap.height<=7e6?ea:new Gu(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Hi(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(sr).filter(h=>typeof h!="function");let i=e.changedRanges,s=Bt.extendWithRanges(i,Fu(r,this.stateDeco,e?e.changes:Je.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=!e.changes.empty||e.flags&2||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?We.RTL:We.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=o||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight;this.contentDOMHeight=t.clientHeight,this.mustMeasureContent=!1;let l=0,h=0,c=parseInt(r.paddingTop)||0,u=parseInt(r.paddingBottom)||0;(this.paddingTop!=c||this.paddingBottom!=u)&&(this.paddingTop=c,this.paddingBottom=u,l|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,l|=8);let f=(this.printing?Wu:zu)(t,this.paddingTop),p=f.top-this.pixelViewport.top,d=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(a=!0)),!this.inView)return 0;let S=t.clientWidth;if((this.contentDOMWidth!=S||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=S,this.editorHeight=e.scrollDOM.clientHeight,l|=8),a){let y=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(y)&&(o=!0),o||i.lineWrapping&&Math.abs(S-this.contentDOMWidth)>i.charWidth){let{lineHeight:w,charWidth:x}=e.docView.measureTextSize();o=i.refresh(s,w,x,S/x,y),o&&(e.docView.minWidth=0,l|=8)}p>0&&d>0?h=Math.max(p,d):p<0&&d<0&&(h=Math.min(p,d)),i.heightChanged=!1;for(let w of this.viewports){let x=w.from==this.viewport.from?y:e.docView.measureVisibleLineHeights(w);this.heightMap=this.heightMap.updateHeight(i,0,o,new ju(w.from,x))}i.heightChanged&&(l|=2)}let m=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return m&&(this.viewport=this.getViewport(h,this.scrollTarget)),this.updateForViewport(),(l&2||m)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.state.doc,{visibleTop:o,visibleBottom:a}=this,l=new _r(i.lineAt(o-r*1e3,Ie.ByHeight,s,0,0).from,i.lineAt(a+(1-r)*1e3,Ie.ByHeight,s,0,0).to);if(t){let{head:h}=t.range;if(h<l.from||h>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=i.lineAt(h,Ie.ByPos,s,0,0),f;t.y=="center"?f=(u.top+u.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&h<l.from?f=u.top:f=u.bottom-c,l=new _r(i.lineAt(f-1e3/2,Ie.ByHeight,s,0,0).from,i.lineAt(f+c+1e3/2,Ie.ByHeight,s,0,0).to)}}return l}mapViewport(e,t){let r=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new _r(this.heightMap.lineAt(r,Ie.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(i,Ie.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,Ie.ByPos,this.state.doc,0,0),{bottom:s}=this.heightMap.lineAt(t,Ie.ByPos,this.state.doc,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||i<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=a+Math.max(10,Math.min(r,250)))&&i>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let i of e)t.touchesRange(i.from,i.to)||r.push(new xn(t.mapPos(i.from),t.mapPos(i.to),i.size));return r}ensureLineGaps(e){let t=[];if(this.defaultTextDirection!=We.LTR)return t;for(let r of this.viewportLines){if(r.length<4e3)continue;let i=Uu(r.from,r.to,this.stateDeco);if(i.total<4e3)continue;let s,o;if(this.heightOracle.lineWrapping){let h=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;s=kr(i,(this.visibleTop-r.top-h)/r.height),o=kr(i,(this.visibleBottom-r.top+h)/r.height)}else{let h=i.total*this.heightOracle.charWidth,c=2e3*this.heightOracle.charWidth;s=kr(i,(this.pixelViewport.left-c)/h),o=kr(i,(this.pixelViewport.right+c)/h)}let a=[];s>r.from&&a.push({from:r.from,to:s}),o<r.to&&a.push({from:o,to:r.to});let l=this.state.selection.main;l.from>=r.from&&l.from<=r.to&&Zo(a,l.from-10,l.from+10),!l.empty&&l.to>=r.from&&l.to<=r.to&&Zo(a,l.to-10,l.to+10);for(let{from:h,to:c}of a)c-h>1e3&&t.push(Ku(e,u=>u.from>=r.from&&u.to<=r.to&&Math.abs(u.from-h)<1e3&&Math.abs(u.to-c)<1e3)||new xn(h,c,this.gapSize(r,h,c,i)))}return t}gapSize(e,t,r,i){let s=Qo(i,r)-Qo(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){xn.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ee.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];Ne.spans(e,this.viewport.from,this.viewport.to,{span(i,s){t.push({from:i,to:s})},point(){}},20);let r=t.length!=this.visibleRanges.length||this.visibleRanges.some((i,s)=>i.from!=t[s].from||i.to!=t[s].to);return this.visibleRanges=t,r?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Hi(this.heightMap.lineAt(e,Ie.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return Hi(this.heightMap.lineAt(this.scaler.fromDOM(e),Ie.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return Hi(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class _r{constructor(e,t){this.from=e,this.to=t}}function Uu(n,e,t){let r=[],i=n,s=0;return Ne.spans(t,n,e,{span(){},point(o,a){o>i&&(r.push({from:i,to:o}),s+=o-i),i=a}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function kr({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let i=0;;i++){let{from:s,to:o}=e[i],a=o-s;if(r<=a)return s+r;r-=a}}function Qo(n,e){let t=0;for(let{from:r,to:i}of n.ranges){if(e<=i){t+=e-r;break}t+=i-r}return t/n.total}function Zo(n,e,t){for(let r=0;r<n.length;r++){let i=n[r];if(i.from<t&&i.to>e){let s=[];i.from<e&&s.push({from:i.from,to:e}),i.to>t&&s.push({from:t,to:i.to}),n.splice(r,1,...s),r+=s.length-1}}}function Ku(n,e){for(let t of n)if(e(t))return t}const ea={toDOM(n){return n},fromDOM(n){return n},scale:1};class Gu{constructor(e,t,r){let i=0,s=0,o=0;this.viewports=r.map(({from:a,to:l})=>{let h=t.lineAt(a,Ie.ByPos,e,0,0).top,c=t.lineAt(l,Ie.ByPos,e,0,0).bottom;return i+=c-h,{from:a,to:l,top:h,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}}function Hi(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new Qt(n.from,n.length,t,r-t,Array.isArray(n.type)?n.type.map(i=>Hi(i,e)):n.type)}const xr=he.define({combine:n=>n.join(" ")}),ys=he.define({combine:n=>n.indexOf(!0)>-1}),vs=ei.newName(),Nl=ei.newName(),Dl=ei.newName(),Rl={"&light":"."+Nl,"&dark":"."+Dl};function ws(n,e,t){return new ei(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,i=>{if(i=="&")return n;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):n+" "+r}})}const Ju=ws("."+vs,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Rl),Yu={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Cn=oe.ie&&oe.ie_version<=11;class Xu{constructor(e,t,r){this.view=e,this.onChange=t,this.onScrollChanged=r,this.active=!1,this.selectionRange=new Jc,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(i=>{for(let s of i)this.queue.push(s);(oe.ie&&oe.ie_version<=11||oe.ios&&e.composing)&&i.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),Cn&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resize=new ResizeObserver(()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()}),this.resize.observe(e.scrollDOM)),this.win=e.dom.ownerDocument.defaultView,this.addWindowListeners(this.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(pn)?r.root.activeElement!=this.dom:!Ir(r.dom,i))return;let s=i.anchorNode&&r.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(oe.ie&&oe.ie_version<=11||oe.android&&oe.chrome)&&!r.state.selection.main.empty&&i.focusNode&&Gr(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=oe.safari&&e.root.nodeType==11&&Uc(this.dom.ownerDocument)==this.dom&&Qu(this.view)||Kr(e.root);if(!t||this.selectionRange.eq(t))return!1;let r=Ir(this.dom,t);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Xc(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Yu),Cn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),Cn&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||requestAnimationFrame(()=>{let r=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||Yi(this.dom,r.key,r.keyCode)}),(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1,this.flush()},20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1),this.flush()}processRecords(){let e=this.queue;for(let s of this.observer.takeRecords())e.push(s);e.length&&(this.queue=[]);let t=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);!o||(o.typeOver&&(i=!0),t==-1?{from:t,to:r}=o:(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:i}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;e&&this.readSelectionRange();let{from:t,to:r,typeOver:i}=this.processRecords(),s=this.selectionChanged&&Ir(this.dom,this.selectionRange);if(t<0&&!s)return;this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=this.view.state,a=this.onChange(t,r,i);return this.view.state==o&&this.view.update([]),a}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let r=ta(t,e.previousSibling||e.target.previousSibling,-1),i=ta(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resize)===null||r===void 0||r.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function ta(n,e,t){for(;e;){let r=je.get(e);if(r&&r.parent==n)return r;let i=e.parentNode;e=i!=n.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function Qu(n){let e=null;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",t,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=n.docView.domAtPos(n.state.selection.main.anchor);return Gr(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function Zu(n,e,t,r){let i,s,o=n.state.selection.main;if(e>-1){let a=n.docView.domBoundsAround(e,t,0);if(!a||n.state.readOnly)return!1;let{from:l,to:h}=a,c=n.docView.impreciseHead||n.docView.impreciseAnchor?[]:tf(n),u=new Sl(c,n.state);u.readRange(a.startDOM,a.endDOM);let f=o.from,p=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||oe.android&&u.text.length<h-l)&&(f=o.to,p="end");let d=ef(n.state.doc.sliceString(l,h,Xt),u.text,f-l,p);d&&(oe.chrome&&n.inputState.lastKeyCode==13&&d.toB==d.from+2&&u.text.slice(d.from,d.toB)==Xt+Xt&&d.toB--,i={from:l+d.from,to:l+d.toA,insert:Me.of(u.text.slice(d.from,d.toB).split(Xt))}),s=rf(c,l)}else if(n.hasFocus||!n.state.facet(pn)){let a=n.observer.selectionRange,{impreciseHead:l,impreciseAnchor:h}=n.docView,c=l&&l.node==a.focusNode&&l.offset==a.focusOffset||!Ai(n.contentDOM,a.focusNode)?n.state.selection.main.head:n.docView.posFromDOM(a.focusNode,a.focusOffset),u=h&&h.node==a.anchorNode&&h.offset==a.anchorOffset||!Ai(n.contentDOM,a.anchorNode)?n.state.selection.main.anchor:n.docView.posFromDOM(a.anchorNode,a.anchorOffset);(c!=o.head||u!=o.anchor)&&(s=ae.single(u,c))}if(!i&&!s)return!1;if(!i&&r&&!o.empty&&s&&s.main.empty?i={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,o.to)}:i&&i.from>=o.from&&i.to<=o.to&&(i.from!=o.from||i.to!=o.to)&&o.to-o.from-(i.to-i.from)<=4?i={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,i.from).append(i.insert).append(n.state.doc.slice(i.to,o.to))}:(oe.mac||oe.android)&&i&&i.from==i.to&&i.from==o.head-1&&i.insert.toString()=="."&&(i={from:o.from,to:o.to,insert:Me.of([" "])}),i){let a=n.state;if(oe.ios&&n.inputState.flushIOSKey(n)||oe.android&&(i.from==o.from&&i.to==o.to&&i.insert.length==1&&i.insert.lines==2&&Yi(n.contentDOM,"Enter",13)||i.from==o.from-1&&i.to==o.to&&i.insert.length==0&&Yi(n.contentDOM,"Backspace",8)||i.from==o.from&&i.to==o.to+1&&i.insert.length==0&&Yi(n.contentDOM,"Delete",46)))return!0;let l=i.insert.toString();if(n.state.facet(fl).some(u=>u(n,i.from,i.to,l)))return!0;n.inputState.composing>=0&&n.inputState.composing++;let h;if(i.from>=o.from&&i.to<=o.to&&i.to-i.from>=(o.to-o.from)/3&&(!s||s.main.empty&&s.main.from==i.from+i.insert.length)&&n.inputState.composing<0){let u=o.from<i.from?a.sliceDoc(o.from,i.from):"",f=o.to>i.to?a.sliceDoc(i.to,o.to):"";h=a.replaceSelection(n.state.toText(u+i.insert.sliceString(0,void 0,n.state.lineBreak)+f))}else{let u=a.changes(i),f=s&&!a.selection.main.eq(s.main)&&s.main.to<=u.newLength?s.main:void 0;if(a.selection.ranges.length>1&&n.inputState.composing>=0&&i.to<=o.to&&i.to>=o.to-10){let p=n.state.sliceDoc(i.from,i.to),d=_l(n)||n.state.doc.lineAt(o.head),g=o.to-i.to,S=o.to-o.from;h=a.changeByRange(m=>{if(m.from==o.from&&m.to==o.to)return{changes:u,range:f||m.map(u)};let y=m.to-g,w=y-p.length;if(m.to-m.from!=S||n.state.sliceDoc(w,y)!=p||d&&m.to>=d.from&&m.from<=d.to)return{range:m};let x=a.changes({from:w,to:y,insert:i.insert}),C=m.to-o.to;return{changes:x,range:f?ae.range(Math.max(0,f.anchor+C),Math.max(0,f.head+C)):m.map(x)}})}else h={changes:u,selection:f&&a.selection.replaceRange(f)}}let c="input.type";return n.composing&&(c+=".compose",n.inputState.compositionFirstChange&&(c+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(h,{scrollIntoView:!0,userEvent:c}),!0}else if(s&&!s.main.eq(o)){let a=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(a=!0),l=n.inputState.lastSelectionOrigin),n.dispatch({selection:s,scrollIntoView:a,userEvent:l}),!0}else return!1}function ef(n,e,t,r){let i=Math.min(n.length,e.length),s=0;for(;s<i&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&n.length==e.length)return null;let o=n.length,a=e.length;for(;o>0&&a>0&&n.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(r=="end"){let l=Math.max(0,s-Math.min(o,a));t-=o+l-s}return o<s&&n.length<e.length?(s-=t<=s&&t>=o?s-t:0,a=s+(a-o),o=s):a<s&&(s-=t<=s&&t>=a?s-t:0,o=s+(o-a),a=s),{from:s,toA:o,toB:a}}function tf(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new No(t,r)),(i!=t||s!=r)&&e.push(new No(i,s))),e}function rf(n,e){if(n.length==0)return null;let t=n[0].pos,r=n.length==2?n[1].pos:t;return t>-1&&r>-1?ae.single(t+e,r+e):null}class xe{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=e.root||Yc(e.parent)||document,this.viewState=new Xo(e.state||Te.create(e)),this.plugins=this.state.facet(Vi).map(t=>new Sn(t));for(let t of this.plugins)t.update(this);this.observer=new Xu(this,(t,r,i)=>Zu(this,t,r,i),t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()}),this.inputState=new xu(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Do(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof rt?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,i,s=this.state;for(let a of e){if(a.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=a.state}if(this.destroyed){this.viewState.state=s;return}if(this.observer.clear(),s.facet(Te.phrases)!=this.state.facet(Te.phrases))return this.setState(s);i=Xr.create(this,s,e);let o=this.viewState.scrollTarget;try{this.updateState=2;for(let a of e){if(o&&(o=o.map(a.changes)),a.scrollIntoView){let{main:l}=a.state.selection;o=new Yr(l.empty?l:ae.cursor(l.head,l.head>l.anchor?-1:1))}for(let l of a.effects)l.is(Po)&&(o=l.value)}this.viewState.update(i,o),this.bidiCache=Qr.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(Fi)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(a=>a.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(xr)!=i.state.facet(xr)&&(this.viewState.mustMeasureContent=!0),(t||r||o||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!i.empty)for(let a of this.state.facet(us))a(i)}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Xo(e),this.plugins=e.facet(Vi).map(r=>new Sn(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView=new Do(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Vi),r=e.state.facet(Vi);if(t!=r){let i=[];for(let s of r){let o=t.indexOf(s);if(o<0)i.push(new Sn(s));else{let a=this.plugins[o];a.mustUpdate=e,i.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,{scrollHeight:r,scrollTop:i,clientHeight:s}=this.scrollDOM,o=i>r-s-4?r:i;try{for(let a=0;;a++){this.updateState=1;let l=this.viewport,h=this.viewState.lineBlockAtHeight(o),c=this.viewState.measure(this);if(!c&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];c&4||([this.measureRequests,u]=[u,this.measureRequests]);let f=u.map(S=>{try{return S.read(this)}catch(m){return jt(this.state,m),ia}}),p=Xr.create(this,this.state,[]),d=!1,g=!1;p.flags|=c,t?t.flags|=c:t=p,this.updateState=2,p.empty||(this.updatePlugins(p),this.inputState.update(p),this.updateAttrs(),d=this.docView.update(p));for(let S=0;S<u.length;S++)if(f[S]!=ia)try{let m=u[S];m.write&&m.write(f[S],this)}catch(m){jt(this.state,m)}if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,g=!0;else{let S=this.viewState.lineBlockAt(h.from).top-h.top;(S>1||S<-1)&&(this.scrollDOM.scrollTop+=S,g=!0)}if(d&&this.docView.updateSelection(!0),this.viewport.from==l.from&&this.viewport.to==l.to&&!g&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let a of this.state.facet(us))a(t)}get themeClasses(){return vs+" "+(this.state.facet(ys)?Dl:Nl)+" "+this.state.facet(xr)}updateAttrs(){let e=ra(this,pl,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(pn)?"true":"false",class:"cm-content",style:`${oe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),ra(this,ml,t);let r=this.observer.ignore(()=>{let i=hs(this.contentDOM,this.contentAttrs,t),s=hs(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let i of r.effects)if(i.is(xe.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(Fi),ei.mount(this.root,this.styleModules.concat(Ju).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame(()=>this.measure())),e){if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return kn(this,e,Vo(this,e,t,r))}moveByGroup(e,t){return kn(this,e,Vo(this,e,t,r=>_u(this,e.head,r)))}moveToLineBoundary(e,t,r=!0){return Su(this,e,t,r)}moveVertically(e,t,r){return kn(this,e,ku(this,e,t,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),xl(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[Ci.find(s,e-i.from,-1,t)];return un(r,o.dir==We.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(dl)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>nf)return wl(e.length);let t=this.textDirectionAt(e.from);for(let i of this.bidiCache)if(i.from==e.from&&i.dir==t)return i.order;let r=au(e.text,t);return this.bidiCache.push(new Qr(e.from,e.to,t,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||oe.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Ja(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Po.of(new Yr(typeof e=="number"?ae.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return ot.define(()=>({}),{eventHandlers:e})}static theme(e,t){let r=ei.newName(),i=[xr.of(r),Fi.of(ws(`.${r}`,e))];return t&&t.dark&&i.push(ys.of(!0)),i}static baseTheme(e){return hn.lowest(Fi.of(ws("."+vs,e,Rl)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),i=r&&je.get(r)||je.get(e);return((t=i==null?void 0:i.rootView)===null||t===void 0?void 0:t.view)||null}}xe.styleModule=Fi;xe.inputHandler=fl;xe.perLineTextDirection=dl;xe.exceptionSink=ul;xe.updateListener=us;xe.editable=pn;xe.mouseSelectionStyle=cl;xe.dragMovesSelection=hl;xe.clickAddsSelectionRange=ll;xe.decorations=sr;xe.atomicRanges=gl;xe.scrollMargins=yl;xe.darkTheme=ys;xe.contentAttributes=ml;xe.editorAttributes=pl;xe.lineWrapping=xe.contentAttributes.of({class:"cm-lineWrapping"});xe.announce=Ve.define();const nf=4096,ia={};class Qr{constructor(e,t,r,i){this.from=e,this.to=t,this.dir=r,this.order=i}static update(e,t){if(t.empty)return e;let r=[],i=e.length?e[e.length-1].dir:We.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!t.touchesRange(o.from,o.to)&&r.push(new Qr(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.order))}return r}}function ra(n,e,t){for(let r=n.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o=typeof s=="function"?s(n):s;o&&ls(o,t)}return t}const sf=oe.mac?"mac":oe.windows?"win":oe.linux?"linux":"key";function of(n,e){const t=n.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let i,s,o,a;for(let l=0;l<t.length-1;++l){const h=t[l];if(/^(cmd|meta|m)$/i.test(h))a=!0;else if(/^a(lt)?$/i.test(h))i=!0;else if(/^(c|ctrl|control)$/i.test(h))s=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+h)}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),a&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Cr(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const af=hn.default(xe.domEventHandlers({keydown(n,e){return Ll(Il(e.state),n,e,"editor")}})),lf=he.define({enables:af}),na=new WeakMap;function Il(n){let e=n.facet(lf),t=na.get(e);return t||na.set(e,t=cf(e.reduce((r,i)=>r.concat(i),[]))),t}function Gp(n,e,t){return Ll(Il(n.state),e,n,t)}let Ut=null;const hf=4e3;function cf(n,e=sf){let t=Object.create(null),r=Object.create(null),i=(o,a)=>{let l=r[o];if(l==null)r[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,h)=>{let c=t[o]||(t[o]=Object.create(null)),u=a.split(/ (?!$)/).map(d=>of(d,e));for(let d=1;d<u.length;d++){let g=u.slice(0,d).join(" ");i(g,!0),c[g]||(c[g]={preventDefault:!0,commands:[S=>{let m=Ut={view:S,prefix:g,scope:o};return setTimeout(()=>{Ut==m&&(Ut=null)},hf),!0}]})}let f=u.join(" ");i(f,!1);let p=c[f]||(c[f]={preventDefault:!1,commands:[]});p.commands.push(l),h&&(p.preventDefault=!0)};for(let o of n){let a=o[e]||o.key;if(!!a)for(let l of o.scope?o.scope.split(" "):["editor"])s(l,a,o.run,o.preventDefault),o.shift&&s(l,"Shift-"+a,o.shift,o.preventDefault)}return t}function Ll(n,e,t,r){let i=qc(e),s=Gi(i,0),o=Wn(s)==i.length&&i!=" ",a="",l=!1;Ut&&Ut.view==t&&Ut.scope==r&&(a=Ut.prefix+" ",(l=El.indexOf(e.keyCode)<0)&&(Ut=null));let h=p=>{if(p){for(let d of p.commands)if(d(t))return!0;p.preventDefault&&(l=!0)}return!1},c=n[r],u,f;if(c){if(h(c[a+Cr(i,e,!o)]))return!0;if(o&&(e.shiftKey||e.altKey||e.metaKey||s>127)&&(u=ti[e.keyCode])&&u!=i){if(h(c[a+Cr(u,e,!0)]))return!0;if(e.shiftKey&&(f=ir[e.keyCode])!=i&&f!=u&&h(c[a+Cr(f,e,!1)]))return!0}else if(o&&e.shiftKey&&h(c[a+Cr(i,e,!0)]))return!0}return l}const jl=!oe.ios,zi=he.define({combine(n){return lr(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function Jp(n={}){return[zi.of(n),uf,ff]}class Bl{constructor(e,t,r,i,s){this.left=e,this.top=t,this.width=r,this.height=i,this.className=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const uf=ot.fromClass(class{constructor(n){this.view=n,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=n.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=n.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),n.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(zi).cursorBlinkRate+"ms"}update(n){let e=n.startState.facet(zi)!=n.state.facet(zi);(e||n.selectionSet||n.geometryChanged||n.viewportChanged)&&this.view.requestMeasure(this.measureReq),n.transactions.some(t=>t.scrollIntoView)&&(this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),e&&this.setBlinkRate()}readPos(){let{state:n}=this.view,e=n.facet(zi),t=n.selection.ranges.map(i=>i.empty?[]:df(this.view,i)).reduce((i,s)=>i.concat(s)),r=[];for(let i of n.selection.ranges){let s=i==n.selection.main;if(i.empty?!s||jl:e.drawRangeCursor){let o=pf(this.view,i,s);o&&r.push(o)}}return{rangePieces:t,cursors:r}}drawSel({rangePieces:n,cursors:e}){if(n.length!=this.rangePieces.length||n.some((t,r)=>!t.eq(this.rangePieces[r]))){this.selectionLayer.textContent="";for(let t of n)this.selectionLayer.appendChild(t.draw());this.rangePieces=n}if(e.length!=this.cursors.length||e.some((t,r)=>!t.eq(this.cursors[r]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const r of e)this.cursorLayer.appendChild(r.draw())}else e.forEach((r,i)=>r.adjust(t[i]));this.cursors=e}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),Vl={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};jl&&(Vl[".cm-line"].caretColor="transparent !important");const ff=hn.highest(xe.theme(Vl));function Fl(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==We.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function sa(n,e,t){let r=ae.cursor(e);return{from:Math.max(t.from,n.moveToLineBoundary(r,!1,!0).from),to:Math.min(t.to,n.moveToLineBoundary(r,!0,!0).from),type:De.Text}}function oa(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let r of t.type)if(r.to>e||r.to==e&&(r.to==t.to||r.type==De.Text))return r}return t}function df(n,e){if(e.to<=n.viewport.from||e.from>=n.viewport.to)return[];let t=Math.max(e.from,n.viewport.from),r=Math.min(e.to,n.viewport.to),i=n.textDirection==We.LTR,s=n.contentDOM,o=s.getBoundingClientRect(),a=Fl(n),l=window.getComputedStyle(s.firstChild),h=o.left+parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)),c=o.right-parseInt(l.paddingRight),u=oa(n,t),f=oa(n,r),p=u.type==De.Text?u:null,d=f.type==De.Text?f:null;if(n.lineWrapping&&(p&&(p=sa(n,t,p)),d&&(d=sa(n,r,d))),p&&d&&p.from==d.from)return S(m(e.from,e.to,p));{let w=p?m(e.from,null,p):y(u,!1),x=d?m(null,e.to,d):y(f,!0),C=[];return(p||u).to<(d||f).from-1?C.push(g(h,w.bottom,c,x.top)):w.bottom<x.top&&n.elementAtHeight((w.bottom+x.top)/2).type==De.Text&&(w.bottom=x.top=(w.bottom+x.top)/2),S(w).concat(C).concat(S(x))}function g(w,x,C,T){return new Bl(w-a.left,x-a.top-.01,C-w,T-x+.01,"cm-selectionBackground")}function S({top:w,bottom:x,horizontal:C}){let T=[];for(let N=0;N<C.length;N+=2)T.push(g(C[N],w,C[N+1],x));return T}function m(w,x,C){let T=1e9,N=-1e9,z=[];function D(B,F,se,Y,ie){let le=n.coordsAtPos(B,B==C.to?-2:2),fe=n.coordsAtPos(se,se==C.from?2:-2);T=Math.min(le.top,fe.top,T),N=Math.max(le.bottom,fe.bottom,N),ie==We.LTR?z.push(i&&F?h:le.left,i&&Y?c:fe.right):z.push(!i&&Y?h:fe.left,!i&&F?c:le.right)}let R=w!=null?w:C.from,W=x!=null?x:C.to;for(let B of n.visibleRanges)if(B.to>R&&B.from<W)for(let F=Math.max(B.from,R),se=Math.min(B.to,W);;){let Y=n.state.doc.lineAt(F);for(let ie of n.bidiSpans(Y)){let le=ie.from+Y.from,fe=ie.to+Y.from;if(le>=se)break;fe>F&&D(Math.max(le,F),w==null&&le<=R,Math.min(fe,se),x==null&&fe>=W,ie.dir)}if(F=Y.to+1,F>=se)break}return z.length==0&&D(R,w==null,W,x==null,n.textDirection),{top:T,bottom:N,horizontal:z}}function y(w,x){let C=o.top+(x?w.top:w.bottom);return{top:C,bottom:C,horizontal:[]}}}function pf(n,e,t){let r=n.coordsAtPos(e.head,e.assoc||1);if(!r)return null;let i=Fl(n);return new Bl(r.left-i.left,r.top-i.top,-1,r.bottom-r.top,t?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const Hl=Ve.define({map(n,e){return n==null?null:e.mapPos(n)}}),Wi=kt.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,r)=>r.is(Hl)?r.value:t,n)}}),mf=ot.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Wi);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Wi)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(Wi),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Wi)!=n&&this.view.dispatch({effects:Hl.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Yp(){return[Wi,mf]}function aa(n,e,t,r,i){e.lastIndex=0;for(let s=n.iterRange(t,r),o=t,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)i(o+a.index,a)}function gf(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let r=[];for(let{from:i,to:s}of t)i=Math.max(n.state.doc.lineAt(i).from,i-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}class yf{constructor(e){const{regexp:t,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(a,l,h,c)=>i(c,h,h+a[0].length,a,l);else if(r){let a=typeof r=="function"?r:()=>r;this.addMatch=(l,h,c,u)=>u(c,c+l[0].length,a(l,h,c))}else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new mi,r=t.add.bind(t);for(let{from:i,to:s}of gf(e,this.maxLength))aa(e.state.doc,this.regexp,i,s,(o,a)=>this.addMatch(a,e,o,r));return t.finish()}updateDeco(e,t){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(r=Math.min(a,r),i=Math.max(l,i))}),e.viewportChanged||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),r,i):t}updateRange(e,t,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),a=Math.min(s.to,i);if(a>o){let l=e.state.doc.lineAt(o),h=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),u=Math.min(s.to,h.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<h.to;a++)if(this.boundary.test(h.text[a-h.from])){u=a;break}}let f=[],p,d=(g,S,m)=>f.push(m.range(g,S));if(l==h)for(this.regexp.lastIndex=c-l.from;(p=this.regexp.exec(l.text))&&p.index<u-l.from;)this.addMatch(p,e,p.index+l.from,d);else aa(e.state.doc,this.regexp,c,u,(g,S)=>this.addMatch(S,e,g,d));t=t.update({filterFrom:c,filterTo:u,filter:(g,S)=>g<c||S>u,add:f})}}return t}}const bs=/x/.unicode!=null?"gu":"g",vf=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,bs),wf={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let En=null;function bf(){var n;if(En==null&&typeof document<"u"&&document.body){let e=document.body.style;En=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return En||!1}const jr=he.define({combine(n){let e=lr(n,{render:null,specialChars:vf,addSpecialChars:null});return(e.replaceTabs=!bf())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,bs)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,bs)),e}});function Xp(n={}){return[jr.of(n),Sf()]}let la=null;function Sf(){return la||(la=ot.fromClass(class{constructor(n){this.view=n,this.decorations=Ee.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(jr)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new yf({regexp:n.specialChars,decoration:(e,t,r)=>{let{doc:i}=t.state,s=Gi(e[0],0);if(s==9){let o=i.lineAt(r),a=t.state.tabSize,l=Ns(o.text,a,r-o.from);return Ee.replace({widget:new Cf((a-l%a)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=Ee.replace({widget:new xf(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(jr);n.startState.facet(jr)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const _f="\u2022";function kf(n){return n>=32?_f:n==10?"\u2424":String.fromCharCode(9216+n)}class xf extends vi{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=kf(this.code),r=e.state.phrase("Control character")+" "+(wf[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,t);if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Cf extends vi{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Qp(){return Of}const Ef=Ee.line({class:"cm-activeLine"}),Of=ot.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let r of n.state.selection.ranges){if(!r.empty)return Ee.none;let i=n.lineBlockAt(r.head);i.from>e&&(t.push(Ef.range(i.from)),e=i.from)}return Ee.set(t)}},{decorations:n=>n.decorations}),Ss=2e3;function Tf(n,e,t){let r=Math.min(e.line,t.line),i=Math.max(e.line,t.line),s=[];if(e.off>Ss||t.off>Ss||e.col<0||t.col<0){let o=Math.min(e.off,t.off),a=Math.max(e.off,t.off);for(let l=r;l<=i;l++){let h=n.doc.line(l);h.length<=a&&s.push(ae.range(h.from+o,h.to+a))}}else{let o=Math.min(e.col,t.col),a=Math.max(e.col,t.col);for(let l=r;l<=i;l++){let h=n.doc.line(l),c=es(h.text,o,n.tabSize,!0);if(c>-1){let u=es(h.text,a,n.tabSize);s.push(ae.range(h.from+c,h.from+u))}}}return s}function Af(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function ha(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),r=n.state.doc.lineAt(t),i=t-r.from,s=i>Ss?-1:i==r.length?Af(n,e.clientX):Ns(r.text,n.state.tabSize,t-r.from);return{line:r.number,col:s,off:i}}function $f(n,e){let t=ha(n,e),r=n.state.selection;return t?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(t.line).from),o=i.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},r=r.map(i.changes)}},get(i,s,o){let a=ha(n,i);if(!a)return r;let l=Tf(n.state,t,a);return l.length?o?ae.create(l.concat(r.ranges)):ae.create(l):r}}:null}function Zp(n){let e=(n==null?void 0:n.eventFilter)||(t=>t.altKey&&t.button==0);return xe.mouseSelectionStyle.of((t,r)=>e(r)?$f(t,r):null)}const Pf={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},Mf={style:"cursor: crosshair"};function em(n={}){let[e,t]=Pf[n.key||"Alt"],r=ot.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventHandlers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)}}});return[r,xe.contentAttributes.of(i=>{var s;return!((s=i.plugin(r))===null||s===void 0)&&s.isDown?Mf:null})]}const On="-10000px";class zl{constructor(e,t,r){this.facet=t,this.createTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(i=>i),this.tooltipViews=this.tooltips.map(r)}update(e){let t=e.state.facet(this.facet),r=t.filter(s=>s);if(t===this.input){for(let s of this.tooltipViews)s.update&&s.update(e);return!1}let i=[];for(let s=0;s<r.length;s++){let o=r[s],a=-1;if(!!o){for(let l=0;l<this.tooltips.length;l++){let h=this.tooltips[l];h&&h.create==o.create&&(a=l)}if(a<0)i[s]=this.createTooltipView(o);else{let l=i[s]=this.tooltipViews[a];l.update&&l.update(e)}}}for(let s of this.tooltipViews)i.indexOf(s)<0&&s.dom.remove();return this.input=t,this.tooltips=r,this.tooltipViews=i,!0}}function Nf(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const Tn=he.define({combine:n=>{var e,t,r;return{position:oe.ios?"absolute":((e=n.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((r=n.find(i=>i.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||Nf}}}),Wl=ot.fromClass(class{constructor(n){var e;this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let t=n.state.facet(Tn);this.position=t.position,this.parent=t.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new zl(n,ql,r=>this.createTooltip(r)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),(e=n.dom.ownerDocument.defaultView)===null||e===void 0||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let t=e||n.geometryChanged,r=n.state.facet(Tn);if(r.position!=this.position){this.position=r.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=On,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;(n=this.view.dom.ownerDocument.defaultView)===null||n===void 0||n.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,t)=>{let r=this.manager.tooltipViews[t];return r.getCoords?r.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(Tn).tooltipSpace(this.view)}}writeMeasure(n){let{editor:e,space:t}=n,r=[];for(let i=0;i<this.manager.tooltips.length;i++){let s=this.manager.tooltips[i],o=this.manager.tooltipViews[i],{dom:a}=o,l=n.pos[i],h=n.size[i];if(!l||l.bottom<=Math.max(e.top,t.top)||l.top>=Math.min(e.bottom,t.bottom)||l.right<Math.max(e.left,t.left)-.1||l.left>Math.min(e.right,t.right)+.1){a.style.top=On;continue}let c=s.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,u=c?7:0,f=h.right-h.left,p=h.bottom-h.top,d=o.offset||Rf,g=this.view.textDirection==We.LTR,S=h.width>t.right-t.left?g?t.left:t.right-h.width:g?Math.min(l.left-(c?14:0)+d.x,t.right-f):Math.max(t.left,l.left-f+(c?14:0)-d.x),m=!!s.above;!s.strictSide&&(m?l.top-(h.bottom-h.top)-d.y<t.top:l.bottom+(h.bottom-h.top)+d.y>t.bottom)&&m==t.bottom-l.bottom>l.top-t.top&&(m=!m);let y=m?l.top-p-u-d.y:l.bottom+u+d.y,w=S+f;if(o.overlap!==!0)for(let x of r)x.left<w&&x.right>S&&x.top<y+p&&x.bottom>y&&(y=m?x.top-p-2-u:x.bottom+u+2);this.position=="absolute"?(a.style.top=y-n.parent.top+"px",a.style.left=S-n.parent.left+"px"):(a.style.top=y+"px",a.style.left=S+"px"),c&&(c.style.left=`${l.left+(g?d.x:-d.x)-(S+14-7)}px`),o.overlap!==!0&&r.push({left:S,top:y,right:w,bottom:y+p}),a.classList.toggle("cm-tooltip-above",m),a.classList.toggle("cm-tooltip-below",!m),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=On}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),Df=xe.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Rf={x:0,y:0},ql=he.define({enables:[Wl,Df]}),Zr=he.define();class Bs{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new zl(e,Zr,t=>this.createHostedView(t))}static create(e){return new Bs(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}}const If=ql.compute([Zr],n=>{let e=n.facet(Zr).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:Bs.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Lf{constructor(e,t,r,i,s){this.view=e,this.source=t,this.field=r,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let r=this.view.coordsAtPos(t);if(r==null||e.y<r.top||e.y>r.bottom||e.x<r.left-this.view.defaultCharacterWidth||e.x>r.right+this.view.defaultCharacterWidth)return;let i=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(a=>a.from<=t&&a.to>=t),s=i&&i.dir==We.RTL?-1:1,o=this.source(this.view,t,e.x<r.left?-s:s);if(o!=null&&o.then){let a=this.pending={pos:t};o.then(l=>{this.pending==a&&(this.pending=null,l&&this.view.dispatch({effects:this.setHover.of(l)}))},l=>jt(this.view.state,l,"hover tooltip"))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let r=this.active;if(r&&!jf(this.lastMove.target)||this.pending){let{pos:i}=r||this.pending,s=(t=r==null?void 0:r.end)!==null&&t!==void 0?t:i;(i==s?this.view.posAtCoords(this.lastMove)!=i:!Bf(this.view,i,s,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function jf(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function Bf(n,e,t,r,i,s){let o=document.createRange(),a=n.domAtPos(e),l=n.domAtPos(t);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let h=o.getClientRects();o.detach();for(let c=0;c<h.length;c++){let u=h[c];if(Math.max(u.top-i,i-u.bottom,u.left-r,r-u.right)<=s)return!0}return!1}function tm(n,e={}){let t=Ve.define(),r=kt.define({create(){return null},update(i,s){if(i&&(e.hideOnChange&&(s.docChanged||s.selection)||e.hideOn&&e.hideOn(s,i)))return null;if(i&&s.docChanged){let o=s.changes.mapPos(i.pos,-1,ft.TrackDel);if(o==null)return null;let a=Object.assign(Object.create(null),i);a.pos=o,i.end!=null&&(a.end=s.changes.mapPos(i.end)),i=a}for(let o of s.effects)o.is(t)&&(i=o.value),o.is(Vf)&&(i=null);return i},provide:i=>Zr.from(i)});return[r,ot.define(i=>new Lf(i,n,r,t,e.hoverTime||300)),If]}function im(n,e){let t=n.plugin(Wl);if(!t)return null;let r=t.manager.tooltips.indexOf(e);return r<0?null:t.manager.tooltipViews[r]}const Vf=Ve.define(),ca=he.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function rm(n,e){let t=n.plugin(Ul),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const Ul=ot.fromClass(class{constructor(n){this.input=n.state.facet(fa),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(ca);this.top=new Er(n,!0,e.topContainer),this.bottom=new Er(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(ca);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Er(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Er(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(fa);if(t!=this.input){let r=t.filter(l=>l),i=[],s=[],o=[],a=[];for(let l of r){let h=this.specs.indexOf(l),c;h<0?(c=l(n.view),a.push(c)):(c=this.panels[h],c.update&&c.update(n)),i.push(c),(c.top?s:o).push(c)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>xe.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Er{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=ua(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=ua(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function ua(n){let e=n.nextSibling;return n.remove(),e}const fa=he.define({enables:Ul});class Ft extends Ti{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ft.prototype.elementClass="";Ft.prototype.toDOM=void 0;Ft.prototype.mapMode=ft.TrackBefore;Ft.prototype.startSide=Ft.prototype.endSide=-1;Ft.prototype.point=!0;const Br=he.define(),Ff={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Ne.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Xi=he.define();function Hf(n){return[Kl(),Xi.of(Object.assign(Object.assign({},Ff),n))]}const _s=he.define({combine:n=>n.some(e=>e)});function Kl(n){let e=[zf];return n&&n.fixed===!1&&e.push(_s.of(!0)),e}const zf=ot.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(Xi).map(e=>new pa(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(_s),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,r=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(r<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(_s)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=Ne.iter(this.view.state.facet(Br),this.view.viewport.from),r=[],i=this.gutters.map(s=>new Wf(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks){let o;if(Array.isArray(s.type)){for(let a of s.type)if(a.type==De.Text){o=a;break}}else o=s.type==De.Text?s:void 0;if(!!o){r.length&&(r=[]),Gl(t,r,s.from);for(let a of i)a.line(this.view,o,r)}}for(let s of i)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(Xi),t=n.state.facet(Xi),r=n.docChanged||n.heightChanged||n.viewportChanged||!Ne.eq(n.startState.facet(Br),n.state.facet(Br),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(n)&&(r=!0);else{r=!0;let i=[];for(let s of t){let o=e.indexOf(s);o<0?i.push(new pa(this.view,s)):(this.gutters[o].update(n),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)this.dom.appendChild(s.dom);this.gutters=i}return r}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>xe.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==We.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function da(n){return Array.isArray(n)?n:[n]}function Gl(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class Wf{constructor(e,t,r){this.gutter=e,this.height=r,this.localMarkers=[],this.i=0,this.cursor=Ne.iter(e.markers,t.from)}line(e,t,r){this.localMarkers.length&&(this.localMarkers=[]),Gl(this.cursor,this.localMarkers,t.from);let i=r.length?this.localMarkers.concat(r):this.localMarkers,s=this.gutter.config.lineMarker(e,t,i);s&&i.unshift(s);let o=this.gutter;if(i.length==0&&!o.config.renderEmptyElements)return;let a=t.top-this.height;if(this.i==o.elements.length){let l=new Jl(e,t.height,a,i);o.elements.push(l),o.dom.appendChild(l.dom)}else o.elements[this.i].update(e,t.height,a,i);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class pa{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in t.domEventHandlers)this.dom.addEventListener(r,i=>{let s=e.lineBlockAtHeight(i.clientY-e.documentTop);t.domEventHandlers[r](e,s,i)&&i.preventDefault()});this.markers=da(t.markers(e)),t.initialSpacer&&(this.spacer=new Jl(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=da(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let r=e.view.viewport;return!Ne.eq(this.markers,t,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Jl{constructor(e,t,r,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,i)}update(e,t,r,i){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),qf(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let r="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<t.length?t[s++]:null,h=!1;if(l){let c=l.elementClass;c&&(r+=" "+c);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(l)){a=u,h=!0;break}}else a=this.markers.length;for(;o<a;){let c=this.markers[o++];if(c.toDOM){c.destroy(i);let u=i.nextSibling;i.remove(),i=u}}if(!l)break;l.toDOM&&(h?i=i.nextSibling:this.dom.insertBefore(l.toDOM(e),i)),h&&o++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}function qf(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const Uf=he.define(),Si=he.define({combine(n){return lr(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let i in t){let s=r[i],o=t[i];r[i]=s?(a,l,h)=>s(a,l,h)||o(a,l,h):o}return r}})}});class An extends Ft{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function $n(n,e){return n.state.facet(Si).formatNumber(e,n.state)}const Kf=Xi.compute([Si],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Uf)},lineMarker(e,t,r){return r.some(i=>i.toDOM)?null:new An($n(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(Si)!=e.state.facet(Si),initialSpacer(e){return new An($n(e,ma(e.state.doc.lines)))},updateSpacer(e,t){let r=$n(t.view,ma(t.view.state.doc.lines));return r==e.number?e:new An(r)},domEventHandlers:n.facet(Si).domEventHandlers}));function nm(n={}){return[Si.of(n),Kl(),Kf]}function ma(n){let e=9;for(;e<n;)e=e*10+9;return e}const Gf=new class extends Ft{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Jf=Br.compute(["selection"],n=>{let e=[],t=-1;for(let r of n.selection.ranges)if(r.empty){let i=n.doc.lineAt(r.head).from;i>t&&(t=i,e.push(Gf.range(i)))}return Ne.of(e)});function sm(){return Jf}const Yf=1024;let Xf=0;class Pn{constructor(e,t){this.from=e,this.to=t}}class Ae{constructor(e={}){this.id=Xf++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=yt.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}Ae.closedBy=new Ae({deserialize:n=>n.split(" ")});Ae.openedBy=new Ae({deserialize:n=>n.split(" ")});Ae.group=new Ae({deserialize:n=>n.split(" ")});Ae.contextHash=new Ae({perNode:!0});Ae.lookAhead=new Ae({perNode:!0});Ae.mounted=new Ae({perNode:!0});const Qf=Object.create(null);class yt{constructor(e,t,r,i=0){this.name=e,this.props=t,this.id=r,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):Qf,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new yt(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Ae.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let i of r.split(" "))t[i]=e[r];return r=>{for(let i=r.prop(Ae.group),s=-1;s<(i?i.length:0);s++){let o=t[s<0?r.name:i[s]];if(o)return o}}}}yt.none=new yt("",Object.create(null),0,8);class Yl{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let i=null;for(let s of e){let o=s(r);o&&(i||(i=Object.assign({},r.props)),i[o[0].id]=o[1])}t.push(i?new yt(r.name,i,r.id,r.flags):r)}return new Yl(t)}}const Or=new WeakMap,ga=new WeakMap;var it;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(it||(it={}));class st{constructor(e,t,r,i,s){if(this.type=e,this.children=t,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=this.prop(Ae.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let i=r.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new rn(this.topNode,e)}cursorAt(e,t=0,r=0){let i=Or.get(this)||this.topNode,s=new rn(i);return s.moveTo(e,t),Or.set(this,s._tree),s}get topNode(){return new Vt(this,0,0,null)}resolve(e,t=0){let r=Mi(Or.get(this)||this.topNode,e,t,!1);return Or.set(this,r),r}resolveInner(e,t=0){let r=Mi(ga.get(this)||this.topNode,e,t,!0);return ga.set(this,r),r}iterate(e){let{enter:t,leave:r,from:i=0,to:s=this.length}=e;for(let o=this.cursor((e.mode||0)|it.IncludeAnonymous);;){let a=!1;if(o.from<=s&&o.to>=i&&(o.type.isAnonymous||t(o)!==!1)){if(o.firstChild())continue;a=!0}for(;a&&r&&!o.type.isAnonymous&&r(o),!o.nextSibling();){if(!o.parent())return;a=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Hs(yt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,i)=>new st(this.type,t,r,i,this.propValues),e.makeTree||((t,r,i)=>new st(yt.none,t,r,i)))}static build(e){return ed(e)}}st.empty=new st(yt.none,[],[],0);class Vs{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Vs(this.buffer,this.index)}}class wi{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return yt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,i,s){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(Xl(s,i,o[l+1],o[l+2])&&(a=l,r>0));l=o[l+3]);return a}slice(e,t,r,i){let s=this.buffer,o=new Uint16Array(t-e);for(let a=e,l=0;a<t;)o[l++]=s[a++],o[l++]=s[a++]-r,o[l++]=s[a++]-r,o[l++]=s[a++]-e;return new wi(o,i-r,this.set)}}function Xl(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function Ql(n,e){let t=n.childBefore(e);for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(n=t,t=r.prevSibling):t=r}return n}function Mi(n,e,t,r){for(var i;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof Vt&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:it.IgnoreOverlays;if(r)for(let o=n,a=o.parent;a;o=a,a=o.parent)o instanceof Vt&&o.index<0&&((i=a.enter(e,t,s))===null||i===void 0?void 0:i.from)!=o.from&&(n=a);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class Vt{constructor(e,t,r,i){this._tree=e,this.from=t,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,i,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,h=t>0?a.length:-1;e!=h;e+=t){let c=a[e],u=l[e]+o.from;if(!!Xl(i,r,u,u+c.length)){if(c instanceof wi){if(s&it.ExcludeBuffers)continue;let f=c.findChild(0,c.buffer.length,t,r-u,i);if(f>-1)return new Zt(new Zf(o,c,e,u),null,f)}else if(s&it.IncludeAnonymous||!c.type.isAnonymous||Fs(c)){let f;if(!(s&it.IgnoreMounts)&&c.props&&(f=c.prop(Ae.mounted))&&!f.overlay)return new Vt(f.tree,u,e,o);let p=new Vt(c,u,e,o);return s&it.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(t<0?c.children.length-1:0,t,r,i)}}}if(s&it.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let i;if(!(r&it.IgnoreOverlays)&&(i=this._tree.prop(Ae.mounted))&&i.overlay){let s=e-this.from;for(let{from:o,to:a}of i.overlay)if((t>0?o<=s:o<s)&&(t<0?a>=s:a>s))return new Vt(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new rn(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return Mi(this,e,t,!1)}resolveInner(e,t=0){return Mi(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Ql(this,e)}getChild(e,t=null,r=null){let i=en(this,e,t,r);return i.length?i[0]:null}getChildren(e,t=null,r=null){return en(this,e,t,r)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return tn(this,e)}}function en(n,e,t,r){let i=n.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(;!i.type.is(t);)if(!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function tn(n,e,t=e.length-1){for(let r=n.parent;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class Zf{constructor(e,t,r,i){this.parent=e,this.buffer=t,this.index=r,this.start=i}}class Zt{constructor(e,t,r){this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new Zt(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&it.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Zt(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Zt(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Zt(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new rn(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1],a=r.buffer[this.index+2];e.push(r.slice(i,s,o,a)),t.push(0)}return new st(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Mi(this,e,t,!1)}resolveInner(e,t=0){return Mi(this,e,t,!0)}enterUnfinishedNodesBefore(e){return Ql(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,r=null){let i=en(this,e,t,r);return i.length?i[0]:null}getChildren(e,t=null,r=null){return en(this,e,t,r)}get node(){return this}matchContext(e){return tn(this,e)}}class rn{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Vt)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof Vt?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&it.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&it.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&it.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=i)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let a=r._tree.children[s];if(this.mode&it.IncludeAnonymous||a instanceof wi||!a.type.isAnonymous||Fs(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer){e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;t=o,r=s+1;break e}i=this.stack[--s]}}for(let i=r;i<this.stack.length;i++)t=new Zt(this.buffer,t,this.stack[i]);return this.bufferNode=new Zt(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;i&&t&&t(this),i=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return tn(this.node,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return tn(this.node,e,i);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function Fs(n){return n.children.some(e=>e instanceof wi||!e.type.isAnonymous||Fs(e))}function ed(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:i=Yf,reused:s=[],minRepeatType:o=r.types.length}=n,a=Array.isArray(t)?new Vs(t,t.length):t,l=r.types,h=0,c=0;function u(x,C,T,N,z){let{id:D,start:R,end:W,size:B}=a,F=c;for(;B<0;)if(a.next(),B==-1){let fe=s[D];T.push(fe),N.push(R-x);return}else if(B==-3){h=D;return}else if(B==-4){c=D;return}else throw new RangeError(`Unrecognized record size: ${B}`);let se=l[D],Y,ie,le=R-x;if(W-R<=i&&(ie=g(a.pos-C,z))){let fe=new Uint16Array(ie.size-ie.skip),K=a.pos-ie.size,I=fe.length;for(;a.pos>K;)I=S(ie.start,fe,I);Y=new wi(fe,W-ie.start,r),le=ie.start-x}else{let fe=a.pos-B;a.next();let K=[],I=[],G=D>=o?D:-1,L=0,$=W;for(;a.pos>fe;)G>=0&&a.id==G&&a.size>=0?(a.end<=$-i&&(p(K,I,R,L,a.end,$,G,F),L=K.length,$=a.end),a.next()):u(R,fe,K,I,G);if(G>=0&&L>0&&L<K.length&&p(K,I,R,L,R,$,G,F),K.reverse(),I.reverse(),G>-1&&L>0){let _=f(se);Y=Hs(se,K,I,0,K.length,0,W-R,_,_)}else Y=d(se,K,I,W-R,F-W)}T.push(Y),N.push(le)}function f(x){return(C,T,N)=>{let z=0,D=C.length-1,R,W;if(D>=0&&(R=C[D])instanceof st){if(!D&&R.type==x&&R.length==N)return R;(W=R.prop(Ae.lookAhead))&&(z=T[D]+R.length+W)}return d(x,C,T,N,z)}}function p(x,C,T,N,z,D,R,W){let B=[],F=[];for(;x.length>N;)B.push(x.pop()),F.push(C.pop()+T-z);x.push(d(r.types[R],B,F,D-z,W-D)),C.push(z-T)}function d(x,C,T,N,z=0,D){if(h){let R=[Ae.contextHash,h];D=D?[R].concat(D):[R]}if(z>25){let R=[Ae.lookAhead,z];D=D?[R].concat(D):[R]}return new st(x,C,T,N,D)}function g(x,C){let T=a.fork(),N=0,z=0,D=0,R=T.end-i,W={size:0,start:0,skip:0};e:for(let B=T.pos-x;T.pos>B;){let F=T.size;if(T.id==C&&F>=0){W.size=N,W.start=z,W.skip=D,D+=4,N+=4,T.next();continue}let se=T.pos-F;if(F<0||se<B||T.start<R)break;let Y=T.id>=o?4:0,ie=T.start;for(T.next();T.pos>se;){if(T.size<0)if(T.size==-3)Y+=4;else break e;else T.id>=o&&(Y+=4);T.next()}z=ie,N+=F,D+=Y}return(C<0||N==x)&&(W.size=N,W.start=z,W.skip=D),W.size>4?W:void 0}function S(x,C,T){let{id:N,start:z,end:D,size:R}=a;if(a.next(),R>=0&&N<o){let W=T;if(R>4){let B=a.pos-(R-4);for(;a.pos>B;)T=S(x,C,T)}C[--T]=W,C[--T]=D-x,C[--T]=z-x,C[--T]=N}else R==-3?h=N:R==-4&&(c=N);return T}let m=[],y=[];for(;a.pos>0;)u(n.start||0,n.bufferStart||0,m,y,-1);let w=(e=n.length)!==null&&e!==void 0?e:m.length?y[0]+m[0].length:0;return new st(l[n.topID],m.reverse(),y.reverse(),w)}const ya=new WeakMap;function Vr(n,e){if(!n.isAnonymous||e instanceof wi||e.type!=n)return 1;let t=ya.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof st)){t=1;break}t+=Vr(n,r)}ya.set(e,t)}return t}function Hs(n,e,t,r,i,s,o,a,l){let h=0;for(let d=r;d<i;d++)h+=Vr(n,e[d]);let c=Math.ceil(h*1.5/8),u=[],f=[];function p(d,g,S,m,y){for(let w=S;w<m;){let x=w,C=g[w],T=Vr(n,d[w]);for(w++;w<m;w++){let N=Vr(n,d[w]);if(T+N>=c)break;T+=N}if(w==x+1){if(T>c){let N=d[x];p(N.children,N.positions,0,N.children.length,g[x]+y);continue}u.push(d[x])}else{let N=g[w-1]+d[w-1].length-C;u.push(Hs(n,d,g,x,w,C,N,null,l))}f.push(C+y-s)}}return p(e,t,r,i,0),(a||l)(u,f,o)}class di{constructor(e,t,r,i,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let i=[new di(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,r=128){if(!t.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,h=0;;a++){let c=a<t.length?t[a]:null,u=c?c.fromA:1e9;if(u-l>=r)for(;o&&o.from<u;){let f=o;if(l>=f.from||u<=f.to||h){let p=Math.max(f.from,l)-h,d=Math.min(f.to,u)-h;f=p>=d?null:new di(p,d,f.tree,f.offset+h,a>0,!!c)}if(f&&i.push(f),o.to>u)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,h=c.toA-c.toB}return i}}class td{startParse(e,t,r){return typeof e=="string"&&(e=new id(e)),r=r?r.length?r.map(i=>new Pn(i.from,i.to)):[new Pn(0,0)]:[new Pn(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let i=this.startParse(e,t,r);for(;;){let s=i.advance();if(s)return s}}}class id{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Ae({perNode:!0});let rd=0;class $t{constructor(e,t,r){this.set=e,this.base=t,this.modified=r,this.id=rd++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let t=new $t([],null,[]);if(t.set.push(t),e)for(let r of e.set)t.set.push(r);return t}static defineModifier(){let e=new nn;return t=>t.modified.indexOf(e)>-1?t:nn.get(t.base||t,t.modified.concat(e).sort((r,i)=>r.id-i.id))}}let nd=0;class nn{constructor(){this.instances=[],this.id=nd++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(a=>a.base==e&&sd(t,a.modified));if(r)return r;let i=[],s=new $t(i,e,t);for(let a of t)a.instances.push(s);let o=Zl(t);for(let a of e.set)for(let l of o)i.push(nn.get(a,l));return s}}function sd(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function Zl(n){let e=[n];for(let t=0;t<n.length;t++)for(let r of Zl(n.slice(0,t).concat(n.slice(t+1))))e.push(r);return e}function od(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let i of t.split(" "))if(i){let s=[],o=2,a=i;for(let u=0;;){if(a=="..."&&u>0&&u+3==i.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+i);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==i.length)break;let p=i[u++];if(u==i.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+i);a=i.slice(u)}let l=s.length-1,h=s[l];if(!h)throw new RangeError("Invalid path: "+i);let c=new ad(r,o,l>0?s.slice(0,l):null);e[h]=c.sort(e[h])}}return eh.add(e)}const eh=new Ae;class ad{constructor(e,t,r,i){this.tags=e,this.mode=t,this.context=r,this.next=i}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function th(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let a of s)for(let l of a.set){let h=t[l.id];if(h){o=o?o+" "+h:h;break}}return o},scope:r}}function ld(n,e){let t=null;for(let r of n){let i=r.style(e);i&&(t=t?t+" "+i:i)}return t}function hd(n,e,t,r=0,i=n.length){let s=new cd(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,i,"",s.highlighters),s.flush(i)}class cd{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,i,s){let{type:o,from:a,to:l}=e;if(a>=r||l<=t)return;o.isTop&&(s=this.highlighters.filter(p=>!p.scope||p.scope(o)));let h=i,c=o.prop(eh),u=!1;for(;c;){if(!c.context||e.matchContext(c.context)){let p=ld(s,c.tags);p&&(h&&(h+=" "),h+=p,c.mode==1?i+=(i?" ":"")+p:c.mode==0&&(u=!0));break}c=c.next}if(this.startSpan(e.from,h),u)return;let f=e.tree&&e.tree.prop(Ae.mounted);if(f&&f.overlay){let p=e.node.enter(f.overlay[0].from+a,1),d=this.highlighters.filter(S=>!S.scope||S.scope(f.tree.type)),g=e.firstChild();for(let S=0,m=a;;S++){let y=S<f.overlay.length?f.overlay[S]:null,w=y?y.from+a:l,x=Math.max(t,m),C=Math.min(r,w);if(x<C&&g)for(;e.from<C&&(this.highlightRange(e,x,C,i,s),this.startSpan(Math.min(r,e.to),h),!(e.to>=w||!e.nextSibling())););if(!y||w>r)break;m=y.to+a,m>t&&(this.highlightRange(p.cursor(),Math.max(t,y.from+a),Math.min(r,m),i,d),this.startSpan(m,h))}g&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,i,s),this.startSpan(Math.min(r,e.to),h)}while(e.nextSibling());e.parent()}}}const X=$t.define,Tr=X(),Wt=X(),va=X(Wt),wa=X(Wt),qt=X(),Ar=X(qt),Mn=X(qt),At=X(),hi=X(At),Ot=X(),Tt=X(),ks=X(),ji=X(ks),$r=X(),Q={comment:Tr,lineComment:X(Tr),blockComment:X(Tr),docComment:X(Tr),name:Wt,variableName:X(Wt),typeName:va,tagName:X(va),propertyName:wa,attributeName:X(wa),className:X(Wt),labelName:X(Wt),namespace:X(Wt),macroName:X(Wt),literal:qt,string:Ar,docString:X(Ar),character:X(Ar),attributeValue:X(Ar),number:Mn,integer:X(Mn),float:X(Mn),bool:X(qt),regexp:X(qt),escape:X(qt),color:X(qt),url:X(qt),keyword:Ot,self:X(Ot),null:X(Ot),atom:X(Ot),unit:X(Ot),modifier:X(Ot),operatorKeyword:X(Ot),controlKeyword:X(Ot),definitionKeyword:X(Ot),moduleKeyword:X(Ot),operator:Tt,derefOperator:X(Tt),arithmeticOperator:X(Tt),logicOperator:X(Tt),bitwiseOperator:X(Tt),compareOperator:X(Tt),updateOperator:X(Tt),definitionOperator:X(Tt),typeOperator:X(Tt),controlOperator:X(Tt),punctuation:ks,separator:X(ks),bracket:ji,angleBracket:X(ji),squareBracket:X(ji),paren:X(ji),brace:X(ji),content:At,heading:hi,heading1:X(hi),heading2:X(hi),heading3:X(hi),heading4:X(hi),heading5:X(hi),heading6:X(hi),contentSeparator:X(At),list:X(At),quote:X(At),emphasis:X(At),strong:X(At),link:X(At),monospace:X(At),strikethrough:X(At),inserted:X(),deleted:X(),changed:X(),invalid:X(),meta:$r,documentMeta:X($r),annotation:X($r),processingInstruction:X($r),definition:$t.defineModifier(),constant:$t.defineModifier(),function:$t.defineModifier(),standard:$t.defineModifier(),local:$t.defineModifier(),special:$t.defineModifier()};th([{tag:Q.link,class:"tok-link"},{tag:Q.heading,class:"tok-heading"},{tag:Q.emphasis,class:"tok-emphasis"},{tag:Q.strong,class:"tok-strong"},{tag:Q.keyword,class:"tok-keyword"},{tag:Q.atom,class:"tok-atom"},{tag:Q.bool,class:"tok-bool"},{tag:Q.url,class:"tok-url"},{tag:Q.labelName,class:"tok-labelName"},{tag:Q.inserted,class:"tok-inserted"},{tag:Q.deleted,class:"tok-deleted"},{tag:Q.literal,class:"tok-literal"},{tag:Q.string,class:"tok-string"},{tag:Q.number,class:"tok-number"},{tag:[Q.regexp,Q.escape,Q.special(Q.string)],class:"tok-string2"},{tag:Q.variableName,class:"tok-variableName"},{tag:Q.local(Q.variableName),class:"tok-variableName tok-local"},{tag:Q.definition(Q.variableName),class:"tok-variableName tok-definition"},{tag:Q.special(Q.variableName),class:"tok-variableName2"},{tag:Q.definition(Q.propertyName),class:"tok-propertyName tok-definition"},{tag:Q.typeName,class:"tok-typeName"},{tag:Q.namespace,class:"tok-namespace"},{tag:Q.className,class:"tok-className"},{tag:Q.macroName,class:"tok-macroName"},{tag:Q.propertyName,class:"tok-propertyName"},{tag:Q.operator,class:"tok-operator"},{tag:Q.comment,class:"tok-comment"},{tag:Q.meta,class:"tok-meta"},{tag:Q.invalid,class:"tok-invalid"},{tag:Q.punctuation,class:"tok-punctuation"}]);var Nn;const or=new Ae;function ud(n){return he.define({combine:n?e=>e.concat(n):void 0})}class _t{constructor(e,t,r=[]){this.data=e,Te.prototype.hasOwnProperty("tree")||Object.defineProperty(Te.prototype,"tree",{get(){return Nt(this)}}),this.parser=t,this.extension=[ri.of(this),Te.languageData.of((i,s,o)=>i.facet(ba(i,s,o)))].concat(r)}isActiveAt(e,t,r=-1){return ba(e,t,r)==this.data}findRegions(e){let t=e.facet(ri);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(or)==this.data){r.push({from:o,to:o+s.length});return}let a=s.prop(Ae.mounted);if(a){if(a.tree.prop(or)==this.data){if(a.overlay)for(let l of a.overlay)r.push({from:l.from+o,to:l.to+o});else r.push({from:o,to:o+s.length});return}else if(a.overlay){let l=r.length;if(i(a.tree,a.overlay[0].from+o),r.length>l)return}}for(let l=0;l<s.children.length;l++){let h=s.children[l];h instanceof st&&i(h,s.positions[l]+o)}};return i(Nt(e),0),r}get allowsNesting(){return!0}}_t.setState=Ve.define();function ba(n,e,t){let r=n.facet(ri);if(!r)return null;let i=r.data;if(r.allowsNesting)for(let s=Nt(n).topNode;s;s=s.enter(e,t,it.ExcludeBuffers))i=s.type.prop(or)||i;return i}class xs extends _t{constructor(e,t){super(e,t),this.parser=t}static define(e){let t=ud(e.languageData);return new xs(t,e.parser.configure({props:[or.add(r=>r.isTop?t:void 0)]}))}configure(e){return new xs(this.data,this.parser.configure(e))}get allowsNesting(){return this.parser.hasWrappers()}}function Nt(n){let e=n.field(_t.state,!1);return e?e.tree:st.empty}class fd{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let Bi=null;class sn{constructor(e,t,r=[],i,s,o,a,l){this.parser=e,this.state=t,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new sn(e,t,[],st.empty,0,r,[],null)}startParse(){return this.parser.startParse(new fd(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=st.empty&&this.isDone(t!=null?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(di.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t!=null?t:this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(di.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Bi;Bi=this;try{return e()}finally{Bi=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Sa(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((h,c,u,f)=>l.push({fromA:h,toA:c,fromB:u,toB:f})),r=di.applyChanges(r,l),i=st.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let h of this.skipped){let c=e.mapPos(h.from,1),u=e.mapPos(h.to,-1);c<u&&a.push({from:c,to:u})}}}return new sn(this.parser,t,r,i,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=Sa(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends td{createParse(t,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let l=Bi;if(l){for(let h of i)l.tempSkipped.push(h);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new st(yt.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Bi}}function Sa(n,e,t){return di.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Ni{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new Ni(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=sn.create(e.facet(ri).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new Ni(r)}}_t.state=kt.define({create:Ni.init,update(n,e){for(let t of e.effects)if(t.is(_t.setState))return t.value;return e.startState.facet(ri)!=e.state.facet(ri)?Ni.init(e.state):n.apply(e)}});let ih=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(ih=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:500-100})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Dn=typeof navigator<"u"&&((Nn=navigator.scheduling)===null||Nn===void 0?void 0:Nn.isInputPending)?()=>navigator.scheduling.isInputPending():null,dd=ot.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(_t.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(_t.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=ih(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(_t.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Dn?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<i&&r.doc.length>i+1e3,l=s.context.work(()=>Dn&&Dn()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:_t.setState.of(new Ni(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>jt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),ri=he.define({combine(n){return n.length?n[0]:null},enables:[_t.state,dd]});class am{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const pd=he.define(),rh=he.define({combine:n=>{if(!n.length)return"  ";if(!/^(?: +|\t+)$/.test(n[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return n[0]}});function md(n){let e=n.facet(rh);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function gd(n,e){let t="",r=n.tabSize;if(n.facet(rh).charCodeAt(0)==9)for(;e>=r;)t+="	",e-=r;for(let i=0;i<e;i++)t+=" ";return t}function yd(n,e){n instanceof Te&&(n=new nh(n));for(let r of n.state.facet(pd)){let i=r(n,e);if(i!=null)return i}let t=Nt(n.state);return t?wd(n,t,e):null}class nh{constructor(e,t={}){this.state=e,this.options=t,this.unit=md(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,t);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return Ns(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const vd=new Ae;function wd(n,e,t){return sh(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,n)}function bd(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Sd(n){let e=n.type.prop(vd);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(Ae.closedBy))){let i=n.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>Cd(o,!0,1,void 0,s&&!bd(o)?i.from:void 0)}return n.parent==null?_d:null}function sh(n,e,t){for(;n;n=n.parent){let r=Sd(n);if(r)return r(zs.create(t,e,n))}return null}function _d(){return 0}class zs extends nh{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.node=r}static create(e,t,r){return new zs(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(kd(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?sh(e,this.pos,this.base):0}}function kd(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function xd(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let i=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==r)return null;if(!l.type.isSkipped)return l.from<o?t:null;a=l.to}}function Cd(n,e,t,r,i){let s=n.textAfter,o=s.match(/^\s*/)[0].length,a=r&&s.slice(o,o+r.length)==r||i==n.pos+o,l=e?xd(n):null;return l?a?n.column(l.from):n.column(l.to):n.baseIndent+(a?0:n.unit*t)}function lm({except:n,units:e=1}={}){return t=>{let r=n&&n.test(t.textAfter);return t.baseIndent+(r?0:e*t.unit)}}const Ed=200;function hm(){return Te.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:r}=n.newSelection.main,i=t.lineAt(r);if(r>i.from+Ed)return n;let s=t.sliceString(i.from,r);if(!e.some(h=>h.test(s)))return n;let{state:o}=n,a=-1,l=[];for(let{head:h}of o.selection.ranges){let c=o.doc.lineAt(h);if(c.from==a)continue;a=c.from;let u=yd(o,c.from);if(u==null)continue;let f=/^\s*/.exec(c.text)[0],p=gd(o,u);f!=p&&l.push({from:c.from,to:c.from+f.length,insert:p})}return l.length?[n,{changes:l,sequential:!0}]:n})}const Od=he.define(),Td=new Ae;function cm(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function Ad(n,e,t){let r=Nt(n);if(r.length<t)return null;let i=r.resolveInner(t),s=null;for(let o=i;o;o=o.parent){if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let a=o.type.prop(Td);if(a&&(o.to<r.length-50||r.length==n.doc.length||!$d(o))){let l=a(o,n);l&&l.from<=t&&l.from>=e&&l.to>t&&(s=l)}}return s}function $d(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function on(n,e,t){for(let r of n.facet(Od)){let i=r(n,e,t);if(i)return i}return Ad(n,e,t)}function oh(n,e){let t=e.mapPos(n.from,1),r=e.mapPos(n.to,-1);return t>=r?void 0:{from:t,to:r}}const mn=Ve.define({map:oh}),cr=Ve.define({map:oh});function ah(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(r=>r.from<=t&&r.to>=t)||e.push(n.lineBlockAt(t));return e}const yi=kt.define({create(){return Ee.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)t.is(mn)&&!Pd(n,t.value.from,t.value.to)?n=n.update({add:[_a.range(t.value.from,t.value.to)]}):t.is(cr)&&(n=n.update({filter:(r,i)=>t.value.from!=r||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:r}=e.selection.main;n.between(r,r,(i,s)=>{i<r&&s>r&&(t=!0)}),t&&(n=n.update({filterFrom:r,filterTo:r,filter:(i,s)=>s<=r||i>=r}))}return n},provide:n=>xe.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(r,i)=>{t.push(r,i)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let r=n[t++],i=n[t++];if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(_a.range(r,i))}return Ee.set(e,!0)}});function an(n,e,t){var r;let i=null;return(r=n.field(yi,!1))===null||r===void 0||r.between(e,t,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function Pd(n,e,t){let r=!1;return n.between(e,e,(i,s)=>{i==e&&s==t&&(r=!0)}),r}function lh(n,e){return n.field(yi,!1)?e:e.concat(Ve.appendConfig.of(uh()))}const Md=n=>{for(let e of ah(n)){let t=on(n.state,e.from,e.to);if(t)return n.dispatch({effects:lh(n.state,[mn.of(t),hh(n,t)])}),!0}return!1},Nd=n=>{if(!n.state.field(yi,!1))return!1;let e=[];for(let t of ah(n)){let r=an(n.state,t.from,t.to);r&&e.push(cr.of(r),hh(n,r,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function hh(n,e,t=!0){let r=n.state.doc.lineAt(e.from).number,i=n.state.doc.lineAt(e.to).number;return xe.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${i}.`)}const Dd=n=>{let{state:e}=n,t=[];for(let r=0;r<e.doc.length;){let i=n.lineBlockAt(r),s=on(e,i.from,i.to);s&&t.push(mn.of(s)),r=(s?n.lineBlockAt(s.to):i).to+1}return t.length&&n.dispatch({effects:lh(n.state,t)}),!!t.length},Rd=n=>{let e=n.state.field(yi,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(r,i)=>{t.push(cr.of({from:r,to:i}))}),n.dispatch({effects:t}),!0},um=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Md},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Nd},{key:"Ctrl-Alt-[",run:Dd},{key:"Ctrl-Alt-]",run:Rd}],Id={placeholderDOM:null,placeholderText:"\u2026"},ch=he.define({combine(n){return lr(n,Id)}});function uh(n){let e=[yi,jd];return n&&e.push(ch.of(n)),e}const _a=Ee.replace({widget:new class extends vi{toDOM(n){let{state:e}=n,t=e.facet(ch),r=s=>{let o=n.lineBlockAt(n.posAtDOM(s.target)),a=an(n.state,o.from,o.to);a&&n.dispatch({effects:cr.of(a)}),s.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(n,r);let i=document.createElement("span");return i.textContent=t.placeholderText,i.setAttribute("aria-label",e.phrase("folded code")),i.title=e.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=r,i}}}),Ld={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Rn extends Ft{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function fm(n={}){let e=Object.assign(Object.assign({},Ld),n),t=new Rn(e,!0),r=new Rn(e,!1),i=ot.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(ri)!=o.state.facet(ri)||o.startState.field(yi,!1)!=o.state.field(yi,!1)||Nt(o.startState)!=Nt(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new mi;for(let l of o.viewportLineBlocks){let h=an(o.state,l.from,l.to)?r:on(o.state,l.from,l.to)?t:null;h&&a.add(l.from,l.from,h)}return a.finish()}}),{domEventHandlers:s}=e;return[i,Hf({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(i))===null||a===void 0?void 0:a.markers)||Ne.empty},initialSpacer(){return new Rn(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,a,l)=>{if(s.click&&s.click(o,a,l))return!0;let h=an(o.state,a.from,a.to);if(h)return o.dispatch({effects:cr.of(h)}),!0;let c=on(o.state,a.from,a.to);return c?(o.dispatch({effects:mn.of(c)}),!0):!1}})}),uh()]}const jd=xe.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ur{constructor(e,t){let r;function i(a){let l=ei.newName();return(r||(r=Object.create(null)))["."+l]=a,l}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,o=t.scope;this.scope=o instanceof _t?a=>a.prop(or)==o.data:o?a=>a==o:void 0,this.style=th(e.map(a=>({tag:a.tag,class:a.class||i(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=r?new ei(r):null,this.themeType=t.themeType}static define(e,t){return new ur(e,t||{})}}const Cs=he.define(),fh=he.define({combine(n){return n.length?[n[0]]:null}});function In(n){let e=n.facet(Cs);return e.length?e:n.facet(fh)}function Bd(n,e){let t=[Fd],r;return n instanceof ur&&(n.module&&t.push(xe.styleModule.of(n.module)),r=n.themeType),e!=null&&e.fallback?t.push(fh.of(n)):r?t.push(Cs.computeN([xe.darkTheme],i=>i.facet(xe.darkTheme)==(r=="dark")?[n]:[])):t.push(Cs.of(n)),t}class Vd{constructor(e){this.markCache=Object.create(null),this.tree=Nt(e.state),this.decorations=this.buildDeco(e,In(e.state))}update(e){let t=Nt(e.state),r=In(e.state),i=r!=In(e.startState);t.length<e.view.viewport.to&&!i&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r))}buildDeco(e,t){if(!t||!this.tree.length)return Ee.none;let r=new mi;for(let{from:i,to:s}of e.visibleRanges)hd(this.tree,t,(o,a,l)=>{r.add(o,a,this.markCache[l]||(this.markCache[l]=Ee.mark({class:l})))},i,s);return r.finish()}}const Fd=hn.high(ot.fromClass(Vd,{decorations:n=>n.decorations})),dm=ur.define([{tag:Q.meta,color:"#7a757a"},{tag:Q.link,textDecoration:"underline"},{tag:Q.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Q.emphasis,fontStyle:"italic"},{tag:Q.strong,fontWeight:"bold"},{tag:Q.strikethrough,textDecoration:"line-through"},{tag:Q.keyword,color:"#708"},{tag:[Q.atom,Q.bool,Q.url,Q.contentSeparator,Q.labelName],color:"#219"},{tag:[Q.literal,Q.inserted],color:"#164"},{tag:[Q.string,Q.deleted],color:"#a11"},{tag:[Q.regexp,Q.escape,Q.special(Q.string)],color:"#e40"},{tag:Q.definition(Q.variableName),color:"#00f"},{tag:Q.local(Q.variableName),color:"#30a"},{tag:[Q.typeName,Q.namespace],color:"#085"},{tag:Q.className,color:"#167"},{tag:[Q.special(Q.variableName),Q.macroName],color:"#256"},{tag:Q.definition(Q.propertyName),color:"#00c"},{tag:Q.comment,color:"#940"},{tag:Q.invalid,color:"#f00"}]),Hd=xe.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),dh=1e4,ph="()[]{}",mh=he.define({combine(n){return lr(n,{afterCursor:!0,brackets:ph,maxScanDistance:dh,renderMatch:qd})}}),zd=Ee.mark({class:"cm-matchingBracket"}),Wd=Ee.mark({class:"cm-nonmatchingBracket"});function qd(n){let e=[],t=n.matched?zd:Wd;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const Ud=kt.define({create(){return Ee.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],r=e.state.facet(mh);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=Pr(e.state,i.head,-1,r)||i.head>0&&Pr(e.state,i.head-1,1,r)||r.afterCursor&&(Pr(e.state,i.head,1,r)||i.head<e.state.doc.length&&Pr(e.state,i.head+1,-1,r));s&&(t=t.concat(r.renderMatch(s,e.state)))}return Ee.set(t,!0)},provide:n=>xe.decorations.from(n)}),Kd=[Ud,Hd];function pm(n={}){return[mh.of(n),Kd]}function Es(n,e,t){let r=n.prop(e<0?Ae.openedBy:Ae.closedBy);if(r)return r;if(n.name.length==1){let i=t.indexOf(n.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function Pr(n,e,t,r={}){let i=r.maxScanDistance||dh,s=r.brackets||ph,o=Nt(n),a=o.resolveInner(e,t);for(let l=a;l;l=l.parent){let h=Es(l.type,t,s);if(h&&l.from<l.to)return Gd(n,e,t,l,h,s)}return Jd(n,e,t,o,a.type,i,s)}function Gd(n,e,t,r,i,s){let o=r.parent,a={from:r.from,to:r.to},l=0,h=o==null?void 0:o.cursor();if(h&&(t<0?h.childBefore(r.from):h.childAfter(r.to)))do if(t<0?h.to<=r.from:h.from>=r.to){if(l==0&&i.indexOf(h.type.name)>-1&&h.from<h.to)return{start:a,end:{from:h.from,to:h.to},matched:!0};if(Es(h.type,t,s))l++;else if(Es(h.type,-t,s)){if(l==0)return{start:a,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1};l--}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function Jd(n,e,t,r,i,s,o){let a=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=t>0)return null;let h={from:t<0?e-1:e,to:t>0?e+1:e},c=n.doc.iterRange(e,t>0?n.doc.length:0),u=0;for(let f=0;!c.next().done&&f<=s;){let p=c.value;t<0&&(f+=p.length);let d=e+f*t;for(let g=t>0?0:p.length-1,S=t>0?p.length:-1;g!=S;g+=t){let m=o.indexOf(p[g]);if(!(m<0||r.resolveInner(d+g,1).type!=i))if(m%2==0==t>0)u++;else{if(u==1)return{start:h,end:{from:d+g,to:d+g+1},matched:m>>1==l>>1};u--}}t>0&&(f+=p.length)}return c.done?{start:h,matched:!1}:null}const Yd=Object.create(null),ka=[yt.none],xa=[],Xd=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Xd[n]=Qd(Yd,e);function Ln(n,e){xa.indexOf(n)>-1||(xa.push(n),console.warn(e))}function Qd(n,e){let t=null;for(let s of e.split(".")){let o=n[s]||Q[s];o?typeof o=="function"?t?t=o(t):Ln(s,`Modifier ${s} used at start of tag`):t?Ln(s,`Tag ${s} used as modifier`):t=o:Ln(s,`Unknown highlighting tag ${s}`)}if(!t)return 0;let r=e.replace(/ /g,"_"),i=yt.define({id:ka.length,name:r,props:[od({[r]:t})]});return ka.push(i),i.id}const Ws=ur.define([{tag:Q.propertyName,color:"var(--jse-key-color)"},{tag:Q.number,color:"var(--jse-value-color-number)"},{tag:Q.bool,color:"var(--jse-value-color-boolean)"},{tag:Q.string,color:"var(--jse-value-color-string)"},{tag:Q.keyword,color:"var(--jse-value-color-null)"}]),mm=Bd(Ws),Zd=Ws.style;Ws.style=n=>Zd(n||[]);function jn(n,e){const t=Date.now(),r=n(),i=Date.now();return e(i-t),r}const qi=ln("validation");function gm(n){const e={};return n.forEach(t=>{e[Fr(t.path)]=t}),n.forEach(t=>{let r=t.path;for(;r.length>0;){r=pc(r);const i=Fr(r);i in e||(e[i]={isChildError:!0,path:r,message:"Contains invalid data"})}}),e}function ym(n,e){return qi("validateJSON"),e(n)}function vm(n,e){if(qi("validateText"),n.length>xh)return{validationErrors:[{path:[],message:"Validation turned off: the document is too large",severity:zn.info}]};if(n.length===0)return{validationErrors:[]};try{const t=jn(()=>JSON.parse(n),i=>qi(`validate: parsed json in ${i} ms`));return e?{validationErrors:jn(()=>e(t),i=>qi(`validate: validated json in ${i} ms`))}:{validationErrors:[]}}catch(t){const r=jn(()=>ep(n),s=>qi(`validate: checked whether repairable in ${s} ms`));return{parseError:vc(n,t.message||t.toString()),isRepairable:r}}}function ep(n){if(n.length>Ch)return!1;try{return JSON.parse(Ui(n)),!0}catch{return!1}}const Bn=ln("jsoneditor:AutoScrollHandler");function wm(n){Bn("createAutoScrollHandler",n);let e,t;function r(h){return h<20?bh:h<50?Sh:_h}function i(){if(n){const h=e*(Ys/1e3);n.scrollTop+=h}}function s(h){(!t||h!==e)&&(o(),Bn("startAutoScroll",h),e=h,t=setInterval(i,Ys))}function o(){t&&(Bn("stopAutoScroll"),clearInterval(t),t=void 0,e=void 0)}function a(h){if(n){const c=h.clientY,{top:u,bottom:f}=n.getBoundingClientRect();if(c<u){const p=r(u-c);s(-p)}else if(c>f){const p=r(c-f);s(p)}else o()}}function l(){o()}return{onDrag:a,onDragEnd:l}}const tp=1e3,Mr=ln("jsoneditor:History");function bm(n={}){const e=n.maxItems||tp;let t=[],r=0;function i(){return r<t.length}function s(){return r>0}function o(){return{canUndo:i(),canRedo:s(),length:t.length}}function a(){n.onChange&&n.onChange(o())}function l(f){Mr("add",f),t=[f].concat(t.slice(r)).slice(0,e),r=0,a()}function h(){Mr("clear"),t=[],r=0,a()}function c(){if(i()){const f=t[r];return r+=1,Mr("undo",f),a(),f}}function u(){if(s())return r-=1,Mr("redo",t[r]),a(),t[r]}return{add:l,clear:h,getState:o,undo:c,redo:u}}var gh={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var r=[],i=0;i<arguments.length;i++){var s=arguments[i];if(!!s){var o=typeof s;if(o==="string"||o==="number")r.push(s);else if(Array.isArray(s)){if(s.length){var a=t.apply(null,s);a&&r.push(a)}}else if(o==="object")if(s.toString===Object.prototype.toString)for(var l in s)e.call(s,l)&&s[l]&&r.push(l);else r.push(s.toString())}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(gh);const Sm=gh.exports;var ip={exports:{}};/*
 * @version    1.4.0
 * @date       2015-10-26
 * @stability  3 - Stable
 * @author     Lauri Rooden (https://github.com/litejs/natural-compare-lite)
 * @license    MIT License
 */var Ca=function(n,e){var t,r,i=1,s=0,o=0,a=String.alphabet;function l(h,c,u){if(u){for(t=c;u=l(h,t),u<76&&u>65;)++t;return+h.slice(c-1,t)}return u=a&&a.indexOf(h.charAt(c)),u>-1?u+76:(u=h.charCodeAt(c)||0,u<45||u>127?u:u<46?65:u<48?u-1:u<58?u+18:u<65?u-11:u<91?u+11:u<97?u-37:u<123?u+5:u-63)}if((n+="")!=(e+="")){for(;i;)if(r=l(n,s++),i=l(e,o++),r<76&&i<76&&r>66&&i>66&&(r=l(n,s,s),i=l(e,o,s=t),o=t),r!=i)return r<i?-1:1}return 0};try{ip.exports=Ca}catch{String.naturalCompare=Ca}function Nr(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rp={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,s){function o(h,c){if(!i[h]){if(!r[h]){var u=typeof Nr=="function"&&Nr;if(!c&&u)return u(h,!0);if(a)return a(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var p=i[h]={exports:{}};r[h][0].call(p.exports,function(d){return o(r[h][1][d]||d)},p,p.exports,t,r,i,s)}return i[h].exports}for(var a=typeof Nr=="function"&&Nr,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.regexpCode=i.getEsmExportName=i.getProperty=i.safeStringify=i.stringify=i.strConcat=i.addCodeArg=i.str=i._=i.nil=i._Code=i.Name=i.IDENTIFIER=i._CodeOrName=void 0;class s{}i._CodeOrName=s,i.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class o extends s{constructor(g){if(super(),!i.IDENTIFIER.test(g))throw new Error("CodeGen: name must be a valid identifier");this.str=g}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}i.Name=o;class a extends s{constructor(g){super(),this._items=typeof g=="string"?[g]:g}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const g=this._items[0];return g===""||g==='""'}get str(){var g;return(g=this._str)!==null&&g!==void 0?g:this._str=this._items.reduce((S,m)=>`${S}${m}`,"")}get names(){var g;return(g=this._names)!==null&&g!==void 0?g:this._names=this._items.reduce((S,m)=>(m instanceof o&&(S[m.str]=(S[m.str]||0)+1),S),{})}}function l(d,...g){const S=[d[0]];let m=0;for(;m<g.length;)u(S,g[m]),S.push(d[++m]);return new a(S)}i._Code=a,i.nil=new a(""),i._=l;const h=new a("+");function c(d,...g){const S=[p(d[0])];let m=0;for(;m<g.length;)S.push(h),u(S,g[m]),S.push(h,p(d[++m]));return function(y){let w=1;for(;w<y.length-1;){if(y[w]===h){const x=f(y[w-1],y[w+1]);if(x!==void 0){y.splice(w-1,3,x);continue}y[w++]="+"}w++}}(S),new a(S)}function u(d,g){var S;g instanceof a?d.push(...g._items):d.push(g instanceof o?g:typeof(S=g)=="number"||typeof S=="boolean"||S===null?S:p(Array.isArray(S)?S.join(","):S))}function f(d,g){return g==='""'?d:d==='""'?g:typeof d=="string"?g instanceof o||d[d.length-1]!=='"'?void 0:typeof g!="string"?`${d.slice(0,-1)}${g}"`:g[0]==='"'?d.slice(0,-1)+g.slice(1):void 0:typeof g!="string"||g[0]!=='"'||d instanceof o?void 0:`"${d}${g.slice(1)}`}function p(d){return JSON.stringify(d).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}i.str=c,i.addCodeArg=u,i.strConcat=function(d,g){return g.emptyStr()?d:d.emptyStr()?g:c`${d}${g}`},i.stringify=function(d){return new a(p(d))},i.safeStringify=p,i.getProperty=function(d){return typeof d=="string"&&i.IDENTIFIER.test(d)?new a(`.${d}`):l`[${d}]`},i.getEsmExportName=function(d){if(typeof d=="string"&&i.IDENTIFIER.test(d))return new a(`${d}`);throw new Error(`CodeGen: invalid export name: ${d}, use explicit $id name mapping`)},i.regexpCode=function(d){return new a(d.toString())}},{}],2:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.or=i.and=i.not=i.CodeGen=i.operators=i.varKinds=i.ValueScopeName=i.ValueScope=i.Scope=i.Name=i.regexpCode=i.stringify=i.getProperty=i.nil=i.strConcat=i.str=i._=void 0;const s=t("./code"),o=t("./scope");var a=t("./code");Object.defineProperty(i,"_",{enumerable:!0,get(){return a._}}),Object.defineProperty(i,"str",{enumerable:!0,get(){return a.str}}),Object.defineProperty(i,"strConcat",{enumerable:!0,get(){return a.strConcat}}),Object.defineProperty(i,"nil",{enumerable:!0,get(){return a.nil}}),Object.defineProperty(i,"getProperty",{enumerable:!0,get(){return a.getProperty}}),Object.defineProperty(i,"stringify",{enumerable:!0,get(){return a.stringify}}),Object.defineProperty(i,"regexpCode",{enumerable:!0,get(){return a.regexpCode}}),Object.defineProperty(i,"Name",{enumerable:!0,get(){return a.Name}});var l=t("./scope");Object.defineProperty(i,"Scope",{enumerable:!0,get(){return l.Scope}}),Object.defineProperty(i,"ValueScope",{enumerable:!0,get(){return l.ValueScope}}),Object.defineProperty(i,"ValueScopeName",{enumerable:!0,get(){return l.ValueScopeName}}),Object.defineProperty(i,"varKinds",{enumerable:!0,get(){return l.varKinds}}),i.operators={GT:new s._Code(">"),GTE:new s._Code(">="),LT:new s._Code("<"),LTE:new s._Code("<="),EQ:new s._Code("==="),NEQ:new s._Code("!=="),NOT:new s._Code("!"),OR:new s._Code("||"),AND:new s._Code("&&"),ADD:new s._Code("+")};class h{optimizeNodes(){return this}optimizeNames(v,P){return this}}class c extends h{constructor(v,P,V){super(),this.varKind=v,this.name=P,this.rhs=V}render({es5:v,_n:P}){return`${v?o.varKinds.var:this.varKind} ${this.name}${this.rhs===void 0?"":` = ${this.rhs}`};`+P}optimizeNames(v,P){if(v[this.name.str])return this.rhs&&(this.rhs=le(this.rhs,v,P)),this}get names(){return this.rhs instanceof s._CodeOrName?this.rhs.names:{}}}class u extends h{constructor(v,P,V){super(),this.lhs=v,this.rhs=P,this.sideEffects=V}render({_n:v}){return`${this.lhs} = ${this.rhs};`+v}optimizeNames(v,P){if(!(this.lhs instanceof s.Name)||v[this.lhs.str]||this.sideEffects)return this.rhs=le(this.rhs,v,P),this}get names(){return ie(this.lhs instanceof s.Name?{}:{...this.lhs.names},this.rhs)}}class f extends u{constructor(v,P,V,J){super(v,V,J),this.op=P}render({_n:v}){return`${this.lhs} ${this.op}= ${this.rhs};`+v}}class p extends h{constructor(v){super(),this.label=v,this.names={}}render({_n:v}){return`${this.label}:`+v}}class d extends h{constructor(v){super(),this.label=v,this.names={}}render({_n:v}){return`break${this.label?` ${this.label}`:""};`+v}}class g extends h{constructor(v){super(),this.error=v}render({_n:v}){return`throw ${this.error};`+v}get names(){return this.error.names}}class S extends h{constructor(v){super(),this.code=v}render({_n:v}){return`${this.code};`+v}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(v,P){return this.code=le(this.code,v,P),this}get names(){return this.code instanceof s._CodeOrName?this.code.names:{}}}class m extends h{constructor(v=[]){super(),this.nodes=v}render(v){return this.nodes.reduce((P,V)=>P+V.render(v),"")}optimizeNodes(){const{nodes:v}=this;let P=v.length;for(;P--;){const V=v[P].optimizeNodes();Array.isArray(V)?v.splice(P,1,...V):V?v[P]=V:v.splice(P,1)}return v.length>0?this:void 0}optimizeNames(v,P){const{nodes:V}=this;let J=V.length;for(;J--;){const ne=V[J];ne.optimizeNames(v,P)||(fe(v,ne.names),V.splice(J,1))}return V.length>0?this:void 0}get names(){return this.nodes.reduce((v,P)=>Y(v,P.names),{})}}class y extends m{render(v){return"{"+v._n+super.render(v)+"}"+v._n}}class w extends m{}class x extends y{}x.kind="else";class C extends y{constructor(v,P){super(P),this.condition=v}render(v){let P=`if(${this.condition})`+super.render(v);return this.else&&(P+="else "+this.else.render(v)),P}optimizeNodes(){super.optimizeNodes();const v=this.condition;if(v===!0)return this.nodes;let P=this.else;if(P){const V=P.optimizeNodes();P=this.else=Array.isArray(V)?new x(V):V}return P?v===!1?P instanceof C?P:P.nodes:this.nodes.length?this:new C(K(v),P instanceof C?[P]:P.nodes):v!==!1&&this.nodes.length?this:void 0}optimizeNames(v,P){var V;if(this.else=(V=this.else)===null||V===void 0?void 0:V.optimizeNames(v,P),super.optimizeNames(v,P)||this.else)return this.condition=le(this.condition,v,P),this}get names(){const v=super.names;return ie(v,this.condition),this.else&&Y(v,this.else.names),v}}C.kind="if";class T extends y{}T.kind="for";class N extends T{constructor(v){super(),this.iteration=v}render(v){return`for(${this.iteration})`+super.render(v)}optimizeNames(v,P){if(super.optimizeNames(v,P))return this.iteration=le(this.iteration,v,P),this}get names(){return Y(super.names,this.iteration.names)}}class z extends T{constructor(v,P,V,J){super(),this.varKind=v,this.name=P,this.from=V,this.to=J}render(v){const P=v.es5?o.varKinds.var:this.varKind,{name:V,from:J,to:ne}=this;return`for(${P} ${V}=${J}; ${V}<${ne}; ${V}++)`+super.render(v)}get names(){const v=ie(super.names,this.from);return ie(v,this.to)}}class D extends T{constructor(v,P,V,J){super(),this.loop=v,this.varKind=P,this.name=V,this.iterable=J}render(v){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(v)}optimizeNames(v,P){if(super.optimizeNames(v,P))return this.iterable=le(this.iterable,v,P),this}get names(){return Y(super.names,this.iterable.names)}}class R extends y{constructor(v,P,V){super(),this.name=v,this.args=P,this.async=V}render(v){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(v)}}R.kind="func";class W extends m{render(v){return"return "+super.render(v)}}W.kind="return";class B extends y{render(v){let P="try"+super.render(v);return this.catch&&(P+=this.catch.render(v)),this.finally&&(P+=this.finally.render(v)),P}optimizeNodes(){var v,P;return super.optimizeNodes(),(v=this.catch)===null||v===void 0||v.optimizeNodes(),(P=this.finally)===null||P===void 0||P.optimizeNodes(),this}optimizeNames(v,P){var V,J;return super.optimizeNames(v,P),(V=this.catch)===null||V===void 0||V.optimizeNames(v,P),(J=this.finally)===null||J===void 0||J.optimizeNames(v,P),this}get names(){const v=super.names;return this.catch&&Y(v,this.catch.names),this.finally&&Y(v,this.finally.names),v}}class F extends y{constructor(v){super(),this.error=v}render(v){return`catch(${this.error})`+super.render(v)}}F.kind="catch";class se extends y{render(v){return"finally"+super.render(v)}}se.kind="finally";function Y(_,v){for(const P in v)_[P]=(_[P]||0)+(v[P]||0);return _}function ie(_,v){return v instanceof s._CodeOrName?Y(_,v.names):_}function le(_,v,P){return _ instanceof s.Name?J(_):(V=_)instanceof s._Code&&V._items.some(ne=>ne instanceof s.Name&&v[ne.str]===1&&P[ne.str]!==void 0)?new s._Code(_._items.reduce((ne,ce)=>(ce instanceof s.Name&&(ce=J(ce)),ce instanceof s._Code?ne.push(...ce._items):ne.push(ce),ne),[])):_;var V;function J(ne){const ce=P[ne.str];return ce===void 0||v[ne.str]!==1?ne:(delete v[ne.str],ce)}}function fe(_,v){for(const P in v)_[P]=(_[P]||0)-(v[P]||0)}function K(_){return typeof _=="boolean"||typeof _=="number"||_===null?!_:s._`!${$(_)}`}i.CodeGen=class{constructor(_,v={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...v,_n:v.lines?`
`:""},this._extScope=_,this._scope=new o.Scope({parent:_}),this._nodes=[new w]}toString(){return this._root.render(this.opts)}name(_){return this._scope.name(_)}scopeName(_){return this._extScope.name(_)}scopeValue(_,v){const P=this._extScope.value(_,v);return(this._values[P.prefix]||(this._values[P.prefix]=new Set)).add(P),P}getScopeValue(_,v){return this._extScope.getValue(_,v)}scopeRefs(_){return this._extScope.scopeRefs(_,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(_,v,P,V){const J=this._scope.toName(v);return P!==void 0&&V&&(this._constants[J.str]=P),this._leafNode(new c(_,J,P)),J}const(_,v,P){return this._def(o.varKinds.const,_,v,P)}let(_,v,P){return this._def(o.varKinds.let,_,v,P)}var(_,v,P){return this._def(o.varKinds.var,_,v,P)}assign(_,v,P){return this._leafNode(new u(_,v,P))}add(_,v){return this._leafNode(new f(_,i.operators.ADD,v))}code(_){return typeof _=="function"?_():_!==s.nil&&this._leafNode(new S(_)),this}object(..._){const v=["{"];for(const[P,V]of _)v.length>1&&v.push(","),v.push(P),(P!==V||this.opts.es5)&&(v.push(":"),(0,s.addCodeArg)(v,V));return v.push("}"),new s._Code(v)}if(_,v,P){if(this._blockNode(new C(_)),v&&P)this.code(v).else().code(P).endIf();else if(v)this.code(v).endIf();else if(P)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(_){return this._elseNode(new C(_))}else(){return this._elseNode(new x)}endIf(){return this._endBlockNode(C,x)}_for(_,v){return this._blockNode(_),v&&this.code(v).endFor(),this}for(_,v){return this._for(new N(_),v)}forRange(_,v,P,V,J=this.opts.es5?o.varKinds.var:o.varKinds.let){const ne=this._scope.toName(_);return this._for(new z(J,ne,v,P),()=>V(ne))}forOf(_,v,P,V=o.varKinds.const){const J=this._scope.toName(_);if(this.opts.es5){const ne=v instanceof s.Name?v:this.var("_arr",v);return this.forRange("_i",0,s._`${ne}.length`,ce=>{this.var(J,s._`${ne}[${ce}]`),P(J)})}return this._for(new D("of",V,J,v),()=>P(J))}forIn(_,v,P,V=this.opts.es5?o.varKinds.var:o.varKinds.const){if(this.opts.ownProperties)return this.forOf(_,s._`Object.keys(${v})`,P);const J=this._scope.toName(_);return this._for(new D("in",V,J,v),()=>P(J))}endFor(){return this._endBlockNode(T)}label(_){return this._leafNode(new p(_))}break(_){return this._leafNode(new d(_))}return(_){const v=new W;if(this._blockNode(v),this.code(_),v.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(W)}try(_,v,P){if(!v&&!P)throw new Error('CodeGen: "try" without "catch" and "finally"');const V=new B;if(this._blockNode(V),this.code(_),v){const J=this.name("e");this._currNode=V.catch=new F(J),v(J)}return P&&(this._currNode=V.finally=new se,this.code(P)),this._endBlockNode(F,se)}throw(_){return this._leafNode(new g(_))}block(_,v){return this._blockStarts.push(this._nodes.length),_&&this.code(_).endBlock(v),this}endBlock(_){const v=this._blockStarts.pop();if(v===void 0)throw new Error("CodeGen: not in self-balancing block");const P=this._nodes.length-v;if(P<0||_!==void 0&&P!==_)throw new Error(`CodeGen: wrong number of nodes: ${P} vs ${_} expected`);return this._nodes.length=v,this}func(_,v=s.nil,P,V){return this._blockNode(new R(_,v,P)),V&&this.code(V).endFunc(),this}endFunc(){return this._endBlockNode(R)}optimize(_=1){for(;_-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(_){return this._currNode.nodes.push(_),this}_blockNode(_){this._currNode.nodes.push(_),this._nodes.push(_)}_endBlockNode(_,v){const P=this._currNode;if(P instanceof _||v&&P instanceof v)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${v?`${_.kind}/${v.kind}`:_.kind}"`)}_elseNode(_){const v=this._currNode;if(!(v instanceof C))throw new Error('CodeGen: "else" without "if"');return this._currNode=v.else=_,this}get _root(){return this._nodes[0]}get _currNode(){const _=this._nodes;return _[_.length-1]}set _currNode(_){const v=this._nodes;v[v.length-1]=_}},i.not=K;const I=L(i.operators.AND);i.and=function(..._){return _.reduce(I)};const G=L(i.operators.OR);function L(_){return(v,P)=>v===s.nil?P:P===s.nil?v:s._`${$(v)} ${_} ${$(P)}`}function $(_){return _ instanceof s.Name?_:s._`(${_})`}i.or=function(..._){return _.reduce(G)}},{"./code":1,"./scope":3}],3:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ValueScope=i.ValueScopeName=i.Scope=i.varKinds=i.UsedValueState=void 0;const s=t("./code");class o extends Error{constructor(f){super(`CodeGen: "code" for ${f} not defined`),this.value=f.value}}var a;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(a=i.UsedValueState||(i.UsedValueState={})),i.varKinds={const:new s.Name("const"),let:new s.Name("let"),var:new s.Name("var")};class l{constructor({prefixes:f,parent:p}={}){this._names={},this._prefixes=f,this._parent=p}toName(f){return f instanceof s.Name?f:this.name(f)}name(f){return new s.Name(this._newName(f))}_newName(f){return`${f}${(this._names[f]||this._nameGroup(f)).index++}`}_nameGroup(f){var p,d;if(((d=(p=this._parent)===null||p===void 0?void 0:p._prefixes)===null||d===void 0?void 0:d.has(f))||this._prefixes&&!this._prefixes.has(f))throw new Error(`CodeGen: prefix "${f}" is not allowed in this scope`);return this._names[f]={prefix:f,index:0}}}i.Scope=l;class h extends s.Name{constructor(f,p){super(p),this.prefix=f}setValue(f,{property:p,itemIndex:d}){this.value=f,this.scopePath=s._`.${new s.Name(p)}[${d}]`}}i.ValueScopeName=h;const c=s._`\n`;i.ValueScope=class extends l{constructor(u){super(u),this._values={},this._scope=u.scope,this.opts={...u,_n:u.lines?c:s.nil}}get(){return this._scope}name(u){return new h(u,this._newName(u))}value(u,f){var p;if(f.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const d=this.toName(u),{prefix:g}=d,S=(p=f.key)!==null&&p!==void 0?p:f.ref;let m=this._values[g];if(m){const x=m.get(S);if(x)return x}else m=this._values[g]=new Map;m.set(S,d);const y=this._scope[g]||(this._scope[g]=[]),w=y.length;return y[w]=f.ref,d.setValue(f,{property:g,itemIndex:w}),d}getValue(u,f){const p=this._values[u];if(p)return p.get(f)}scopeRefs(u,f=this._values){return this._reduceValues(f,p=>{if(p.scopePath===void 0)throw new Error(`CodeGen: name "${p}" has no value`);return s._`${u}${p.scopePath}`})}scopeCode(u=this._values,f,p){return this._reduceValues(u,d=>{if(d.value===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return d.value.code},f,p)}_reduceValues(u,f,p={},d){let g=s.nil;for(const S in u){const m=u[S];if(!m)continue;const y=p[S]=p[S]||new Map;m.forEach(w=>{if(y.has(w))return;y.set(w,a.Started);let x=f(w);if(x)g=s._`${g}${this.opts.es5?i.varKinds.var:i.varKinds.const} ${w} = ${x};${this.opts._n}`;else{if(!(x=d==null?void 0:d(w)))throw new o(w);g=s._`${g}${x}${this.opts._n}`}y.set(w,a.Completed)})}return g}}},{"./code":1}],4:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.extendErrors=i.resetErrorsCount=i.reportExtraError=i.reportError=i.keyword$DataError=i.keywordError=void 0;const s=t("./codegen"),o=t("./util"),a=t("./names");function l(d,g){const S=d.const("err",g);d.if(s._`${a.default.vErrors} === null`,()=>d.assign(a.default.vErrors,s._`[${S}]`),s._`${a.default.vErrors}.push(${S})`),d.code(s._`${a.default.errors}++`)}function h(d,g){const{gen:S,validateName:m,schemaEnv:y}=d;y.$async?S.throw(s._`new ${d.ValidationError}(${g})`):(S.assign(s._`${m}.errors`,g),S.return(!1))}i.keywordError={message({keyword:d}){return s.str`must pass "${d}" keyword validation`}},i.keyword$DataError={message({keyword:d,schemaType:g}){return g?s.str`"${d}" keyword must be ${g} ($data)`:s.str`"${d}" keyword is invalid ($data)`}},i.reportError=function(d,g=i.keywordError,S,m){const{it:y}=d,{gen:w,compositeRule:x,allErrors:C}=y,T=u(d,g,S);(m!=null?m:x||C)?l(w,T):h(y,s._`[${T}]`)},i.reportExtraError=function(d,g=i.keywordError,S){const{it:m}=d,{gen:y,compositeRule:w,allErrors:x}=m;l(y,u(d,g,S)),w||x||h(m,a.default.vErrors)},i.resetErrorsCount=function(d,g){d.assign(a.default.errors,g),d.if(s._`${a.default.vErrors} !== null`,()=>d.if(g,()=>d.assign(s._`${a.default.vErrors}.length`,g),()=>d.assign(a.default.vErrors,null)))},i.extendErrors=function({gen:d,keyword:g,schemaValue:S,data:m,errsCount:y,it:w}){if(y===void 0)throw new Error("ajv implementation error");const x=d.name("err");d.forRange("i",y,a.default.errors,C=>{d.const(x,s._`${a.default.vErrors}[${C}]`),d.if(s._`${x}.instancePath === undefined`,()=>d.assign(s._`${x}.instancePath`,(0,s.strConcat)(a.default.instancePath,w.errorPath))),d.assign(s._`${x}.schemaPath`,s.str`${w.errSchemaPath}/${g}`),w.opts.verbose&&(d.assign(s._`${x}.schema`,S),d.assign(s._`${x}.data`,m))})};const c={keyword:new s.Name("keyword"),schemaPath:new s.Name("schemaPath"),params:new s.Name("params"),propertyName:new s.Name("propertyName"),message:new s.Name("message"),schema:new s.Name("schema"),parentSchema:new s.Name("parentSchema")};function u(d,g,S){const{createErrors:m}=d.it;return m===!1?s._`{}`:function(y,w,x={}){const{gen:C,it:T}=y,N=[f(T,x),p(y,x)];return function(z,{params:D,message:R},W){const{keyword:B,data:F,schemaValue:se,it:Y}=z,{opts:ie,propertyName:le,topSchemaRef:fe,schemaPath:K}=Y;W.push([c.keyword,B],[c.params,typeof D=="function"?D(z):D||s._`{}`]),ie.messages&&W.push([c.message,typeof R=="function"?R(z):R]),ie.verbose&&W.push([c.schema,se],[c.parentSchema,s._`${fe}${K}`],[a.default.data,F]),le&&W.push([c.propertyName,le])}(y,w,N),C.object(...N)}(d,g,S)}function f({errorPath:d},{instancePath:g}){const S=g?s.str`${d}${(0,o.getErrorPath)(g,o.Type.Str)}`:d;return[a.default.instancePath,(0,s.strConcat)(a.default.instancePath,S)]}function p({keyword:d,it:{errSchemaPath:g}},{schemaPath:S,parentSchema:m}){let y=m?g:s.str`${g}/${d}`;return S&&(y=s.str`${y}${(0,o.getErrorPath)(S,o.Type.Str)}`),[c.schemaPath,y]}},{"./codegen":2,"./names":6,"./util":10}],5:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.resolveSchema=i.getCompilingSchema=i.resolveRef=i.compileSchema=i.SchemaEnv=void 0;const s=t("./codegen"),o=t("../runtime/validation_error"),a=t("./names"),l=t("./resolve"),h=t("./util"),c=t("./validate");class u{constructor(x){var C;let T;this.refs={},this.dynamicAnchors={},typeof x.schema=="object"&&(T=x.schema),this.schema=x.schema,this.schemaId=x.schemaId,this.root=x.root||this,this.baseId=(C=x.baseId)!==null&&C!==void 0?C:(0,l.normalizeId)(T==null?void 0:T[x.schemaId||"$id"]),this.schemaPath=x.schemaPath,this.localRefs=x.localRefs,this.meta=x.meta,this.$async=T==null?void 0:T.$async,this.refs={}}}function f(w){const x=d.call(this,w);if(x)return x;const C=(0,l.getFullPath)(this.opts.uriResolver,w.root.baseId),{es5:T,lines:N}=this.opts.code,{ownProperties:z}=this.opts,D=new s.CodeGen(this.scope,{es5:T,lines:N,ownProperties:z});let R;w.$async&&(R=D.scopeValue("Error",{ref:o.default,code:s._`require("ajv/dist/runtime/validation_error").default`}));const W=D.scopeName("validate");w.validateName=W;const B={gen:D,allErrors:this.opts.allErrors,data:a.default.data,parentData:a.default.parentData,parentDataProperty:a.default.parentDataProperty,dataNames:[a.default.data],dataPathArr:[s.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:D.scopeValue("schema",this.opts.code.source===!0?{ref:w.schema,code:(0,s.stringify)(w.schema)}:{ref:w.schema}),validateName:W,ValidationError:R,schema:w.schema,schemaEnv:w,rootId:C,baseId:w.baseId||C,schemaPath:s.nil,errSchemaPath:w.schemaPath||(this.opts.jtd?"":"#"),errorPath:s._`""`,opts:this.opts,self:this};let F;try{this._compilations.add(w),(0,c.validateFunctionCode)(B),D.optimize(this.opts.code.optimize);const se=D.toString();F=`${D.scopeRefs(a.default.scope)}return ${se}`,this.opts.code.process&&(F=this.opts.code.process(F,w));const Y=new Function(`${a.default.self}`,`${a.default.scope}`,F)(this,this.scope.get());if(this.scope.value(W,{ref:Y}),Y.errors=null,Y.schema=w.schema,Y.schemaEnv=w,w.$async&&(Y.$async=!0),this.opts.code.source===!0&&(Y.source={validateName:W,validateCode:se,scopeValues:D._values}),this.opts.unevaluated){const{props:ie,items:le}=B;Y.evaluated={props:ie instanceof s.Name?void 0:ie,items:le instanceof s.Name?void 0:le,dynamicProps:ie instanceof s.Name,dynamicItems:le instanceof s.Name},Y.source&&(Y.source.evaluated=(0,s.stringify)(Y.evaluated))}return w.validate=Y,w}catch(se){throw delete w.validate,delete w.validateName,F&&this.logger.error("Error compiling schema, function code:",F),se}finally{this._compilations.delete(w)}}function p(w){return(0,l.inlineRef)(w.schema,this.opts.inlineRefs)?w.schema:w.validate?w:f.call(this,w)}function d(w){for(const T of this._compilations)if((x=T).schema===(C=w).schema&&x.root===C.root&&x.baseId===C.baseId)return T;var x,C}function g(w,x){let C;for(;typeof(C=this.refs[x])=="string";)x=C;return C||this.schemas[x]||S.call(this,w,x)}function S(w,x){const C=this.opts.uriResolver.parse(x),T=(0,l._getFullPath)(this.opts.uriResolver,C);let N=(0,l.getFullPath)(this.opts.uriResolver,w.baseId,void 0);if(Object.keys(w.schema).length>0&&T===N)return y.call(this,C,w);const z=(0,l.normalizeId)(T),D=this.refs[z]||this.schemas[z];if(typeof D=="string"){const R=S.call(this,w,D);return typeof(R==null?void 0:R.schema)!="object"?void 0:y.call(this,C,R)}if(typeof(D==null?void 0:D.schema)=="object"){if(D.validate||f.call(this,D),z===(0,l.normalizeId)(x)){const{schema:R}=D,{schemaId:W}=this.opts,B=R[W];return B&&(N=(0,l.resolveUrl)(this.opts.uriResolver,N,B)),new u({schema:R,schemaId:W,root:w,baseId:N})}return y.call(this,C,D)}}i.SchemaEnv=u,i.compileSchema=f,i.resolveRef=function(w,x,C){var T;C=(0,l.resolveUrl)(this.opts.uriResolver,x,C);const N=w.refs[C];if(N)return N;let z=g.call(this,w,C);if(z===void 0){const D=(T=w.localRefs)===null||T===void 0?void 0:T[C],{schemaId:R}=this.opts;D&&(z=new u({schema:D,schemaId:R,root:w,baseId:x}))}return z!==void 0?w.refs[C]=p.call(this,z):void 0},i.getCompilingSchema=d,i.resolveSchema=S;const m=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function y(w,{baseId:x,schema:C,root:T}){var N;if(((N=w.fragment)===null||N===void 0?void 0:N[0])!=="/")return;for(const R of w.fragment.slice(1).split("/")){if(typeof C=="boolean")return;const W=C[(0,h.unescapeFragment)(R)];if(W===void 0)return;const B=typeof(C=W)=="object"&&C[this.opts.schemaId];!m.has(R)&&B&&(x=(0,l.resolveUrl)(this.opts.uriResolver,x,B))}let z;if(typeof C!="boolean"&&C.$ref&&!(0,h.schemaHasRulesButRef)(C,this.RULES)){const R=(0,l.resolveUrl)(this.opts.uriResolver,x,C.$ref);z=S.call(this,T,R)}const{schemaId:D}=this.opts;return z=z||new u({schema:C,schemaId:D,root:T,baseId:x}),z.schema!==z.root.schema?z:void 0}},{"../runtime/validation_error":24,"./codegen":2,"./names":6,"./resolve":8,"./util":10,"./validate":15}],6:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./codegen"),o={data:new s.Name("data"),valCxt:new s.Name("valCxt"),instancePath:new s.Name("instancePath"),parentData:new s.Name("parentData"),parentDataProperty:new s.Name("parentDataProperty"),rootData:new s.Name("rootData"),dynamicAnchors:new s.Name("dynamicAnchors"),vErrors:new s.Name("vErrors"),errors:new s.Name("errors"),this:new s.Name("this"),self:new s.Name("self"),scope:new s.Name("scope"),json:new s.Name("json"),jsonPos:new s.Name("jsonPos"),jsonLen:new s.Name("jsonLen"),jsonPart:new s.Name("jsonPart")};i.default=o},{"./codegen":2}],7:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./resolve");class o extends Error{constructor(l,h,c,u){super(u||`can't resolve reference ${c} from id ${h}`),this.missingRef=(0,s.resolveUrl)(l,h,c),this.missingSchema=(0,s.normalizeId)((0,s.getFullPath)(l,this.missingRef))}}i.default=o},{"./resolve":8}],8:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getSchemaRefs=i.resolveUrl=i.normalizeId=i._getFullPath=i.getFullPath=i.inlineRef=void 0;const s=t("./util"),o=t("fast-deep-equal"),a=t("json-schema-traverse"),l=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);i.inlineRef=function(m,y=!0){return typeof m=="boolean"||(y===!0?!c(m):!!y&&u(m)<=y)};const h=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function c(m){for(const y in m){if(h.has(y))return!0;const w=m[y];if(Array.isArray(w)&&w.some(c)||typeof w=="object"&&c(w))return!0}return!1}function u(m){let y=0;for(const w in m)if(w==="$ref"||(y++,!l.has(w)&&(typeof m[w]=="object"&&(0,s.eachItem)(m[w],x=>y+=u(x)),y===1/0)))return 1/0;return y}function f(m,y="",w){w!==!1&&(y=g(y));const x=m.parse(y);return p(m,x)}function p(m,y){return m.serialize(y).split("#")[0]+"#"}i.getFullPath=f,i._getFullPath=p;const d=/#\/?$/;function g(m){return m?m.replace(d,""):""}i.normalizeId=g,i.resolveUrl=function(m,y,w){return w=g(w),m.resolve(y,w)};const S=/^[a-z_][-a-z0-9._]*$/i;i.getSchemaRefs=function(m,y){if(typeof m=="boolean")return{};const{schemaId:w,uriResolver:x}=this.opts,C=g(m[w]||y),T={"":C},N=f(x,C,!1),z={},D=new Set;return a(m,{allKeys:!0},(B,F,se,Y)=>{if(Y===void 0)return;const ie=N+F;let le=T[Y];function fe(I){if(I=g(le?(0,this.opts.uriResolver.resolve)(le,I):I),D.has(I))throw W(I);D.add(I);let G=this.refs[I];return typeof G=="string"&&(G=this.refs[G]),typeof G=="object"?R(B,G.schema,I):I!==g(ie)&&(I[0]==="#"?(R(B,z[I],I),z[I]=B):this.refs[I]=ie),I}function K(I){if(typeof I=="string"){if(!S.test(I))throw new Error(`invalid anchor "${I}"`);fe.call(this,`#${I}`)}}typeof B[w]=="string"&&(le=fe.call(this,B[w])),K.call(this,B.$anchor),K.call(this,B.$dynamicAnchor),T[F]=le}),z;function R(B,F,se){if(F!==void 0&&!o(B,F))throw W(se)}function W(B){return new Error(`reference "${B}" resolves to more than one schema`)}}},{"./util":10,"fast-deep-equal":63,"json-schema-traverse":64}],9:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getRules=i.isJSONType=void 0;const s=new Set(["string","number","integer","boolean","null","object","array"]);i.isJSONType=function(o){return typeof o=="string"&&s.has(o)},i.getRules=function(){const o={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...o,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},o.number,o.string,o.array,o.object],post:{rules:[]},all:{},keywords:{}}}},{}],10:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.checkStrictMode=i.getErrorPath=i.Type=i.useFunc=i.setEvaluated=i.evaluatedPropsToName=i.mergeEvaluated=i.eachItem=i.unescapeJsonPointer=i.escapeJsonPointer=i.escapeFragment=i.unescapeFragment=i.schemaRefOrVal=i.schemaHasRulesButRef=i.schemaHasRules=i.checkUnknownRules=i.alwaysValidSchema=i.toHash=void 0;const s=t("./codegen"),o=t("./codegen/code");function a(m,y=m.schema){const{opts:w,self:x}=m;if(!w.strictSchema||typeof y=="boolean")return;const C=x.RULES.keywords;for(const T in y)C[T]||S(m,`unknown keyword: "${T}"`)}function l(m,y){if(typeof m=="boolean")return!m;for(const w in m)if(y[w])return!0;return!1}function h(m){return typeof m=="number"?`${m}`:m.replace(/~/g,"~0").replace(/\//g,"~1")}function c(m){return m.replace(/~1/g,"/").replace(/~0/g,"~")}function u({mergeNames:m,mergeToName:y,mergeValues:w,resultToName:x}){return(C,T,N,z)=>{const D=N===void 0?T:N instanceof s.Name?(T instanceof s.Name?m(C,T,N):y(C,T,N),N):T instanceof s.Name?(y(C,N,T),T):w(T,N);return z!==s.Name||D instanceof s.Name?D:x(C,D)}}function f(m,y){if(y===!0)return m.var("props",!0);const w=m.var("props",s._`{}`);return y!==void 0&&p(m,w,y),w}function p(m,y,w){Object.keys(w).forEach(x=>m.assign(s._`${y}${(0,s.getProperty)(x)}`,!0))}i.toHash=function(m){const y={};for(const w of m)y[w]=!0;return y},i.alwaysValidSchema=function(m,y){return typeof y=="boolean"?y:Object.keys(y).length===0||(a(m,y),!l(y,m.self.RULES.all))},i.checkUnknownRules=a,i.schemaHasRules=l,i.schemaHasRulesButRef=function(m,y){if(typeof m=="boolean")return!m;for(const w in m)if(w!=="$ref"&&y.all[w])return!0;return!1},i.schemaRefOrVal=function({topSchemaRef:m,schemaPath:y},w,x,C){if(!C){if(typeof w=="number"||typeof w=="boolean")return w;if(typeof w=="string")return s._`${w}`}return s._`${m}${y}${(0,s.getProperty)(x)}`},i.unescapeFragment=function(m){return c(decodeURIComponent(m))},i.escapeFragment=function(m){return encodeURIComponent(h(m))},i.escapeJsonPointer=h,i.unescapeJsonPointer=c,i.eachItem=function(m,y){if(Array.isArray(m))for(const w of m)y(w);else y(m)},i.mergeEvaluated={props:u({mergeNames(m,y,w){return m.if(s._`${w} !== true && ${y} !== undefined`,()=>{m.if(s._`${y} === true`,()=>m.assign(w,!0),()=>m.assign(w,s._`${w} || {}`).code(s._`Object.assign(${w}, ${y})`))})},mergeToName(m,y,w){return m.if(s._`${w} !== true`,()=>{y===!0?m.assign(w,!0):(m.assign(w,s._`${w} || {}`),p(m,w,y))})},mergeValues(m,y){return m===!0||{...m,...y}},resultToName:f}),items:u({mergeNames(m,y,w){return m.if(s._`${w} !== true && ${y} !== undefined`,()=>m.assign(w,s._`${y} === true ? true : ${w} > ${y} ? ${w} : ${y}`))},mergeToName(m,y,w){return m.if(s._`${w} !== true`,()=>m.assign(w,y===!0||s._`${w} > ${y} ? ${w} : ${y}`))},mergeValues(m,y){return m===!0||Math.max(m,y)},resultToName(m,y){return m.var("items",y)}})},i.evaluatedPropsToName=f,i.setEvaluated=p;const d={};var g;function S(m,y,w=m.opts.strictSchema){if(w){if(y=`strict mode: ${y}`,w===!0)throw new Error(y);m.self.logger.warn(y)}}i.useFunc=function(m,y){return m.scopeValue("func",{ref:y,code:d[y.code]||(d[y.code]=new o._Code(y.code))})},function(m){m[m.Num=0]="Num",m[m.Str=1]="Str"}(g=i.Type||(i.Type={})),i.getErrorPath=function(m,y,w){if(m instanceof s.Name){const x=y===g.Num;return w?x?s._`"[" + ${m} + "]"`:s._`"['" + ${m} + "']"`:x?s._`"/" + ${m}`:s._`"/" + ${m}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return w?(0,s.getProperty)(m).toString():"/"+h(m)},i.checkStrictMode=S},{"./codegen":2,"./codegen/code":1}],11:[function(t,r,i){function s(a,l){return l.rules.some(h=>o(a,h))}function o(a,l){var h;return a[l.keyword]!==void 0||((h=l.definition.implements)===null||h===void 0?void 0:h.some(c=>a[c]!==void 0))}Object.defineProperty(i,"__esModule",{value:!0}),i.shouldUseRule=i.shouldUseGroup=i.schemaHasRulesForType=void 0,i.schemaHasRulesForType=function({schema:a,self:l},h){const c=l.RULES.types[h];return c&&c!==!0&&s(a,c)},i.shouldUseGroup=s,i.shouldUseRule=o},{}],12:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.boolOrEmptySchema=i.topBoolOrEmptySchema=void 0;const s=t("../errors"),o=t("../codegen"),a=t("../names"),l={message:"boolean schema is false"};function h(c,u){const{gen:f,data:p}=c;(0,s.reportError)({gen:f,keyword:"false schema",data:p,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:c},l,void 0,u)}i.topBoolOrEmptySchema=function(c){const{gen:u,schema:f,validateName:p}=c;f===!1?h(c,!1):typeof f=="object"&&f.$async===!0?u.return(a.default.data):(u.assign(o._`${p}.errors`,null),u.return(!0))},i.boolOrEmptySchema=function(c,u){const{gen:f,schema:p}=c;p===!1?(f.var(u,!1),h(c)):f.var(u,!0)}},{"../codegen":2,"../errors":4,"../names":6}],13:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.reportTypeError=i.checkDataTypes=i.checkDataType=i.coerceAndCheckDataType=i.getJSONTypes=i.getSchemaTypes=i.DataType=void 0;const s=t("../rules"),o=t("./applicability"),a=t("../errors"),l=t("../codegen"),h=t("../util");var c;function u(m){const y=Array.isArray(m)?m:m?[m]:[];if(y.every(s.isJSONType))return y;throw new Error("type must be JSONType or JSONType[]: "+y.join(","))}(function(m){m[m.Correct=0]="Correct",m[m.Wrong=1]="Wrong"})(c=i.DataType||(i.DataType={})),i.getSchemaTypes=function(m){const y=u(m.type);if(y.includes("null")){if(m.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!y.length&&m.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');m.nullable===!0&&y.push("null")}return y},i.getJSONTypes=u,i.coerceAndCheckDataType=function(m,y){const{gen:w,data:x,opts:C}=m,T=function(z,D){return D?z.filter(R=>f.has(R)||D==="array"&&R==="array"):[]}(y,C.coerceTypes),N=y.length>0&&!(T.length===0&&y.length===1&&(0,o.schemaHasRulesForType)(m,y[0]));if(N){const z=d(y,x,C.strictNumbers,c.Wrong);w.if(z,()=>{T.length?function(D,R,W){const{gen:B,data:F,opts:se}=D,Y=B.let("dataType",l._`typeof ${F}`),ie=B.let("coerced",l._`undefined`);se.coerceTypes==="array"&&B.if(l._`${Y} == 'object' && Array.isArray(${F}) && ${F}.length == 1`,()=>B.assign(F,l._`${F}[0]`).assign(Y,l._`typeof ${F}`).if(d(R,F,se.strictNumbers),()=>B.assign(ie,F))),B.if(l._`${ie} !== undefined`);for(const fe of W)(f.has(fe)||fe==="array"&&se.coerceTypes==="array")&&le(fe);function le(fe){switch(fe){case"string":return void B.elseIf(l._`${Y} == "number" || ${Y} == "boolean"`).assign(ie,l._`"" + ${F}`).elseIf(l._`${F} === null`).assign(ie,l._`""`);case"number":return void B.elseIf(l._`${Y} == "boolean" || ${F} === null
              || (${Y} == "string" && ${F} && ${F} == +${F})`).assign(ie,l._`+${F}`);case"integer":return void B.elseIf(l._`${Y} === "boolean" || ${F} === null
              || (${Y} === "string" && ${F} && ${F} == +${F} && !(${F} % 1))`).assign(ie,l._`+${F}`);case"boolean":return void B.elseIf(l._`${F} === "false" || ${F} === 0 || ${F} === null`).assign(ie,!1).elseIf(l._`${F} === "true" || ${F} === 1`).assign(ie,!0);case"null":return B.elseIf(l._`${F} === "" || ${F} === 0 || ${F} === false`),void B.assign(ie,null);case"array":B.elseIf(l._`${Y} === "string" || ${Y} === "number"
              || ${Y} === "boolean" || ${F} === null`).assign(ie,l._`[${F}]`)}}B.else(),S(D),B.endIf(),B.if(l._`${ie} !== undefined`,()=>{B.assign(F,ie),function({gen:fe,parentData:K,parentDataProperty:I},G){fe.if(l._`${K} !== undefined`,()=>fe.assign(l._`${K}[${I}]`,G))}(D,ie)})}(m,y,T):S(m)})}return N};const f=new Set(["string","number","integer","boolean","null"]);function p(m,y,w,x=c.Correct){const C=x===c.Correct?l.operators.EQ:l.operators.NEQ;let T;switch(m){case"null":return l._`${y} ${C} null`;case"array":T=l._`Array.isArray(${y})`;break;case"object":T=l._`${y} && typeof ${y} == "object" && !Array.isArray(${y})`;break;case"integer":T=N(l._`!(${y} % 1) && !isNaN(${y})`);break;case"number":T=N();break;default:return l._`typeof ${y} ${C} ${m}`}return x===c.Correct?T:(0,l.not)(T);function N(z=l.nil){return(0,l.and)(l._`typeof ${y} == "number"`,z,w?l._`isFinite(${y})`:l.nil)}}function d(m,y,w,x){if(m.length===1)return p(m[0],y,w,x);let C;const T=(0,h.toHash)(m);if(T.array&&T.object){const N=l._`typeof ${y} != "object"`;C=T.null?N:l._`!${y} || ${N}`,delete T.null,delete T.array,delete T.object}else C=l.nil;T.number&&delete T.integer;for(const N in T)C=(0,l.and)(C,p(N,y,w,x));return C}i.checkDataType=p,i.checkDataTypes=d;const g={message({schema:m}){return`must be ${m}`},params({schema:m,schemaValue:y}){return typeof m=="string"?l._`{type: ${m}}`:l._`{type: ${y}}`}};function S(m){const y=function(w){const{gen:x,data:C,schema:T}=w,N=(0,h.schemaRefOrVal)(w,T,"type");return{gen:x,keyword:"type",data:C,schema:T.type,schemaCode:N,schemaValue:N,parentSchema:T,params:{},it:w}}(m);(0,a.reportError)(y,g)}i.reportTypeError=S},{"../codegen":2,"../errors":4,"../rules":9,"../util":10,"./applicability":11}],14:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.assignDefaults=void 0;const s=t("../codegen"),o=t("../util");function a(l,h,c){const{gen:u,compositeRule:f,data:p,opts:d}=l;if(c===void 0)return;const g=s._`${p}${(0,s.getProperty)(h)}`;if(f)return void(0,o.checkStrictMode)(l,`default is ignored for: ${g}`);let S=s._`${g} === undefined`;d.useDefaults==="empty"&&(S=s._`${S} || ${g} === null || ${g} === ""`),u.if(S,s._`${g} = ${(0,s.stringify)(c)}`)}i.assignDefaults=function(l,h){const{properties:c,items:u}=l.schema;if(h==="object"&&c)for(const f in c)a(l,f,c[f].default);else h==="array"&&Array.isArray(u)&&u.forEach((f,p)=>a(l,p,f.default))}},{"../codegen":2,"../util":10}],15:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getData=i.KeywordCxt=i.validateFunctionCode=void 0;const s=t("./boolSchema"),o=t("./dataType"),a=t("./applicability"),l=t("./dataType"),h=t("./defaults"),c=t("./keyword"),u=t("./subschema"),f=t("../codegen"),p=t("../names"),d=t("../resolve"),g=t("../util"),S=t("../errors");function m({gen:K,validateName:I,schema:G,schemaEnv:L,opts:$},_){$.code.es5?K.func(I,f._`${p.default.data}, ${p.default.valCxt}`,L.$async,()=>{K.code(f._`"use strict"; ${y(G,$)}`),function(v,P){v.if(p.default.valCxt,()=>{v.var(p.default.instancePath,f._`${p.default.valCxt}.${p.default.instancePath}`),v.var(p.default.parentData,f._`${p.default.valCxt}.${p.default.parentData}`),v.var(p.default.parentDataProperty,f._`${p.default.valCxt}.${p.default.parentDataProperty}`),v.var(p.default.rootData,f._`${p.default.valCxt}.${p.default.rootData}`),P.dynamicRef&&v.var(p.default.dynamicAnchors,f._`${p.default.valCxt}.${p.default.dynamicAnchors}`)},()=>{v.var(p.default.instancePath,f._`""`),v.var(p.default.parentData,f._`undefined`),v.var(p.default.parentDataProperty,f._`undefined`),v.var(p.default.rootData,p.default.data),P.dynamicRef&&v.var(p.default.dynamicAnchors,f._`{}`)})}(K,$),K.code(_)}):K.func(I,f._`${p.default.data}, ${function(v){return f._`{${p.default.instancePath}="", ${p.default.parentData}, ${p.default.parentDataProperty}, ${p.default.rootData}=${p.default.data}${v.dynamicRef?f._`, ${p.default.dynamicAnchors}={}`:f.nil}}={}`}($)}`,L.$async,()=>K.code(y(G,$)).code(_))}function y(K,I){const G=typeof K=="object"&&K[I.schemaId];return G&&(I.code.source||I.code.process)?f._`/*# sourceURL=${G} */`:f.nil}function w(K,I){C(K)&&(T(K),x(K))?function(G,L){const{schema:$,gen:_,opts:v}=G;v.$comment&&$.$comment&&z(G),function(V){const J=V.schema[V.opts.schemaId];J&&(V.baseId=(0,d.resolveUrl)(V.opts.uriResolver,V.baseId,J))}(G),function(V){if(V.schema.$async&&!V.schemaEnv.$async)throw new Error("async schema in sync schema")}(G);const P=_.const("_errs",p.default.errors);N(G,P),_.var(L,f._`${P} === ${p.default.errors}`)}(K,I):(0,s.boolOrEmptySchema)(K,I)}function x({schema:K,self:I}){if(typeof K=="boolean")return!K;for(const G in K)if(I.RULES.all[G])return!0;return!1}function C(K){return typeof K.schema!="boolean"}function T(K){(0,g.checkUnknownRules)(K),function(I){const{schema:G,errSchemaPath:L,opts:$,self:_}=I;G.$ref&&$.ignoreKeywordsWithRef&&(0,g.schemaHasRulesButRef)(G,_.RULES)&&_.logger.warn(`$ref: keywords ignored in schema at path "${L}"`)}(K)}function N(K,I){if(K.opts.jtd)return D(K,[],!1,I);const G=(0,o.getSchemaTypes)(K.schema);D(K,G,!(0,o.coerceAndCheckDataType)(K,G),I)}function z({gen:K,schemaEnv:I,schema:G,errSchemaPath:L,opts:$}){const _=G.$comment;if($.$comment===!0)K.code(f._`${p.default.self}.logger.log(${_})`);else if(typeof $.$comment=="function"){const v=f.str`${L}/$comment`,P=K.scopeValue("root",{ref:I.root});K.code(f._`${p.default.self}.opts.$comment(${_}, ${v}, ${P}.schema)`)}}function D(K,I,G,L){const{gen:$,schema:_,data:v,allErrors:P,opts:V,self:J}=K,{RULES:ne}=J;function ce(ye){(0,a.shouldUseGroup)(_,ye)&&(ye.type?($.if((0,l.checkDataType)(ye.type,v,V.strictNumbers)),R(K,ye),I.length===1&&I[0]===ye.type&&G&&($.else(),(0,l.reportTypeError)(K)),$.endIf()):R(K,ye),P||$.if(f._`${p.default.errors} === ${L||0}`))}!_.$ref||!V.ignoreKeywordsWithRef&&(0,g.schemaHasRulesButRef)(_,ne)?(V.jtd||function(ye,we){ye.schemaEnv.meta||!ye.opts.strictTypes||(function(me,Re){if(!!Re.length){if(!me.dataTypes.length)return void(me.dataTypes=Re);Re.forEach(et=>{B(me.dataTypes,et)||F(me,`type "${et}" not allowed by context "${me.dataTypes.join(",")}"`)}),me.dataTypes=me.dataTypes.filter(et=>B(Re,et))}}(ye,we),ye.opts.allowUnionTypes||function(me,Re){Re.length>1&&(Re.length!==2||!Re.includes("null"))&&F(me,"use allowUnionTypes to allow union type keyword")}(ye,we),function(me,Re){const et=me.self.RULES.all;for(const vt in et){const at=et[vt];if(typeof at=="object"&&(0,a.shouldUseRule)(me.schema,at)){const{type:ut}=at.definition;ut.length&&!ut.some(ue=>W(Re,ue))&&F(me,`missing type "${ut.join(",")}" for keyword "${vt}"`)}}}(ye,ye.dataTypes))}(K,I),$.block(()=>{for(const ye of ne.rules)ce(ye);ce(ne.post)})):$.block(()=>Y(K,"$ref",ne.all.$ref.definition))}function R(K,I){const{gen:G,schema:L,opts:{useDefaults:$}}=K;$&&(0,h.assignDefaults)(K,I.type),G.block(()=>{for(const _ of I.rules)(0,a.shouldUseRule)(L,_)&&Y(K,_.keyword,_.definition,I.type)})}function W(K,I){return K.includes(I)||I==="number"&&K.includes("integer")}function B(K,I){return K.includes(I)||I==="integer"&&K.includes("number")}function F(K,I){(0,g.checkStrictMode)(K,I+=` at "${K.schemaEnv.baseId+K.errSchemaPath}" (strictTypes)`,K.opts.strictTypes)}i.validateFunctionCode=function(K){C(K)&&(T(K),x(K))?function(I){const{schema:G,opts:L,gen:$}=I;m(I,()=>{L.$comment&&G.$comment&&z(I),function(_){const{schema:v,opts:P}=_;v.default!==void 0&&P.useDefaults&&P.strictSchema&&(0,g.checkStrictMode)(_,"default is ignored in the schema root")}(I),$.let(p.default.vErrors,null),$.let(p.default.errors,0),L.unevaluated&&function(_){const{gen:v,validateName:P}=_;_.evaluated=v.const("evaluated",f._`${P}.evaluated`),v.if(f._`${_.evaluated}.dynamicProps`,()=>v.assign(f._`${_.evaluated}.props`,f._`undefined`)),v.if(f._`${_.evaluated}.dynamicItems`,()=>v.assign(f._`${_.evaluated}.items`,f._`undefined`))}(I),N(I),function(_){const{gen:v,schemaEnv:P,validateName:V,ValidationError:J,opts:ne}=_;P.$async?v.if(f._`${p.default.errors} === 0`,()=>v.return(p.default.data),()=>v.throw(f._`new ${J}(${p.default.vErrors})`)):(v.assign(f._`${V}.errors`,p.default.vErrors),ne.unevaluated&&function({gen:ce,evaluated:ye,props:we,items:me}){we instanceof f.Name&&ce.assign(f._`${ye}.props`,we),me instanceof f.Name&&ce.assign(f._`${ye}.items`,me)}(_),v.return(f._`${p.default.errors} === 0`))}(I)})}(K):m(K,()=>(0,s.topBoolOrEmptySchema)(K))};class se{constructor(I,G,L){if((0,c.validateKeywordUsage)(I,G,L),this.gen=I.gen,this.allErrors=I.allErrors,this.keyword=L,this.data=I.data,this.schema=I.schema[L],this.$data=G.$data&&I.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,g.schemaRefOrVal)(I,this.schema,L,this.$data),this.schemaType=G.schemaType,this.parentSchema=I.schema,this.params={},this.it=I,this.def=G,this.$data)this.schemaCode=I.gen.const("vSchema",fe(this.$data,I));else if(this.schemaCode=this.schemaValue,!(0,c.validSchemaType)(this.schema,G.schemaType,G.allowUndefined))throw new Error(`${L} value must be ${JSON.stringify(G.schemaType)}`);("code"in G?G.trackErrors:G.errors!==!1)&&(this.errsCount=I.gen.const("_errs",p.default.errors))}result(I,G,L){this.failResult((0,f.not)(I),G,L)}failResult(I,G,L){this.gen.if(I),L?L():this.error(),G?(this.gen.else(),G(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(I,G){this.failResult((0,f.not)(I),void 0,G)}fail(I){if(I===void 0)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(I),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(I){if(!this.$data)return this.fail(I);const{schemaCode:G}=this;this.fail(f._`${G} !== undefined && (${(0,f.or)(this.invalid$data(),I)})`)}error(I,G,L){if(G)return this.setParams(G),this._error(I,L),void this.setParams({});this._error(I,L)}_error(I,G){(I?S.reportExtraError:S.reportError)(this,this.def.error,G)}$dataError(){(0,S.reportError)(this,this.def.$dataError||S.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,S.resetErrorsCount)(this.gen,this.errsCount)}ok(I){this.allErrors||this.gen.if(I)}setParams(I,G){G?Object.assign(this.params,I):this.params=I}block$data(I,G,L=f.nil){this.gen.block(()=>{this.check$data(I,L),G()})}check$data(I=f.nil,G=f.nil){if(!this.$data)return;const{gen:L,schemaCode:$,schemaType:_,def:v}=this;L.if((0,f.or)(f._`${$} === undefined`,G)),I!==f.nil&&L.assign(I,!0),(_.length||v.validateSchema)&&(L.elseIf(this.invalid$data()),this.$dataError(),I!==f.nil&&L.assign(I,!1)),L.else()}invalid$data(){const{gen:I,schemaCode:G,schemaType:L,def:$,it:_}=this;return(0,f.or)(function(){if(L.length){if(!(G instanceof f.Name))throw new Error("ajv implementation error");const v=Array.isArray(L)?L:[L];return f._`${(0,l.checkDataTypes)(v,G,_.opts.strictNumbers,l.DataType.Wrong)}`}return f.nil}(),function(){if($.validateSchema){const v=I.scopeValue("validate$data",{ref:$.validateSchema});return f._`!${v}(${G})`}return f.nil}())}subschema(I,G){const L=(0,u.getSubschema)(this.it,I);(0,u.extendSubschemaData)(L,this.it,I),(0,u.extendSubschemaMode)(L,I);const $={...this.it,...L,items:void 0,props:void 0};return w($,G),$}mergeEvaluated(I,G){const{it:L,gen:$}=this;L.opts.unevaluated&&(L.props!==!0&&I.props!==void 0&&(L.props=g.mergeEvaluated.props($,I.props,L.props,G)),L.items!==!0&&I.items!==void 0&&(L.items=g.mergeEvaluated.items($,I.items,L.items,G)))}mergeValidEvaluated(I,G){const{it:L,gen:$}=this;if(L.opts.unevaluated&&(L.props!==!0||L.items!==!0))return $.if(G,()=>this.mergeEvaluated(I,f.Name)),!0}}function Y(K,I,G,L){const $=new se(K,G,I);"code"in G?G.code($,L):$.$data&&G.validate?(0,c.funcKeywordCode)($,G):"macro"in G?(0,c.macroKeywordCode)($,G):(G.compile||G.validate)&&(0,c.funcKeywordCode)($,G)}i.KeywordCxt=se;const ie=/^\/(?:[^~]|~0|~1)*$/,le=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function fe(K,{dataLevel:I,dataNames:G,dataPathArr:L}){let $,_;if(K==="")return p.default.rootData;if(K[0]==="/"){if(!ie.test(K))throw new Error(`Invalid JSON-pointer: ${K}`);$=K,_=p.default.rootData}else{const J=le.exec(K);if(!J)throw new Error(`Invalid JSON-pointer: ${K}`);const ne=+J[1];if($=J[2],$==="#"){if(ne>=I)throw new Error(V("property/index",ne));return L[I-ne]}if(ne>I)throw new Error(V("data",ne));if(_=G[I-ne],!$)return _}let v=_;const P=$.split("/");for(const J of P)J&&(_=f._`${_}${(0,f.getProperty)((0,g.unescapeJsonPointer)(J))}`,v=f._`${v} && ${_}`);return v;function V(J,ne){return`Cannot access ${J} ${ne} levels up, current level is ${I}`}}i.getData=fe},{"../codegen":2,"../errors":4,"../names":6,"../resolve":8,"../util":10,"./applicability":11,"./boolSchema":12,"./dataType":13,"./defaults":14,"./keyword":16,"./subschema":17}],16:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.validateKeywordUsage=i.validSchemaType=i.funcKeywordCode=i.macroKeywordCode=void 0;const s=t("../codegen"),o=t("../names"),a=t("../../vocabularies/code"),l=t("../errors");function h(u){const{gen:f,data:p,it:d}=u;f.if(d.parentData,()=>f.assign(p,s._`${d.parentData}[${d.parentDataProperty}]`))}function c(u,f,p){if(p===void 0)throw new Error(`keyword "${f}" failed to compile`);return u.scopeValue("keyword",typeof p=="function"?{ref:p}:{ref:p,code:(0,s.stringify)(p)})}i.macroKeywordCode=function(u,f){const{gen:p,keyword:d,schema:g,parentSchema:S,it:m}=u,y=f.macro.call(m.self,g,S,m),w=c(p,d,y);m.opts.validateSchema!==!1&&m.self.validateSchema(y,!0);const x=p.name("valid");u.subschema({schema:y,schemaPath:s.nil,errSchemaPath:`${m.errSchemaPath}/${d}`,topSchemaRef:w,compositeRule:!0},x),u.pass(x,()=>u.error(!0))},i.funcKeywordCode=function(u,f){var p;const{gen:d,keyword:g,schema:S,parentSchema:m,$data:y,it:w}=u;(function({schemaEnv:D},R){if(R.async&&!D.$async)throw new Error("async keyword in sync schema")})(w,f);const x=!y&&f.compile?f.compile.call(w.self,S,m,w):f.validate,C=c(d,g,x),T=d.let("valid");function N(D=f.async?s._`await `:s.nil){d.assign(T,s._`${D}${(0,a.callValidateCode)(u,C,w.opts.passContext?o.default.this:o.default.self,!("compile"in f&&!y||f.schema===!1))}`,f.modifying)}function z(D){var R;d.if((0,s.not)((R=f.valid)!==null&&R!==void 0?R:T),D)}u.block$data(T,function(){if(f.errors===!1)N(),f.modifying&&h(u),z(()=>u.error());else{const D=f.async?function(){const R=d.let("ruleErrs",null);return d.try(()=>N(s._`await `),W=>d.assign(T,!1).if(s._`${W} instanceof ${w.ValidationError}`,()=>d.assign(R,s._`${W}.errors`),()=>d.throw(W))),R}():function(){const R=s._`${C}.errors`;return d.assign(R,null),N(s.nil),R}();f.modifying&&h(u),z(()=>function(R,W){const{gen:B}=R;B.if(s._`Array.isArray(${W})`,()=>{B.assign(o.default.vErrors,s._`${o.default.vErrors} === null ? ${W} : ${o.default.vErrors}.concat(${W})`).assign(o.default.errors,s._`${o.default.vErrors}.length`),(0,l.extendErrors)(R)},()=>R.error())}(u,D))}}),u.ok((p=f.valid)!==null&&p!==void 0?p:T)},i.validSchemaType=function(u,f,p=!1){return!f.length||f.some(d=>d==="array"?Array.isArray(u):d==="object"?u&&typeof u=="object"&&!Array.isArray(u):typeof u==d||p&&u===void 0)},i.validateKeywordUsage=function({schema:u,opts:f,self:p,errSchemaPath:d},g,S){if(Array.isArray(g.keyword)?!g.keyword.includes(S):g.keyword!==S)throw new Error("ajv implementation error");const m=g.dependencies;if(m!=null&&m.some(y=>!Object.prototype.hasOwnProperty.call(u,y)))throw new Error(`parent schema must have dependencies of ${S}: ${m.join(",")}`);if(g.validateSchema&&!g.validateSchema(u[S])){const y=`keyword "${S}" value is invalid at path "${d}": `+p.errorsText(g.validateSchema.errors);if(f.validateSchema!=="log")throw new Error(y);p.logger.error(y)}}},{"../../vocabularies/code":42,"../codegen":2,"../errors":4,"../names":6}],17:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.extendSubschemaMode=i.extendSubschemaData=i.getSubschema=void 0;const s=t("../codegen"),o=t("../util");i.getSubschema=function(a,{keyword:l,schemaProp:h,schema:c,schemaPath:u,errSchemaPath:f,topSchemaRef:p}){if(l!==void 0&&c!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(l!==void 0){const d=a.schema[l];return h===void 0?{schema:d,schemaPath:s._`${a.schemaPath}${(0,s.getProperty)(l)}`,errSchemaPath:`${a.errSchemaPath}/${l}`}:{schema:d[h],schemaPath:s._`${a.schemaPath}${(0,s.getProperty)(l)}${(0,s.getProperty)(h)}`,errSchemaPath:`${a.errSchemaPath}/${l}/${(0,o.escapeFragment)(h)}`}}if(c!==void 0){if(u===void 0||f===void 0||p===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:c,schemaPath:u,topSchemaRef:p,errSchemaPath:f}}throw new Error('either "keyword" or "schema" must be passed')},i.extendSubschemaData=function(a,l,{dataProp:h,dataPropType:c,data:u,dataTypes:f,propertyName:p}){if(u!==void 0&&h!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:d}=l;if(h!==void 0){const{errorPath:S,dataPathArr:m,opts:y}=l;g(d.let("data",s._`${l.data}${(0,s.getProperty)(h)}`,!0)),a.errorPath=s.str`${S}${(0,o.getErrorPath)(h,c,y.jsPropertySyntax)}`,a.parentDataProperty=s._`${h}`,a.dataPathArr=[...m,a.parentDataProperty]}u!==void 0&&(g(u instanceof s.Name?u:d.let("data",u,!0)),p!==void 0&&(a.propertyName=p));function g(S){a.data=S,a.dataLevel=l.dataLevel+1,a.dataTypes=[],l.definedProperties=new Set,a.parentData=l.data,a.dataNames=[...l.dataNames,S]}f&&(a.dataTypes=f)},i.extendSubschemaMode=function(a,{jtdDiscriminator:l,jtdMetadata:h,compositeRule:c,createErrors:u,allErrors:f}){c!==void 0&&(a.compositeRule=c),u!==void 0&&(a.createErrors=u),f!==void 0&&(a.allErrors=f),a.jtdDiscriminator=l,a.jtdMetadata=h}},{"../codegen":2,"../util":10}],18:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CodeGen=i.Name=i.nil=i.stringify=i.str=i._=i.KeywordCxt=void 0;var s=t("./compile/validate");Object.defineProperty(i,"KeywordCxt",{enumerable:!0,get(){return s.KeywordCxt}});var o=t("./compile/codegen");Object.defineProperty(i,"_",{enumerable:!0,get(){return o._}}),Object.defineProperty(i,"str",{enumerable:!0,get(){return o.str}}),Object.defineProperty(i,"stringify",{enumerable:!0,get(){return o.stringify}}),Object.defineProperty(i,"nil",{enumerable:!0,get(){return o.nil}}),Object.defineProperty(i,"Name",{enumerable:!0,get(){return o.Name}}),Object.defineProperty(i,"CodeGen",{enumerable:!0,get(){return o.CodeGen}});const a=t("./runtime/validation_error"),l=t("./compile/ref_error"),h=t("./compile/rules"),c=t("./compile"),u=t("./compile/codegen"),f=t("./compile/resolve"),p=t("./compile/validate/dataType"),d=t("./compile/util"),g=t("./refs/data.json"),S=t("./runtime/uri"),m=(L,$)=>new RegExp(L,$);m.code="new RegExp";const y=["removeAdditional","useDefaults","coerceTypes"],w=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),x={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},C={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function T(L){var $,_,v,P,V,J,ne,ce,ye,we,me,Re,et,vt,at,ut,ue,xt,lt,Ht,ni,si,wt,b,O;const M=L.strict,j=($=L.code)===null||$===void 0?void 0:$.optimize,U=j===!0||j===void 0?1:j||0,re=(v=(_=L.code)===null||_===void 0?void 0:_.regExp)!==null&&v!==void 0?v:m,ge=(P=L.uriResolver)!==null&&P!==void 0?P:S.default;return{strictSchema:(J=(V=L.strictSchema)!==null&&V!==void 0?V:M)===null||J===void 0||J,strictNumbers:(ce=(ne=L.strictNumbers)!==null&&ne!==void 0?ne:M)===null||ce===void 0||ce,strictTypes:(we=(ye=L.strictTypes)!==null&&ye!==void 0?ye:M)!==null&&we!==void 0?we:"log",strictTuples:(Re=(me=L.strictTuples)!==null&&me!==void 0?me:M)!==null&&Re!==void 0?Re:"log",strictRequired:(vt=(et=L.strictRequired)!==null&&et!==void 0?et:M)!==null&&vt!==void 0&&vt,code:L.code?{...L.code,optimize:U,regExp:re}:{optimize:U,regExp:re},loopRequired:(at=L.loopRequired)!==null&&at!==void 0?at:200,loopEnum:(ut=L.loopEnum)!==null&&ut!==void 0?ut:200,meta:(ue=L.meta)===null||ue===void 0||ue,messages:(xt=L.messages)===null||xt===void 0||xt,inlineRefs:(lt=L.inlineRefs)===null||lt===void 0||lt,schemaId:(Ht=L.schemaId)!==null&&Ht!==void 0?Ht:"$id",addUsedSchema:(ni=L.addUsedSchema)===null||ni===void 0||ni,validateSchema:(si=L.validateSchema)===null||si===void 0||si,validateFormats:(wt=L.validateFormats)===null||wt===void 0||wt,unicodeRegExp:(b=L.unicodeRegExp)===null||b===void 0||b,int32range:(O=L.int32range)===null||O===void 0||O,uriResolver:ge}}class N{constructor($={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,$=this.opts={...$,...T($)};const{es5:_,lines:v}=this.opts.code;this.scope=new u.ValueScope({scope:{},prefixes:w,es5:_,lines:v}),this.logger=function(V){if(V===!1)return se;if(V===void 0)return console;if(V.log&&V.warn&&V.error)return V;throw new Error("logger must implement log, warn and error methods")}($.logger);const P=$.validateFormats;$.validateFormats=!1,this.RULES=(0,h.getRules)(),z.call(this,x,$,"NOT SUPPORTED"),z.call(this,C,$,"DEPRECATED","warn"),this._metaOpts=F.call(this),$.formats&&W.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),$.keywords&&B.call(this,$.keywords),typeof $.meta=="object"&&this.addMetaSchema($.meta),R.call(this),$.validateFormats=P}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$,meta:_,schemaId:v}=this.opts;let P=g;v==="id"&&(P={...g},P.id=P.$id,delete P.$id),_&&$&&this.addMetaSchema(P,P[v],!1)}defaultMeta(){const{meta:$,schemaId:_}=this.opts;return this.opts.defaultMeta=typeof $=="object"?$[_]||$:void 0}validate($,_){let v;if(typeof $=="string"){if(v=this.getSchema($),!v)throw new Error(`no schema with key or ref "${$}"`)}else v=this.compile($);const P=v(_);return"$async"in v||(this.errors=v.errors),P}compile($,_){const v=this._addSchema($,_);return v.validate||this._compileSchemaEnv(v)}compileAsync($,_){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:v}=this.opts;return P.call(this,$,_);async function P(we,me){await V.call(this,we.$schema);const Re=this._addSchema(we,me);return Re.validate||J.call(this,Re)}async function V(we){we&&!this.getSchema(we)&&await P.call(this,{$ref:we},!0)}async function J(we){try{return this._compileSchemaEnv(we)}catch(me){if(!(me instanceof l.default))throw me;return ne.call(this,me),await ce.call(this,me.missingSchema),J.call(this,we)}}function ne({missingSchema:we,missingRef:me}){if(this.refs[we])throw new Error(`AnySchema ${we} is loaded but ${me} cannot be resolved`)}async function ce(we){const me=await ye.call(this,we);this.refs[we]||await V.call(this,me.$schema),this.refs[we]||this.addSchema(me,we,_)}async function ye(we){const me=this._loading[we];if(me)return me;try{return await(this._loading[we]=v(we))}finally{delete this._loading[we]}}}addSchema($,_,v,P=this.opts.validateSchema){if(Array.isArray($)){for(const J of $)this.addSchema(J,void 0,v,P);return this}let V;if(typeof $=="object"){const{schemaId:J}=this.opts;if(V=$[J],V!==void 0&&typeof V!="string")throw new Error(`schema ${J} must be string`)}return _=(0,f.normalizeId)(_||V),this._checkUnique(_),this.schemas[_]=this._addSchema($,v,_,P,!0),this}addMetaSchema($,_,v=this.opts.validateSchema){return this.addSchema($,_,!0,v),this}validateSchema($,_){if(typeof $=="boolean")return!0;let v;if(v=$.$schema,v!==void 0&&typeof v!="string")throw new Error("$schema must be a string");if(v=v||this.opts.defaultMeta||this.defaultMeta(),!v)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const P=this.validate(v,$);if(!P&&_){const V="schema is invalid: "+this.errorsText();if(this.opts.validateSchema!=="log")throw new Error(V);this.logger.error(V)}return P}getSchema($){let _;for(;typeof(_=D.call(this,$))=="string";)$=_;if(_===void 0){const{schemaId:v}=this.opts,P=new c.SchemaEnv({schema:{},schemaId:v});if(_=c.resolveSchema.call(this,P,$),!_)return;this.refs[$]=_}return _.validate||this._compileSchemaEnv(_)}removeSchema($){if($ instanceof RegExp)return this._removeAllSchemas(this.schemas,$),this._removeAllSchemas(this.refs,$),this;switch(typeof $){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const _=D.call(this,$);return typeof _=="object"&&this._cache.delete(_.schema),delete this.schemas[$],delete this.refs[$],this}case"object":{this._cache.delete($);let _=$[this.opts.schemaId];return _&&(_=(0,f.normalizeId)(_),delete this.schemas[_],delete this.refs[_]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary($){for(const _ of $)this.addKeyword(_);return this}addKeyword($,_){let v;if(typeof $=="string")v=$,typeof _=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),_.keyword=v);else{if(typeof $!="object"||_!==void 0)throw new Error("invalid addKeywords parameters");if(v=(_=$).keyword,Array.isArray(v)&&!v.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(ie.call(this,v,_),!_)return(0,d.eachItem)(v,V=>le.call(this,V)),this;K.call(this,_);const P={..._,type:(0,p.getJSONTypes)(_.type),schemaType:(0,p.getJSONTypes)(_.schemaType)};return(0,d.eachItem)(v,P.type.length===0?V=>le.call(this,V,P):V=>P.type.forEach(J=>le.call(this,V,P,J))),this}getKeyword($){const _=this.RULES.all[$];return typeof _=="object"?_.definition:!!_}removeKeyword($){const{RULES:_}=this;delete _.keywords[$],delete _.all[$];for(const v of _.rules){const P=v.rules.findIndex(V=>V.keyword===$);P>=0&&v.rules.splice(P,1)}return this}addFormat($,_){return typeof _=="string"&&(_=new RegExp(_)),this.formats[$]=_,this}errorsText($=this.errors,{separator:_=", ",dataVar:v="data"}={}){return $&&$.length!==0?$.map(P=>`${v}${P.instancePath} ${P.message}`).reduce((P,V)=>P+_+V):"No errors"}$dataMetaSchema($,_){const v=this.RULES.all;$=JSON.parse(JSON.stringify($));for(const P of _){const V=P.split("/").slice(1);let J=$;for(const ne of V)J=J[ne];for(const ne in v){const ce=v[ne];if(typeof ce!="object")continue;const{$data:ye}=ce.definition,we=J[ne];ye&&we&&(J[ne]=G(we))}}return $}_removeAllSchemas($,_){for(const v in $){const P=$[v];_&&!_.test(v)||(typeof P=="string"?delete $[v]:P&&!P.meta&&(this._cache.delete(P.schema),delete $[v]))}}_addSchema($,_,v,P=this.opts.validateSchema,V=this.opts.addUsedSchema){let J;const{schemaId:ne}=this.opts;if(typeof $=="object")J=$[ne];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof $!="boolean")throw new Error("schema must be object or boolean")}let ce=this._cache.get($);if(ce!==void 0)return ce;v=(0,f.normalizeId)(J||v);const ye=f.getSchemaRefs.call(this,$,v);return ce=new c.SchemaEnv({schema:$,schemaId:ne,meta:_,baseId:v,localRefs:ye}),this._cache.set(ce.schema,ce),V&&!v.startsWith("#")&&(v&&this._checkUnique(v),this.refs[v]=ce),P&&this.validateSchema($,!0),ce}_checkUnique($){if(this.schemas[$]||this.refs[$])throw new Error(`schema with key or id "${$}" already exists`)}_compileSchemaEnv($){if($.meta?this._compileMetaSchema($):c.compileSchema.call(this,$),!$.validate)throw new Error("ajv implementation error");return $.validate}_compileMetaSchema($){const _=this.opts;this.opts=this._metaOpts;try{c.compileSchema.call(this,$)}finally{this.opts=_}}}function z(L,$,_,v="error"){for(const P in L){const V=P;V in $&&this.logger[v](`${_}: option ${P}. ${L[V]}`)}}function D(L){return L=(0,f.normalizeId)(L),this.schemas[L]||this.refs[L]}function R(){const L=this.opts.schemas;if(L)if(Array.isArray(L))this.addSchema(L);else for(const $ in L)this.addSchema(L[$],$)}function W(){for(const L in this.opts.formats){const $=this.opts.formats[L];$&&this.addFormat(L,$)}}function B(L){if(Array.isArray(L))this.addVocabulary(L);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const $ in L){const _=L[$];_.keyword||(_.keyword=$),this.addKeyword(_)}}}function F(){const L={...this.opts};for(const $ of y)delete L[$];return L}i.default=N,N.ValidationError=a.default,N.MissingRefError=l.default;const se={log(){},warn(){},error(){}},Y=/^[a-z_$][a-z0-9_$:-]*$/i;function ie(L,$){const{RULES:_}=this;if((0,d.eachItem)(L,v=>{if(_.keywords[v])throw new Error(`Keyword ${v} is already defined`);if(!Y.test(v))throw new Error(`Keyword ${v} has invalid name`)}),$&&$.$data&&!("code"in $)&&!("validate"in $))throw new Error('$data keyword must have "code" or "validate" function')}function le(L,$,_){var v;const P=$==null?void 0:$.post;if(_&&P)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:V}=this;let J=P?V.post:V.rules.find(({type:ce})=>ce===_);if(J||(J={type:_,rules:[]},V.rules.push(J)),V.keywords[L]=!0,!$)return;const ne={keyword:L,definition:{...$,type:(0,p.getJSONTypes)($.type),schemaType:(0,p.getJSONTypes)($.schemaType)}};$.before?fe.call(this,J,ne,$.before):J.rules.push(ne),V.all[L]=ne,(v=$.implements)===null||v===void 0||v.forEach(ce=>this.addKeyword(ce))}function fe(L,$,_){const v=L.rules.findIndex(P=>P.keyword===_);v>=0?L.rules.splice(v,0,$):(L.rules.push($),this.logger.warn(`rule ${_} is not defined`))}function K(L){let{metaSchema:$}=L;$!==void 0&&(L.$data&&this.opts.$data&&($=G($)),L.validateSchema=this.compile($,!0))}const I={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function G(L){return{anyOf:[L,I]}}},{"./compile":5,"./compile/codegen":2,"./compile/ref_error":7,"./compile/resolve":8,"./compile/rules":9,"./compile/util":10,"./compile/validate":15,"./compile/validate/dataType":13,"./refs/data.json":19,"./runtime/uri":23,"./runtime/validation_error":24}],19:[function(t,r,i){r.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},{}],20:[function(t,r,i){r.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}},{}],21:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("fast-deep-equal");s.code='require("ajv/dist/runtime/equal").default',i.default=s},{"fast-deep-equal":63}],22:[function(t,r,i){function s(o){const a=o.length;let l,h=0,c=0;for(;c<a;)h++,l=o.charCodeAt(c++),l>=55296&&l<=56319&&c<a&&(l=o.charCodeAt(c),(64512&l)==56320&&c++);return h}Object.defineProperty(i,"__esModule",{value:!0}),i.default=s,s.code='require("ajv/dist/runtime/ucs2length").default'},{}],23:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("uri-js");s.code='require("ajv/dist/runtime/uri").default',i.default=s},{"uri-js":65}],24:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});class s extends Error{constructor(a){super("validation failed"),this.errors=a,this.ajv=this.validation=!0}}i.default=s},{}],25:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.validateAdditionalItems=void 0;const s=t("../../compile/codegen"),o=t("../../compile/util"),a={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message({params:{len:h}}){return s.str`must NOT have more than ${h} items`},params({params:{len:h}}){return s._`{limit: ${h}}`}},code(h){const{parentSchema:c,it:u}=h,{items:f}=c;Array.isArray(f)?l(h,f):(0,o.checkStrictMode)(u,'"additionalItems" is ignored when "items" is not an array of schemas')}};function l(h,c){const{gen:u,schema:f,data:p,keyword:d,it:g}=h;g.items=!0;const S=u.const("len",s._`${p}.length`);if(f===!1)h.setParams({len:c.length}),h.pass(s._`${S} <= ${c.length}`);else if(typeof f=="object"&&!(0,o.alwaysValidSchema)(g,f)){const m=u.var("valid",s._`${S} <= ${c.length}`);u.if((0,s.not)(m),()=>function(y){u.forRange("i",c.length,S,w=>{h.subschema({keyword:d,dataProp:w,dataPropType:o.Type.Num},y),g.allErrors||u.if((0,s.not)(y),()=>u.break())})}(m)),h.ok(m)}}i.validateAdditionalItems=l,i.default=a},{"../../compile/codegen":2,"../../compile/util":10}],26:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../code"),o=t("../../compile/codegen"),a=t("../../compile/names"),l=t("../../compile/util");i.default={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params({params:h}){return o._`{additionalProperty: ${h.additionalProperty}}`}},code(h){const{gen:c,schema:u,parentSchema:f,data:p,errsCount:d,it:g}=h;if(!d)throw new Error("ajv implementation error");const{allErrors:S,opts:m}=g;if(g.props=!0,m.removeAdditional!=="all"&&(0,l.alwaysValidSchema)(g,u))return;const y=(0,s.allSchemaProperties)(f.properties),w=(0,s.allSchemaProperties)(f.patternProperties);function x(N){c.code(o._`delete ${p}[${N}]`)}function C(N){if(m.removeAdditional==="all"||m.removeAdditional&&u===!1)x(N);else{if(u===!1)return h.setParams({additionalProperty:N}),h.error(),void(S||c.break());if(typeof u=="object"&&!(0,l.alwaysValidSchema)(g,u)){const z=c.name("valid");m.removeAdditional==="failing"?(T(N,z,!1),c.if((0,o.not)(z),()=>{h.reset(),x(N)})):(T(N,z),S||c.if((0,o.not)(z),()=>c.break()))}}}function T(N,z,D){const R={keyword:"additionalProperties",dataProp:N,dataPropType:l.Type.Str};D===!1&&Object.assign(R,{compositeRule:!0,createErrors:!1,allErrors:!1}),h.subschema(R,z)}c.forIn("key",p,N=>{y.length||w.length?c.if(function(z){let D;if(y.length>8){const R=(0,l.schemaRefOrVal)(g,f.properties,"properties");D=(0,s.isOwnProperty)(c,R,z)}else D=y.length?(0,o.or)(...y.map(R=>o._`${z} === ${R}`)):o.nil;return w.length&&(D=(0,o.or)(D,...w.map(R=>o._`${(0,s.usePattern)(h,R)}.test(${z})`))),(0,o.not)(D)}(N),()=>C(N)):C(N)}),h.ok(o._`${d} === ${a.default.errors}`)}}},{"../../compile/codegen":2,"../../compile/names":6,"../../compile/util":10,"../code":42}],27:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/util");i.default={keyword:"allOf",schemaType:"array",code(o){const{gen:a,schema:l,it:h}=o;if(!Array.isArray(l))throw new Error("ajv implementation error");const c=a.name("valid");l.forEach((u,f)=>{if((0,s.alwaysValidSchema)(h,u))return;const p=o.subschema({keyword:"allOf",schemaProp:f},c);o.ok(c),o.mergeEvaluated(p)})}}},{"../../compile/util":10}],28:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../code");i.default={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:s.validateUnion,error:{message:"must match a schema in anyOf"}}},{"../code":42}],29:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util");i.default={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message({params:{min:a,max:l}}){return l===void 0?s.str`must contain at least ${a} valid item(s)`:s.str`must contain at least ${a} and no more than ${l} valid item(s)`},params({params:{min:a,max:l}}){return l===void 0?s._`{minContains: ${a}}`:s._`{minContains: ${a}, maxContains: ${l}}`}},code(a){const{gen:l,schema:h,parentSchema:c,data:u,it:f}=a;let p,d;const{minContains:g,maxContains:S}=c;f.opts.next?(p=g===void 0?1:g,d=S):p=1;const m=l.const("len",s._`${u}.length`);if(a.setParams({min:p,max:d}),d===void 0&&p===0)return void(0,o.checkStrictMode)(f,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(d!==void 0&&p>d)return(0,o.checkStrictMode)(f,'"minContains" > "maxContains" is always invalid'),void a.fail();if((0,o.alwaysValidSchema)(f,h)){let C=s._`${m} >= ${p}`;return d!==void 0&&(C=s._`${C} && ${m} <= ${d}`),void a.pass(C)}f.items=!0;const y=l.name("valid");function w(){const C=l.name("_valid"),T=l.let("count",0);x(C,()=>l.if(C,()=>function(N){l.code(s._`${N}++`),d===void 0?l.if(s._`${N} >= ${p}`,()=>l.assign(y,!0).break()):(l.if(s._`${N} > ${d}`,()=>l.assign(y,!1).break()),p===1?l.assign(y,!0):l.if(s._`${N} >= ${p}`,()=>l.assign(y,!0)))}(T)))}function x(C,T){l.forRange("i",0,m,N=>{a.subschema({keyword:"contains",dataProp:N,dataPropType:o.Type.Num,compositeRule:!0},C),T()})}d===void 0&&p===1?x(y,()=>l.if(y,()=>l.break())):p===0?(l.let(y,!0),d!==void 0&&l.if(s._`${u}.length > 0`,w)):(l.let(y,!1),w()),a.result(y,()=>a.reset())}}},{"../../compile/codegen":2,"../../compile/util":10}],30:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.validateSchemaDeps=i.validatePropertyDeps=i.error=void 0;const s=t("../../compile/codegen"),o=t("../../compile/util"),a=t("../code");i.error={message({params:{property:u,depsCount:f,deps:p}}){return s.str`must have ${f===1?"property":"properties"} ${p} when property ${u} is present`},params({params:{property:u,depsCount:f,deps:p,missingProperty:d}}){return s._`{property: ${u},
    missingProperty: ${d},
    depsCount: ${f},
    deps: ${p}}`}};const l={keyword:"dependencies",type:"object",schemaType:"object",error:i.error,code(u){const[f,p]=function({schema:d}){const g={},S={};for(const m in d)m!=="__proto__"&&((Array.isArray(d[m])?g:S)[m]=d[m]);return[g,S]}(u);h(u,f),c(u,p)}};function h(u,f=u.schema){const{gen:p,data:d,it:g}=u;if(Object.keys(f).length===0)return;const S=p.let("missing");for(const m in f){const y=f[m];if(y.length===0)continue;const w=(0,a.propertyInData)(p,d,m,g.opts.ownProperties);u.setParams({property:m,depsCount:y.length,deps:y.join(", ")}),g.allErrors?p.if(w,()=>{for(const x of y)(0,a.checkReportMissingProp)(u,x)}):(p.if(s._`${w} && (${(0,a.checkMissingProp)(u,y,S)})`),(0,a.reportMissingProp)(u,S),p.else())}}function c(u,f=u.schema){const{gen:p,data:d,keyword:g,it:S}=u,m=p.name("valid");for(const y in f)(0,o.alwaysValidSchema)(S,f[y])||(p.if((0,a.propertyInData)(p,d,y,S.opts.ownProperties),()=>{const w=u.subschema({keyword:g,schemaProp:y},m);u.mergeValidEvaluated(w,m)},()=>p.var(m,!0)),u.ok(m))}i.validatePropertyDeps=h,i.validateSchemaDeps=c,i.default=l},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],31:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util");function a(l,h){const c=l.schema[h];return c!==void 0&&!(0,o.alwaysValidSchema)(l,c)}i.default={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message({params:l}){return s.str`must match "${l.ifClause}" schema`},params({params:l}){return s._`{failingKeyword: ${l.ifClause}}`}},code(l){const{gen:h,parentSchema:c,it:u}=l;c.then===void 0&&c.else===void 0&&(0,o.checkStrictMode)(u,'"if" without "then" and "else" is ignored');const f=a(u,"then"),p=a(u,"else");if(!f&&!p)return;const d=h.let("valid",!0),g=h.name("_valid");if(function(){const m=l.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},g);l.mergeEvaluated(m)}(),l.reset(),f&&p){const m=h.let("ifClause");l.setParams({ifClause:m}),h.if(g,S("then",m),S("else",m))}else f?h.if(g,S("then")):h.if((0,s.not)(g),S("else"));function S(m,y){return()=>{const w=l.subschema({keyword:m},g);h.assign(d,g),l.mergeValidEvaluated(w,d),y?h.assign(y,s._`${m}`):l.setParams({ifClause:m})}}l.pass(d,()=>l.error(!0))}}},{"../../compile/codegen":2,"../../compile/util":10}],32:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./additionalItems"),o=t("./prefixItems"),a=t("./items"),l=t("./items2020"),h=t("./contains"),c=t("./dependencies"),u=t("./propertyNames"),f=t("./additionalProperties"),p=t("./properties"),d=t("./patternProperties"),g=t("./not"),S=t("./anyOf"),m=t("./oneOf"),y=t("./allOf"),w=t("./if"),x=t("./thenElse");i.default=function(C=!1){const T=[g.default,S.default,m.default,y.default,w.default,x.default,u.default,f.default,c.default,p.default,d.default];return C?T.push(o.default,l.default):T.push(s.default,a.default),T.push(h.default),T}},{"./additionalItems":25,"./additionalProperties":26,"./allOf":27,"./anyOf":28,"./contains":29,"./dependencies":30,"./if":31,"./items":33,"./items2020":34,"./not":35,"./oneOf":36,"./patternProperties":37,"./prefixItems":38,"./properties":39,"./propertyNames":40,"./thenElse":41}],33:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.validateTuple=void 0;const s=t("../../compile/codegen"),o=t("../../compile/util"),a=t("../code"),l={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(c){const{schema:u,it:f}=c;if(Array.isArray(u))return h(c,"additionalItems",u);f.items=!0,(0,o.alwaysValidSchema)(f,u)||c.ok((0,a.validateArray)(c))}};function h(c,u,f=c.schema){const{gen:p,parentSchema:d,data:g,keyword:S,it:m}=c;(function(x){const{opts:C,errSchemaPath:T}=m,N=f.length,z=N===x.minItems&&(N===x.maxItems||x[u]===!1);C.strictTuples&&!z&&(0,o.checkStrictMode)(m,`"${S}" is ${N}-tuple, but minItems or maxItems/${u} are not specified or different at path "${T}"`,C.strictTuples)})(d),m.opts.unevaluated&&f.length&&m.items!==!0&&(m.items=o.mergeEvaluated.items(p,f.length,m.items));const y=p.name("valid"),w=p.const("len",s._`${g}.length`);f.forEach((x,C)=>{(0,o.alwaysValidSchema)(m,x)||(p.if(s._`${w} > ${C}`,()=>c.subschema({keyword:S,schemaProp:C,dataProp:C},y)),c.ok(y))})}i.validateTuple=h,i.default=l},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],34:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util"),a=t("../code"),l=t("./additionalItems");i.default={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message({params:{len:h}}){return s.str`must NOT have more than ${h} items`},params({params:{len:h}}){return s._`{limit: ${h}}`}},code(h){const{schema:c,parentSchema:u,it:f}=h,{prefixItems:p}=u;f.items=!0,(0,o.alwaysValidSchema)(f,c)||(p?(0,l.validateAdditionalItems)(h,p):h.ok((0,a.validateArray)(h)))}}},{"../../compile/codegen":2,"../../compile/util":10,"../code":42,"./additionalItems":25}],35:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/util");i.default={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(o){const{gen:a,schema:l,it:h}=o;if((0,s.alwaysValidSchema)(h,l))return void o.fail();const c=a.name("valid");o.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},c),o.failResult(c,()=>o.reset(),()=>o.error())},error:{message:"must NOT be valid"}}},{"../../compile/util":10}],36:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util");i.default={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params({params:a}){return s._`{passingSchemas: ${a.passing}}`}},code(a){const{gen:l,schema:h,parentSchema:c,it:u}=a;if(!Array.isArray(h))throw new Error("ajv implementation error");if(u.opts.discriminator&&c.discriminator)return;const f=h,p=l.let("valid",!1),d=l.let("passing",null),g=l.name("_valid");a.setParams({passing:d}),l.block(function(){f.forEach((S,m)=>{let y;(0,o.alwaysValidSchema)(u,S)?l.var(g,!0):y=a.subschema({keyword:"oneOf",schemaProp:m,compositeRule:!0},g),m>0&&l.if(s._`${g} && ${p}`).assign(p,!1).assign(d,s._`[${d}, ${m}]`).else(),l.if(g,()=>{l.assign(p,!0),l.assign(d,m),y&&a.mergeEvaluated(y,s.Name)})})}),a.result(p,()=>a.reset(),()=>a.error(!0))}}},{"../../compile/codegen":2,"../../compile/util":10}],37:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../code"),o=t("../../compile/codegen"),a=t("../../compile/util"),l=t("../../compile/util");i.default={keyword:"patternProperties",type:"object",schemaType:"object",code(h){const{gen:c,schema:u,data:f,parentSchema:p,it:d}=h,{opts:g}=d,S=(0,s.allSchemaProperties)(u),m=S.filter(N=>(0,a.alwaysValidSchema)(d,u[N]));if(S.length===0||m.length===S.length&&(!d.opts.unevaluated||d.props===!0))return;const y=g.strictSchema&&!g.allowMatchingProperties&&p.properties,w=c.name("valid");d.props===!0||d.props instanceof o.Name||(d.props=(0,l.evaluatedPropsToName)(c,d.props));const{props:x}=d;function C(N){for(const z in y)new RegExp(N).test(z)&&(0,a.checkStrictMode)(d,`property ${z} matches pattern ${N} (use allowMatchingProperties)`)}function T(N){c.forIn("key",f,z=>{c.if(o._`${(0,s.usePattern)(h,N)}.test(${z})`,()=>{const D=m.includes(N);D||h.subschema({keyword:"patternProperties",schemaProp:N,dataProp:z,dataPropType:l.Type.Str},w),d.opts.unevaluated&&x!==!0?c.assign(o._`${x}[${z}]`,!0):D||d.allErrors||c.if((0,o.not)(w),()=>c.break())})})}(function(){for(const N of S)y&&C(N),d.allErrors?T(N):(c.var(w,!0),T(N),c.if(w))})()}}},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],38:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./items");i.default={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code(o){return(0,s.validateTuple)(o,"items")}}},{"./items":33}],39:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/validate"),o=t("../code"),a=t("../../compile/util"),l=t("./additionalProperties");i.default={keyword:"properties",type:"object",schemaType:"object",code(h){const{gen:c,schema:u,parentSchema:f,data:p,it:d}=h;d.opts.removeAdditional==="all"&&f.additionalProperties===void 0&&l.default.code(new s.KeywordCxt(d,l.default,"additionalProperties"));const g=(0,o.allSchemaProperties)(u);for(const x of g)d.definedProperties.add(x);d.opts.unevaluated&&g.length&&d.props!==!0&&(d.props=a.mergeEvaluated.props(c,(0,a.toHash)(g),d.props));const S=g.filter(x=>!(0,a.alwaysValidSchema)(d,u[x]));if(S.length===0)return;const m=c.name("valid");for(const x of S)y(x)?w(x):(c.if((0,o.propertyInData)(c,p,x,d.opts.ownProperties)),w(x),d.allErrors||c.else().var(m,!0),c.endIf()),h.it.definedProperties.add(x),h.ok(m);function y(x){return d.opts.useDefaults&&!d.compositeRule&&u[x].default!==void 0}function w(x){h.subschema({keyword:"properties",schemaProp:x,dataProp:x},m)}}}},{"../../compile/util":10,"../../compile/validate":15,"../code":42,"./additionalProperties":26}],40:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util");i.default={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params({params:a}){return s._`{propertyName: ${a.propertyName}}`}},code(a){const{gen:l,schema:h,data:c,it:u}=a;if((0,o.alwaysValidSchema)(u,h))return;const f=l.name("valid");l.forIn("key",c,p=>{a.setParams({propertyName:p}),a.subschema({keyword:"propertyNames",data:p,dataTypes:["string"],propertyName:p,compositeRule:!0},f),l.if((0,s.not)(f),()=>{a.error(!0),u.allErrors||l.break()})}),a.ok(f)}}},{"../../compile/codegen":2,"../../compile/util":10}],41:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/util");i.default={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:o,parentSchema:a,it:l}){a.if===void 0&&(0,s.checkStrictMode)(l,`"${o}" without "if" is ignored`)}}},{"../../compile/util":10}],42:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.validateUnion=i.validateArray=i.usePattern=i.callValidateCode=i.schemaProperties=i.allSchemaProperties=i.noPropertyInData=i.propertyInData=i.isOwnProperty=i.hasPropFunc=i.reportMissingProp=i.checkMissingProp=i.checkReportMissingProp=void 0;const s=t("../compile/codegen"),o=t("../compile/util"),a=t("../compile/names"),l=t("../compile/util");function h(d){return d.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:s._`Object.prototype.hasOwnProperty`})}function c(d,g,S){return s._`${h(d)}.call(${g}, ${S})`}function u(d,g,S,m){const y=s._`${g}${(0,s.getProperty)(S)} === undefined`;return m?(0,s.or)(y,(0,s.not)(c(d,g,S))):y}function f(d){return d?Object.keys(d).filter(g=>g!=="__proto__"):[]}i.checkReportMissingProp=function(d,g){const{gen:S,data:m,it:y}=d;S.if(u(S,m,g,y.opts.ownProperties),()=>{d.setParams({missingProperty:s._`${g}`},!0),d.error()})},i.checkMissingProp=function({gen:d,data:g,it:{opts:S}},m,y){return(0,s.or)(...m.map(w=>(0,s.and)(u(d,g,w,S.ownProperties),s._`${y} = ${w}`)))},i.reportMissingProp=function(d,g){d.setParams({missingProperty:g},!0),d.error()},i.hasPropFunc=h,i.isOwnProperty=c,i.propertyInData=function(d,g,S,m){const y=s._`${g}${(0,s.getProperty)(S)} !== undefined`;return m?s._`${y} && ${c(d,g,S)}`:y},i.noPropertyInData=u,i.allSchemaProperties=f,i.schemaProperties=function(d,g){return f(g).filter(S=>!(0,o.alwaysValidSchema)(d,g[S]))},i.callValidateCode=function({schemaCode:d,data:g,it:{gen:S,topSchemaRef:m,schemaPath:y,errorPath:w},it:x},C,T,N){const z=N?s._`${d}, ${g}, ${m}${y}`:g,D=[[a.default.instancePath,(0,s.strConcat)(a.default.instancePath,w)],[a.default.parentData,x.parentData],[a.default.parentDataProperty,x.parentDataProperty],[a.default.rootData,a.default.rootData]];x.opts.dynamicRef&&D.push([a.default.dynamicAnchors,a.default.dynamicAnchors]);const R=s._`${z}, ${S.object(...D)}`;return T!==s.nil?s._`${C}.call(${T}, ${R})`:s._`${C}(${R})`};const p=s._`new RegExp`;i.usePattern=function({gen:d,it:{opts:g}},S){const m=g.unicodeRegExp?"u":"",{regExp:y}=g.code,w=y(S,m);return d.scopeValue("pattern",{key:w.toString(),ref:w,code:s._`${y.code==="new RegExp"?p:(0,l.useFunc)(d,y)}(${S}, ${m})`})},i.validateArray=function(d){const{gen:g,data:S,keyword:m,it:y}=d,w=g.name("valid");if(y.allErrors){const C=g.let("valid",!0);return x(()=>g.assign(C,!1)),C}return g.var(w,!0),x(()=>g.break()),w;function x(C){const T=g.const("len",s._`${S}.length`);g.forRange("i",0,T,N=>{d.subschema({keyword:m,dataProp:N,dataPropType:o.Type.Num},w),g.if((0,s.not)(w),C)})}},i.validateUnion=function(d){const{gen:g,schema:S,keyword:m,it:y}=d;if(!Array.isArray(S))throw new Error("ajv implementation error");if(S.some(C=>(0,o.alwaysValidSchema)(y,C))&&!y.opts.unevaluated)return;const w=g.let("valid",!1),x=g.name("_valid");g.block(()=>S.forEach((C,T)=>{const N=d.subschema({keyword:m,schemaProp:T,compositeRule:!0},x);g.assign(w,s._`${w} || ${x}`),d.mergeValidEvaluated(N,x)||g.if((0,s.not)(w))})),d.result(w,()=>d.reset(),()=>d.error(!0))}},{"../compile/codegen":2,"../compile/names":6,"../compile/util":10}],43:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}}},{}],44:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./id"),o=t("./ref");i.default=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",s.default,o.default]},{"./id":43,"./ref":45}],45:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.callRef=i.getValidate=void 0;const s=t("../../compile/ref_error"),o=t("../code"),a=t("../../compile/codegen"),l=t("../../compile/names"),h=t("../../compile"),c=t("../../compile/util"),u={keyword:"$ref",schemaType:"string",code(d){const{gen:g,schema:S,it:m}=d,{baseId:y,schemaEnv:w,validateName:x,opts:C,self:T}=m,{root:N}=w;if((S==="#"||S==="#/")&&y===N.baseId)return function(){if(w===N)return p(d,x,w,w.$async);const D=g.scopeValue("root",{ref:N});return p(d,a._`${D}.validate`,N,N.$async)}();const z=h.resolveRef.call(T,N,y,S);if(z===void 0)throw new s.default(m.opts.uriResolver,y,S);return z instanceof h.SchemaEnv?function(D){const R=f(d,D);p(d,R,D,D.$async)}(z):function(D){const R=g.scopeValue("schema",C.code.source===!0?{ref:D,code:(0,a.stringify)(D)}:{ref:D}),W=g.name("valid"),B=d.subschema({schema:D,dataTypes:[],schemaPath:a.nil,topSchemaRef:R,errSchemaPath:S},W);d.mergeEvaluated(B),d.ok(W)}(z)}};function f(d,g){const{gen:S}=d;return g.validate?S.scopeValue("validate",{ref:g.validate}):a._`${S.scopeValue("wrapper",{ref:g})}.validate`}function p(d,g,S,m){const{gen:y,it:w}=d,{allErrors:x,schemaEnv:C,opts:T}=w,N=T.passContext?l.default.this:a.nil;function z(R){const W=a._`${R}.errors`;y.assign(l.default.vErrors,a._`${l.default.vErrors} === null ? ${W} : ${l.default.vErrors}.concat(${W})`),y.assign(l.default.errors,a._`${l.default.vErrors}.length`)}function D(R){var W;if(!w.opts.unevaluated)return;const B=(W=S==null?void 0:S.validate)===null||W===void 0?void 0:W.evaluated;if(w.props!==!0)if(B&&!B.dynamicProps)B.props!==void 0&&(w.props=c.mergeEvaluated.props(y,B.props,w.props));else{const F=y.var("props",a._`${R}.evaluated.props`);w.props=c.mergeEvaluated.props(y,F,w.props,a.Name)}if(w.items!==!0)if(B&&!B.dynamicItems)B.items!==void 0&&(w.items=c.mergeEvaluated.items(y,B.items,w.items));else{const F=y.var("items",a._`${R}.evaluated.items`);w.items=c.mergeEvaluated.items(y,F,w.items,a.Name)}}m?function(){if(!C.$async)throw new Error("async schema referenced by sync schema");const R=y.let("valid");y.try(()=>{y.code(a._`await ${(0,o.callValidateCode)(d,g,N)}`),D(g),x||y.assign(R,!0)},W=>{y.if(a._`!(${W} instanceof ${w.ValidationError})`,()=>y.throw(W)),z(W),x||y.assign(R,!1)}),d.ok(R)}():d.result((0,o.callValidateCode)(d,g,N),()=>D(g),()=>z(g))}i.getValidate=f,i.callRef=p,i.default=u},{"../../compile":5,"../../compile/codegen":2,"../../compile/names":6,"../../compile/ref_error":7,"../../compile/util":10,"../code":42}],46:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../discriminator/types"),a=t("../../compile"),l=t("../../compile/util");i.default={keyword:"discriminator",type:"object",schemaType:"object",error:{message({params:{discrError:h,tagName:c}}){return h===o.DiscrError.Tag?`tag "${c}" must be string`:`value of tag "${c}" must be in oneOf`},params({params:{discrError:h,tag:c,tagName:u}}){return s._`{error: ${h}, tag: ${u}, tagValue: ${c}}`}},code(h){const{gen:c,data:u,schema:f,parentSchema:p,it:d}=h,{oneOf:g}=p;if(!d.opts.discriminator)throw new Error("discriminator: requires discriminator option");const S=f.propertyName;if(typeof S!="string")throw new Error("discriminator: requires propertyName");if(f.mapping)throw new Error("discriminator: mapping is not supported");if(!g)throw new Error("discriminator: requires oneOf keyword");const m=c.let("valid",!1),y=c.const("tag",s._`${u}${(0,s.getProperty)(S)}`);function w(x){const C=c.name("valid"),T=h.subschema({keyword:"oneOf",schemaProp:x},C);return h.mergeEvaluated(T,s.Name),C}c.if(s._`typeof ${y} == "string"`,()=>function(){const x=function(){var C;const T={},N=D(p);let z=!0;for(let B=0;B<g.length;B++){let F=g[B];(F==null?void 0:F.$ref)&&!(0,l.schemaHasRulesButRef)(F,d.self.RULES)&&(F=a.resolveRef.call(d.self,d.schemaEnv.root,d.baseId,F==null?void 0:F.$ref),F instanceof a.SchemaEnv&&(F=F.schema));const se=(C=F==null?void 0:F.properties)===null||C===void 0?void 0:C[S];if(typeof se!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${S}"`);z=z&&(N||D(F)),R(se,B)}if(!z)throw new Error(`discriminator: "${S}" must be required`);return T;function D({required:B}){return Array.isArray(B)&&B.includes(S)}function R(B,F){if(B.const)W(B.const,F);else{if(!B.enum)throw new Error(`discriminator: "properties/${S}" must have "const" or "enum"`);for(const se of B.enum)W(se,F)}}function W(B,F){if(typeof B!="string"||B in T)throw new Error(`discriminator: "${S}" values must be unique strings`);T[B]=F}}();c.if(!1);for(const C in x)c.elseIf(s._`${y} === ${C}`),c.assign(m,w(x[C]));c.else(),h.error(!1,{discrError:o.DiscrError.Mapping,tag:y,tagName:S}),c.endIf()}(),()=>h.error(!1,{discrError:o.DiscrError.Tag,tag:y,tagName:S})),h.ok(m)}}},{"../../compile":5,"../../compile/codegen":2,"../../compile/util":10,"../discriminator/types":47}],47:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.DiscrError=void 0,function(s){s.Tag="tag",s.Mapping="mapping"}(i.DiscrError||(i.DiscrError={}))},{}],48:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./core"),o=t("./validation"),a=t("./applicator"),l=t("./format"),h=t("./metadata"),c=[s.default,o.default,(0,a.default)(),l.default,h.metadataVocabulary,h.contentVocabulary];i.default=c},{"./applicator":32,"./core":44,"./format":50,"./metadata":51,"./validation":54}],49:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen");i.default={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message({schemaCode:o}){return s.str`must match format "${o}"`},params({schemaCode:o}){return s._`{format: ${o}}`}},code(o,a){const{gen:l,data:h,$data:c,schema:u,schemaCode:f,it:p}=o,{opts:d,errSchemaPath:g,schemaEnv:S,self:m}=p;d.validateFormats&&(c?function(){const y=l.scopeValue("formats",{ref:m.formats,code:d.code.formats}),w=l.const("fDef",s._`${y}[${f}]`),x=l.let("fType"),C=l.let("format");l.if(s._`typeof ${w} == "object" && !(${w} instanceof RegExp)`,()=>l.assign(x,s._`${w}.type || "string"`).assign(C,s._`${w}.validate`),()=>l.assign(x,s._`"string"`).assign(C,w)),o.fail$data((0,s.or)(d.strictSchema===!1?s.nil:s._`${f} && !${C}`,function(){const T=S.$async?s._`(${w}.async ? await ${C}(${h}) : ${C}(${h}))`:s._`${C}(${h})`,N=s._`(typeof ${C} == "function" ? ${T} : ${C}.test(${h}))`;return s._`${C} && ${C} !== true && ${x} === ${a} && !${N}`}()))}():function(){const y=m.formats[u];if(!y)return void function(){if(d.strictSchema===!1)return void m.logger.warn(T());throw new Error(T());function T(){return`unknown format "${u}" ignored in schema at path "${g}"`}}();if(y===!0)return;const[w,x,C]=function(T){const N=T instanceof RegExp?(0,s.regexpCode)(T):d.code.formats?s._`${d.code.formats}${(0,s.getProperty)(u)}`:void 0,z=l.scopeValue("formats",{key:u,ref:T,code:N});return typeof T=="object"&&!(T instanceof RegExp)?[T.type||"string",T.validate,s._`${z}.validate`]:["string",T,z]}(y);w===a&&o.pass(function(){if(typeof y=="object"&&!(y instanceof RegExp)&&y.async){if(!S.$async)throw new Error("async format in sync schema");return s._`await ${C}(${h})`}return typeof x=="function"?s._`${C}(${h})`:s._`${C}.test(${h})`}())}())}}},{"../../compile/codegen":2}],50:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./format");i.default=[s.default]},{"./format":49}],51:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.contentVocabulary=i.metadataVocabulary=void 0,i.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],i.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},{}],52:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util"),a=t("../../runtime/equal");i.default={keyword:"const",$data:!0,error:{message:"must be equal to constant",params({schemaCode:l}){return s._`{allowedValue: ${l}}`}},code(l){const{gen:h,data:c,$data:u,schemaCode:f,schema:p}=l;u||p&&typeof p=="object"?l.fail$data(s._`!${(0,o.useFunc)(h,a.default)}(${c}, ${f})`):l.fail(s._`${p} !== ${c}`)}}},{"../../compile/codegen":2,"../../compile/util":10,"../../runtime/equal":21}],53:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util"),a=t("../../runtime/equal");i.default={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params({schemaCode:l}){return s._`{allowedValues: ${l}}`}},code(l){const{gen:h,data:c,$data:u,schema:f,schemaCode:p,it:d}=l;if(!u&&f.length===0)throw new Error("enum must have non-empty array");let g;const S=()=>g!=null?g:g=(0,o.useFunc)(h,a.default);let m;if(f.length>=d.opts.loopEnum||u)m=h.let("valid"),l.block$data(m,function(){h.assign(m,!1),h.forOf("v",p,y=>h.if(s._`${S()}(${c}, ${y})`,()=>h.assign(m,!0).break()))});else{if(!Array.isArray(f))throw new Error("ajv implementation error");const y=h.const("vSchema",p);m=(0,s.or)(...f.map((w,x)=>function(C,T){const N=f[T];return typeof N=="object"&&N!==null?s._`${S()}(${c}, ${C}[${T}])`:s._`${c} === ${N}`}(y,x)))}l.pass(m)}}},{"../../compile/codegen":2,"../../compile/util":10,"../../runtime/equal":21}],54:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("./limitNumber"),o=t("./multipleOf"),a=t("./limitLength"),l=t("./pattern"),h=t("./limitProperties"),c=t("./required"),u=t("./limitItems"),f=t("./uniqueItems"),p=t("./const"),d=t("./enum");i.default=[s.default,o.default,a.default,l.default,h.default,c.default,u.default,f.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},p.default,d.default]},{"./const":52,"./enum":53,"./limitItems":55,"./limitLength":56,"./limitNumber":57,"./limitProperties":58,"./multipleOf":59,"./pattern":60,"./required":61,"./uniqueItems":62}],55:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen");i.default={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message:({keyword:o,schemaCode:a})=>s.str`must NOT have ${o==="maxItems"?"more":"fewer"} than ${a} items`,params({schemaCode:o}){return s._`{limit: ${o}}`}},code(o){const{keyword:a,data:l,schemaCode:h}=o;o.fail$data(s._`${l}.length ${a==="maxItems"?s.operators.GT:s.operators.LT} ${h}`)}}},{"../../compile/codegen":2}],56:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=t("../../compile/util"),a=t("../../runtime/ucs2length");i.default={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message:({keyword:l,schemaCode:h})=>s.str`must NOT have ${l==="maxLength"?"more":"fewer"} than ${h} characters`,params({schemaCode:l}){return s._`{limit: ${l}}`}},code(l){const{keyword:h,data:c,schemaCode:u,it:f}=l,p=h==="maxLength"?s.operators.GT:s.operators.LT,d=f.opts.unicode===!1?s._`${c}.length`:s._`${(0,o.useFunc)(l.gen,a.default)}(${c})`;l.fail$data(s._`${d} ${p} ${u}`)}}},{"../../compile/codegen":2,"../../compile/util":10,"../../runtime/ucs2length":22}],57:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen"),o=s.operators,a={maximum:{okStr:"<=",ok:o.LTE,fail:o.GT},minimum:{okStr:">=",ok:o.GTE,fail:o.LT},exclusiveMaximum:{okStr:"<",ok:o.LT,fail:o.GTE},exclusiveMinimum:{okStr:">",ok:o.GT,fail:o.LTE}},l={message({keyword:c,schemaCode:u}){return s.str`must be ${a[c].okStr} ${u}`},params({keyword:c,schemaCode:u}){return s._`{comparison: ${a[c].okStr}, limit: ${u}}`}},h={keyword:Object.keys(a),type:"number",schemaType:"number",$data:!0,error:l,code(c){const{keyword:u,data:f,schemaCode:p}=c;c.fail$data(s._`${f} ${a[u].fail} ${p} || isNaN(${f})`)}};i.default=h},{"../../compile/codegen":2}],58:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen");i.default={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message:({keyword:o,schemaCode:a})=>s.str`must NOT have ${o==="maxProperties"?"more":"fewer"} than ${a} properties`,params({schemaCode:o}){return s._`{limit: ${o}}`}},code(o){const{keyword:a,data:l,schemaCode:h}=o;o.fail$data(s._`Object.keys(${l}).length ${a==="maxProperties"?s.operators.GT:s.operators.LT} ${h}`)}}},{"../../compile/codegen":2}],59:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/codegen");i.default={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message({schemaCode:o}){return s.str`must be multiple of ${o}`},params({schemaCode:o}){return s._`{multipleOf: ${o}}`}},code(o){const{gen:a,data:l,schemaCode:h,it:c}=o,u=c.opts.multipleOfPrecision,f=a.let("res"),p=u?s._`Math.abs(Math.round(${f}) - ${f}) > 1e-${u}`:s._`${f} !== parseInt(${f})`;o.fail$data(s._`(${h} === 0 || (${f} = ${l}/${h}, ${p}))`)}}},{"../../compile/codegen":2}],60:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../code"),o=t("../../compile/codegen");i.default={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message({schemaCode:a}){return o.str`must match pattern "${a}"`},params({schemaCode:a}){return o._`{pattern: ${a}}`}},code(a){const{data:l,$data:h,schema:c,schemaCode:u,it:f}=a,p=h?o._`(new RegExp(${u}, ${f.opts.unicodeRegExp?"u":""}))`:(0,s.usePattern)(a,c);a.fail$data(o._`!${p}.test(${l})`)}}},{"../../compile/codegen":2,"../code":42}],61:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../code"),o=t("../../compile/codegen"),a=t("../../compile/util");i.default={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message({params:{missingProperty:l}}){return o.str`must have required property '${l}'`},params({params:{missingProperty:l}}){return o._`{missingProperty: ${l}}`}},code(l){const{gen:h,schema:c,schemaCode:u,data:f,$data:p,it:d}=l,{opts:g}=d;if(!p&&c.length===0)return;const S=c.length>=g.loopRequired;if(d.allErrors?function(){if(S||p)l.block$data(o.nil,m);else for(const y of c)(0,s.checkReportMissingProp)(l,y)}():function(){const y=h.let("missing");if(S||p){const w=h.let("valid",!0);l.block$data(w,()=>function(x,C){l.setParams({missingProperty:x}),h.forOf(x,u,()=>{h.assign(C,(0,s.propertyInData)(h,f,x,g.ownProperties)),h.if((0,o.not)(C),()=>{l.error(),h.break()})},o.nil)}(y,w)),l.ok(w)}else h.if((0,s.checkMissingProp)(l,c,y)),(0,s.reportMissingProp)(l,y),h.else()}(),g.strictRequired){const y=l.parentSchema.properties,{definedProperties:w}=l.it;for(const x of c)(y==null?void 0:y[x])===void 0&&!w.has(x)&&(0,a.checkStrictMode)(d,`required property "${x}" is not defined at "${d.schemaEnv.baseId+d.errSchemaPath}" (strictRequired)`,d.opts.strictRequired)}function m(){h.forOf("prop",u,y=>{l.setParams({missingProperty:y}),h.if((0,s.noPropertyInData)(h,f,y,g.ownProperties),()=>l.error())})}}}},{"../../compile/codegen":2,"../../compile/util":10,"../code":42}],62:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0});const s=t("../../compile/validate/dataType"),o=t("../../compile/codegen"),a=t("../../compile/util"),l=t("../../runtime/equal");i.default={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message({params:{i:h,j:c}}){return o.str`must NOT have duplicate items (items ## ${c} and ${h} are identical)`},params({params:{i:h,j:c}}){return o._`{i: ${h}, j: ${c}}`}},code(h){const{gen:c,data:u,$data:f,schema:p,parentSchema:d,schemaCode:g,it:S}=h;if(!f&&!p)return;const m=c.let("valid"),y=d.items?(0,s.getSchemaTypes)(d.items):[];function w(C,T){const N=c.name("item"),z=(0,s.checkDataTypes)(y,N,S.opts.strictNumbers,s.DataType.Wrong),D=c.const("indices",o._`{}`);c.for(o._`;${C}--;`,()=>{c.let(N,o._`${u}[${C}]`),c.if(z,o._`continue`),y.length>1&&c.if(o._`typeof ${N} == "string"`,o._`${N} += "_"`),c.if(o._`typeof ${D}[${N}] == "number"`,()=>{c.assign(T,o._`${D}[${N}]`),h.error(),c.assign(m,!1).break()}).code(o._`${D}[${N}] = ${C}`)})}function x(C,T){const N=(0,a.useFunc)(c,l.default),z=c.name("outer");c.label(z).for(o._`;${C}--;`,()=>c.for(o._`${T} = ${C}; ${T}--;`,()=>c.if(o._`${N}(${u}[${C}], ${u}[${T}])`,()=>{h.error(),c.assign(m,!1).break(z)})))}h.block$data(m,function(){const C=c.let("i",o._`${u}.length`),T=c.let("j");h.setParams({i:C,j:T}),c.assign(m,!0),c.if(o._`${C} > 1`,()=>(y.length>0&&!y.some(N=>N==="object"||N==="array")?w:x)(C,T))},o._`${g} === false`),h.ok(m)}}},{"../../compile/codegen":2,"../../compile/util":10,"../../compile/validate/dataType":13,"../../runtime/equal":21}],63:[function(t,r,i){r.exports=function s(o,a){if(o===a)return!0;if(o&&a&&typeof o=="object"&&typeof a=="object"){if(o.constructor!==a.constructor)return!1;var l,h,c;if(Array.isArray(o)){if((l=o.length)!=a.length)return!1;for(h=l;h--!=0;)if(!s(o[h],a[h]))return!1;return!0}if(o.constructor===RegExp)return o.source===a.source&&o.flags===a.flags;if(o.valueOf!==Object.prototype.valueOf)return o.valueOf()===a.valueOf();if(o.toString!==Object.prototype.toString)return o.toString()===a.toString();if((l=(c=Object.keys(o)).length)!==Object.keys(a).length)return!1;for(h=l;h--!=0;)if(!Object.prototype.hasOwnProperty.call(a,c[h]))return!1;for(h=l;h--!=0;){var u=c[h];if(!s(o[u],a[u]))return!1}return!0}return o!=o&&a!=a}},{}],64:[function(t,r,i){var s=r.exports=function(a,l,h){typeof l=="function"&&(h=l,l={}),o(l,typeof(h=l.cb||h)=="function"?h:h.pre||function(){},h.post||function(){},a,"",a)};function o(a,l,h,c,u,f,p,d,g,S){if(c&&typeof c=="object"&&!Array.isArray(c)){for(var m in l(c,u,f,p,d,g,S),c){var y=c[m];if(Array.isArray(y)){if(m in s.arrayKeywords)for(var w=0;w<y.length;w++)o(a,l,h,y[w],u+"/"+m+"/"+w,f,u,m,c,w)}else if(m in s.propsKeywords){if(y&&typeof y=="object")for(var x in y)o(a,l,h,y[x],u+"/"+m+"/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),f,u,m,c,x)}else(m in s.keywords||a.allKeys&&!(m in s.skipKeywords))&&o(a,l,h,y,u+"/"+m,f,u,m,c)}h(c,u,f,p,d,g,S)}}s.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},s.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},s.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},s.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},{}],65:[function(t,r,i){/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(s,o){o(typeof i=="object"&&r!==void 0?i:s.URI=s.URI||{})})(this,function(s){function o(){for(var k=arguments.length,A=Array(k),E=0;E<k;E++)A[E]=arguments[E];if(A.length>1){A[0]=A[0].slice(0,-1);for(var q=A.length-1,H=1;H<q;++H)A[H]=A[H].slice(1,-1);return A[q]=A[q].slice(1),A.join("")}return A[0]}function a(k){return"(?:"+k+")"}function l(k){return k===void 0?"undefined":k===null?"null":Object.prototype.toString.call(k).split(" ").pop().split("]").shift().toLowerCase()}function h(k){return k.toUpperCase()}function c(k){var A="[A-Za-z]",E="[0-9]",q=o(E,"[A-Fa-f]"),H=a(a("%[EFef]"+q+"%"+q+q+"%"+q+q)+"|"+a("%[89A-Fa-f]"+q+"%"+q+q)+"|"+a("%"+q+q)),ee="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",ve=o("[\\:\\/\\?\\#\\[\\]\\@]",ee),be=k?"[\\uE000-\\uF8FF]":"[]",Se=o(A,E,"[\\-\\.\\_\\~]",k?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");a(A+o(A,E,"[\\+\\-\\.]")+"*"),a(a(H+"|"+o(Se,ee,"[\\:]"))+"*");var _e=a(a("25[0-5]")+"|"+a("2[0-4][0-9]")+"|"+a("1[0-9][0-9]")+"|"+a("0?[1-9][0-9]")+"|0?0?"+E),Be=a(_e+"\\."+_e+"\\."+_e+"\\."+_e),de=a(q+"{1,4}"),Pe=a(a(de+"\\:"+de)+"|"+Be),Oe=a(a(de+"\\:")+"{6}"+Pe),qe=a("\\:\\:"+a(de+"\\:")+"{5}"+Pe),$e=a(a(de)+"?\\:\\:"+a(de+"\\:")+"{4}"+Pe),He=a(a(a(de+"\\:")+"{0,1}"+de)+"?\\:\\:"+a(de+"\\:")+"{3}"+Pe),pt=a(a(a(de+"\\:")+"{0,2}"+de)+"?\\:\\:"+a(de+"\\:")+"{2}"+Pe),bt=a(a(a(de+"\\:")+"{0,3}"+de)+"?\\:\\:"+de+"\\:"+Pe),oi=a(a(a(de+"\\:")+"{0,4}"+de)+"?\\:\\:"+Pe),ai=a(a(a(de+"\\:")+"{0,5}"+de)+"?\\:\\:"+de),St=a(a(a(de+"\\:")+"{0,6}"+de)+"?\\:\\:"),Ct=a([Oe,qe,$e,He,pt,bt,oi,ai,St].join("|")),li=a(a(Se+"|"+H)+"+");a("[vV]"+q+"+\\."+o(Se,ee,"[\\:]")+"+"),a(a(H+"|"+o(Se,ee))+"*");var Dt=a(H+"|"+o(Se,ee,"[\\:\\@]"));return a(a(H+"|"+o(Se,ee,"[\\@]"))+"+"),a(a(Dt+"|"+o("[\\/\\?]",be))+"*"),{NOT_SCHEME:new RegExp(o("[^]",A,E,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(o("[^\\%\\:]",Se,ee),"g"),NOT_HOST:new RegExp(o("[^\\%\\[\\]\\:]",Se,ee),"g"),NOT_PATH:new RegExp(o("[^\\%\\/\\:\\@]",Se,ee),"g"),NOT_PATH_NOSCHEME:new RegExp(o("[^\\%\\/\\@]",Se,ee),"g"),NOT_QUERY:new RegExp(o("[^\\%]",Se,ee,"[\\:\\@\\/\\?]",be),"g"),NOT_FRAGMENT:new RegExp(o("[^\\%]",Se,ee,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(o("[^]",Se,ee),"g"),UNRESERVED:new RegExp(Se,"g"),OTHER_CHARS:new RegExp(o("[^\\%]",Se,ve),"g"),PCT_ENCODED:new RegExp(H,"g"),IPV4ADDRESS:new RegExp("^("+Be+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Ct+")"+a(a("\\%25|\\%(?!"+q+"{2})")+"("+li+")")+"?\\]?$")}}var u=c(!1),f=c(!0),p=function(k,A){if(Array.isArray(k))return k;if(Symbol.iterator in Object(k))return function(E,q){var H=[],ee=!0,ve=!1,be=void 0;try{for(var Se,_e=E[Symbol.iterator]();!(ee=(Se=_e.next()).done)&&(H.push(Se.value),!q||H.length!==q);ee=!0);}catch(Be){ve=!0,be=Be}finally{try{!ee&&_e.return&&_e.return()}finally{if(ve)throw be}}return H}(k,A);throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=2147483647,g=36,S=/^xn--/,m=/[^\0-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=Math.floor,C=String.fromCharCode;function T(k){throw new RangeError(w[k])}function N(k,A){var E=k.split("@"),q="";E.length>1&&(q=E[0]+"@",k=E[1]);var H=function(ee,ve){for(var be=[],Se=ee.length;Se--;)be[Se]=ve(ee[Se]);return be}((k=k.replace(y,".")).split("."),A).join(".");return q+H}function z(k){for(var A=[],E=0,q=k.length;E<q;){var H=k.charCodeAt(E++);if(H>=55296&&H<=56319&&E<q){var ee=k.charCodeAt(E++);(64512&ee)==56320?A.push(((1023&H)<<10)+(1023&ee)+65536):(A.push(H),E--)}else A.push(H)}return A}var D=function(k,A){return k+22+75*(k<26)-((A!=0)<<5)},R=function(k,A,E){var q=0;for(k=E?x(k/700):k>>1,k+=x(k/A);k>455;q+=g)k=x(k/35);return x(q+36*k/(k+38))},W=function(k){var A,E=[],q=k.length,H=0,ee=128,ve=72,be=k.lastIndexOf("-");be<0&&(be=0);for(var Se=0;Se<be;++Se)k.charCodeAt(Se)>=128&&T("not-basic"),E.push(k.charCodeAt(Se));for(var _e=be>0?be+1:0;_e<q;){for(var Be=H,de=1,Pe=g;;Pe+=g){_e>=q&&T("invalid-input");var Oe=(A=k.charCodeAt(_e++))-48<10?A-22:A-65<26?A-65:A-97<26?A-97:g;(Oe>=g||Oe>x((d-H)/de))&&T("overflow"),H+=Oe*de;var qe=Pe<=ve?1:Pe>=ve+26?26:Pe-ve;if(Oe<qe)break;var $e=g-qe;de>x(d/$e)&&T("overflow"),de*=$e}var He=E.length+1;ve=R(H-Be,He,Be==0),x(H/He)>d-ee&&T("overflow"),ee+=x(H/He),H%=He,E.splice(H++,0,ee)}return String.fromCodePoint.apply(String,E)},B=function(k){var A=[],E=(k=z(k)).length,q=128,H=0,ee=72,ve=!0,be=!1,Se=void 0;try{for(var _e,Be=k[Symbol.iterator]();!(ve=(_e=Be.next()).done);ve=!0){var de=_e.value;de<128&&A.push(C(de))}}catch(Ri){be=!0,Se=Ri}finally{try{!ve&&Be.return&&Be.return()}finally{if(be)throw Se}}var Pe=A.length,Oe=Pe;for(Pe&&A.push("-");Oe<E;){var qe=d,$e=!0,He=!1,pt=void 0;try{for(var bt,oi=k[Symbol.iterator]();!($e=(bt=oi.next()).done);$e=!0){var ai=bt.value;ai>=q&&ai<qe&&(qe=ai)}}catch(Ri){He=!0,pt=Ri}finally{try{!$e&&oi.return&&oi.return()}finally{if(He)throw pt}}var St=Oe+1;qe-q>x((d-H)/St)&&T("overflow"),H+=(qe-q)*St,q=qe;var Ct=!0,li=!1,Dt=void 0;try{for(var qs,gn=k[Symbol.iterator]();!(Ct=(qs=gn.next()).done);Ct=!0){var Us=qs.value;if(Us<q&&++H>d&&T("overflow"),Us==q){for(var fr=H,dr=g;;dr+=g){var pr=dr<=ee?1:dr>=ee+26?26:dr-ee;if(fr<pr)break;var Ks=fr-pr,Gs=g-pr;A.push(C(D(pr+Ks%Gs,0))),fr=x(Ks/Gs)}A.push(C(D(fr,0))),ee=R(H,St,Oe==Pe),H=0,++Oe}}}catch(Ri){li=!0,Dt=Ri}finally{try{!Ct&&gn.return&&gn.return()}finally{if(li)throw Dt}}++H,++q}return A.join("")},F=function(k){return N(k,function(A){return m.test(A)?"xn--"+B(A):A})},se=function(k){return N(k,function(A){return S.test(A)?W(A.slice(4).toLowerCase()):A})},Y={};function ie(k){var A=k.charCodeAt(0);return A<16?"%0"+A.toString(16).toUpperCase():A<128?"%"+A.toString(16).toUpperCase():A<2048?"%"+(A>>6|192).toString(16).toUpperCase()+"%"+(63&A|128).toString(16).toUpperCase():"%"+(A>>12|224).toString(16).toUpperCase()+"%"+(A>>6&63|128).toString(16).toUpperCase()+"%"+(63&A|128).toString(16).toUpperCase()}function le(k){for(var A="",E=0,q=k.length;E<q;){var H=parseInt(k.substr(E+1,2),16);if(H<128)A+=String.fromCharCode(H),E+=3;else if(H>=194&&H<224){if(q-E>=6){var ee=parseInt(k.substr(E+4,2),16);A+=String.fromCharCode((31&H)<<6|63&ee)}else A+=k.substr(E,6);E+=6}else if(H>=224){if(q-E>=9){var ve=parseInt(k.substr(E+4,2),16),be=parseInt(k.substr(E+7,2),16);A+=String.fromCharCode((15&H)<<12|(63&ve)<<6|63&be)}else A+=k.substr(E,9);E+=9}else A+=k.substr(E,3),E+=3}return A}function fe(k,A){function E(q){var H=le(q);return H.match(A.UNRESERVED)?H:q}return k.scheme&&(k.scheme=String(k.scheme).replace(A.PCT_ENCODED,E).toLowerCase().replace(A.NOT_SCHEME,"")),k.userinfo!==void 0&&(k.userinfo=String(k.userinfo).replace(A.PCT_ENCODED,E).replace(A.NOT_USERINFO,ie).replace(A.PCT_ENCODED,h)),k.host!==void 0&&(k.host=String(k.host).replace(A.PCT_ENCODED,E).toLowerCase().replace(A.NOT_HOST,ie).replace(A.PCT_ENCODED,h)),k.path!==void 0&&(k.path=String(k.path).replace(A.PCT_ENCODED,E).replace(k.scheme?A.NOT_PATH:A.NOT_PATH_NOSCHEME,ie).replace(A.PCT_ENCODED,h)),k.query!==void 0&&(k.query=String(k.query).replace(A.PCT_ENCODED,E).replace(A.NOT_QUERY,ie).replace(A.PCT_ENCODED,h)),k.fragment!==void 0&&(k.fragment=String(k.fragment).replace(A.PCT_ENCODED,E).replace(A.NOT_FRAGMENT,ie).replace(A.PCT_ENCODED,h)),k}function K(k){return k.replace(/^0*(.*)/,"$1")||"0"}function I(k,A){var E=k.match(A.IPV4ADDRESS)||[],q=p(E,2)[1];return q?q.split(".").map(K).join("."):k}function G(k,A){var E=k.match(A.IPV6ADDRESS)||[],q=p(E,3),H=q[1],ee=q[2];if(H){for(var ve=H.toLowerCase().split("::").reverse(),be=p(ve,2),Se=be[0],_e=be[1],Be=_e?_e.split(":").map(K):[],de=Se.split(":").map(K),Pe=A.IPV4ADDRESS.test(de[de.length-1]),Oe=Pe?7:8,qe=de.length-Oe,$e=Array(Oe),He=0;He<Oe;++He)$e[He]=Be[He]||de[qe+He]||"";Pe&&($e[Oe-1]=I($e[Oe-1],A));var pt=$e.reduce(function(St,Ct,li){if(!Ct||Ct==="0"){var Dt=St[St.length-1];Dt&&Dt.index+Dt.length===li?Dt.length++:St.push({index:li,length:1})}return St},[]).sort(function(St,Ct){return Ct.length-St.length})[0],bt=void 0;if(pt&&pt.length>1){var oi=$e.slice(0,pt.index),ai=$e.slice(pt.index+pt.length);bt=oi.join(":")+"::"+ai.join(":")}else bt=$e.join(":");return ee&&(bt+="%"+ee),bt}return k}var L=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,$="".match(/(){0}/)[1]===void 0;function _(k){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={},q=A.iri!==!1?f:u;A.reference==="suffix"&&(k=(A.scheme?A.scheme+":":"")+"//"+k);var H=k.match(L);if(H){$?(E.scheme=H[1],E.userinfo=H[3],E.host=H[4],E.port=parseInt(H[5],10),E.path=H[6]||"",E.query=H[7],E.fragment=H[8],isNaN(E.port)&&(E.port=H[5])):(E.scheme=H[1]||void 0,E.userinfo=k.indexOf("@")!==-1?H[3]:void 0,E.host=k.indexOf("//")!==-1?H[4]:void 0,E.port=parseInt(H[5],10),E.path=H[6]||"",E.query=k.indexOf("?")!==-1?H[7]:void 0,E.fragment=k.indexOf("#")!==-1?H[8]:void 0,isNaN(E.port)&&(E.port=k.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?H[4]:void 0)),E.host&&(E.host=G(I(E.host,q),q)),E.reference=E.scheme!==void 0||E.userinfo!==void 0||E.host!==void 0||E.port!==void 0||E.path||E.query!==void 0?E.scheme===void 0?"relative":E.fragment===void 0?"absolute":"uri":"same-document",A.reference&&A.reference!=="suffix"&&A.reference!==E.reference&&(E.error=E.error||"URI is not a "+A.reference+" reference.");var ee=Y[(A.scheme||E.scheme||"").toLowerCase()];if(A.unicodeSupport||ee&&ee.unicodeSupport)fe(E,q);else{if(E.host&&(A.domainHost||ee&&ee.domainHost))try{E.host=F(E.host.replace(q.PCT_ENCODED,le).toLowerCase())}catch(ve){E.error=E.error||"Host's domain name can not be converted to ASCII via punycode: "+ve}fe(E,u)}ee&&ee.parse&&ee.parse(E,A)}else E.error=E.error||"URI can not be parsed.";return E}function v(k,A){var E=A.iri!==!1?f:u,q=[];return k.userinfo!==void 0&&(q.push(k.userinfo),q.push("@")),k.host!==void 0&&q.push(G(I(String(k.host),E),E).replace(E.IPV6ADDRESS,function(H,ee,ve){return"["+ee+(ve?"%25"+ve:"")+"]"})),typeof k.port!="number"&&typeof k.port!="string"||(q.push(":"),q.push(String(k.port))),q.length?q.join(""):void 0}var P=/^\.\.?\//,V=/^\/\.(\/|$)/,J=/^\/\.\.(\/|$)/,ne=/^\/?(?:.|\n)*?(?=\/|$)/;function ce(k){for(var A=[];k.length;)if(k.match(P))k=k.replace(P,"");else if(k.match(V))k=k.replace(V,"/");else if(k.match(J))k=k.replace(J,"/"),A.pop();else if(k==="."||k==="..")k="";else{var E=k.match(ne);if(!E)throw new Error("Unexpected dot segment condition");var q=E[0];k=k.slice(q.length),A.push(q)}return A.join("")}function ye(k){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=A.iri?f:u,q=[],H=Y[(A.scheme||k.scheme||"").toLowerCase()];if(H&&H.serialize&&H.serialize(k,A),k.host&&!E.IPV6ADDRESS.test(k.host)){if(A.domainHost||H&&H.domainHost)try{k.host=A.iri?se(k.host):F(k.host.replace(E.PCT_ENCODED,le).toLowerCase())}catch(be){k.error=k.error||"Host's domain name can not be converted to "+(A.iri?"Unicode":"ASCII")+" via punycode: "+be}}fe(k,E),A.reference!=="suffix"&&k.scheme&&(q.push(k.scheme),q.push(":"));var ee=v(k,A);if(ee!==void 0&&(A.reference!=="suffix"&&q.push("//"),q.push(ee),k.path&&k.path.charAt(0)!=="/"&&q.push("/")),k.path!==void 0){var ve=k.path;A.absolutePath||H&&H.absolutePath||(ve=ce(ve)),ee===void 0&&(ve=ve.replace(/^\/\//,"/%2F")),q.push(ve)}return k.query!==void 0&&(q.push("?"),q.push(k.query)),k.fragment!==void 0&&(q.push("#"),q.push(k.fragment)),q.join("")}function we(k,A){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},q=arguments[3],H={};return q||(k=_(ye(k,E),E),A=_(ye(A,E),E)),!(E=E||{}).tolerant&&A.scheme?(H.scheme=A.scheme,H.userinfo=A.userinfo,H.host=A.host,H.port=A.port,H.path=ce(A.path||""),H.query=A.query):(A.userinfo!==void 0||A.host!==void 0||A.port!==void 0?(H.userinfo=A.userinfo,H.host=A.host,H.port=A.port,H.path=ce(A.path||""),H.query=A.query):(A.path?(A.path.charAt(0)==="/"?H.path=ce(A.path):(H.path=k.userinfo===void 0&&k.host===void 0&&k.port===void 0||k.path?k.path?k.path.slice(0,k.path.lastIndexOf("/")+1)+A.path:A.path:"/"+A.path,H.path=ce(H.path)),H.query=A.query):(H.path=k.path,H.query=A.query!==void 0?A.query:k.query),H.userinfo=k.userinfo,H.host=k.host,H.port=k.port),H.scheme=k.scheme),H.fragment=A.fragment,H}function me(k,A){return k&&k.toString().replace(A&&A.iri?f.PCT_ENCODED:u.PCT_ENCODED,le)}var Re={scheme:"http",domainHost:!0,parse(k,A){return k.host||(k.error=k.error||"HTTP URIs must have a host."),k},serialize(k,A){var E=String(k.scheme).toLowerCase()==="https";return k.port!==(E?443:80)&&k.port!==""||(k.port=void 0),k.path||(k.path="/"),k}},et={scheme:"https",domainHost:Re.domainHost,parse:Re.parse,serialize:Re.serialize};function vt(k){return typeof k.secure=="boolean"?k.secure:String(k.scheme).toLowerCase()==="wss"}var at={scheme:"ws",domainHost:!0,parse(k,A){var E=k;return E.secure=vt(E),E.resourceName=(E.path||"/")+(E.query?"?"+E.query:""),E.path=void 0,E.query=void 0,E},serialize(k,A){if(k.port!==(vt(k)?443:80)&&k.port!==""||(k.port=void 0),typeof k.secure=="boolean"&&(k.scheme=k.secure?"wss":"ws",k.secure=void 0),k.resourceName){var E=k.resourceName.split("?"),q=p(E,2),H=q[0],ee=q[1];k.path=H&&H!=="/"?H:void 0,k.query=ee,k.resourceName=void 0}return k.fragment=void 0,k}},ut={scheme:"wss",domainHost:at.domainHost,parse:at.parse,serialize:at.serialize},ue={},xt="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",lt="[0-9A-Fa-f]",Ht=a(a("%[EFef][0-9A-Fa-f]%"+lt+lt+"%"+lt+lt)+"|"+a("%[89A-Fa-f][0-9A-Fa-f]%"+lt+lt)+"|"+a("%"+lt+lt)),ni=o("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),si=new RegExp(xt,"g"),wt=new RegExp(Ht,"g"),b=new RegExp(o("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',ni),"g"),O=new RegExp(o("[^]",xt,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),M=O;function j(k){var A=le(k);return A.match(si)?A:k}var U={scheme:"mailto",parse(k,A){var E=k,q=E.to=E.path?E.path.split(","):[];if(E.path=void 0,E.query){for(var H=!1,ee={},ve=E.query.split("&"),be=0,Se=ve.length;be<Se;++be){var _e=ve[be].split("=");switch(_e[0]){case"to":for(var Be=_e[1].split(","),de=0,Pe=Be.length;de<Pe;++de)q.push(Be[de]);break;case"subject":E.subject=me(_e[1],A);break;case"body":E.body=me(_e[1],A);break;default:H=!0,ee[me(_e[0],A)]=me(_e[1],A)}}H&&(E.headers=ee)}E.query=void 0;for(var Oe=0,qe=q.length;Oe<qe;++Oe){var $e=q[Oe].split("@");if($e[0]=me($e[0]),A.unicodeSupport)$e[1]=me($e[1],A).toLowerCase();else try{$e[1]=F(me($e[1],A).toLowerCase())}catch(He){E.error=E.error||"Email address's domain name can not be converted to ASCII via punycode: "+He}q[Oe]=$e.join("@")}return E},serialize(k,A){var E,q=k,H=(E=k.to)!=null?E instanceof Array?E:typeof E.length!="number"||E.split||E.setInterval||E.call?[E]:Array.prototype.slice.call(E):[];if(H){for(var ee=0,ve=H.length;ee<ve;++ee){var be=String(H[ee]),Se=be.lastIndexOf("@"),_e=be.slice(0,Se).replace(wt,j).replace(wt,h).replace(b,ie),Be=be.slice(Se+1);try{Be=A.iri?se(Be):F(me(Be,A).toLowerCase())}catch(qe){q.error=q.error||"Email address's domain name can not be converted to "+(A.iri?"Unicode":"ASCII")+" via punycode: "+qe}H[ee]=_e+"@"+Be}q.path=H.join(",")}var de=k.headers=k.headers||{};k.subject&&(de.subject=k.subject),k.body&&(de.body=k.body);var Pe=[];for(var Oe in de)de[Oe]!==ue[Oe]&&Pe.push(Oe.replace(wt,j).replace(wt,h).replace(O,ie)+"="+de[Oe].replace(wt,j).replace(wt,h).replace(M,ie));return Pe.length&&(q.query=Pe.join("&")),q}},re=/^([^\:]+)\:(.*)/,ge={scheme:"urn",parse(k,A){var E=k.path&&k.path.match(re),q=k;if(E){var H=A.scheme||q.scheme||"urn",ee=E[1].toLowerCase(),ve=E[2],be=Y[H+":"+(A.nid||ee)];q.nid=ee,q.nss=ve,q.path=void 0,be&&(q=be.parse(q,A))}else q.error=q.error||"URN can not be parsed.";return q},serialize(k,A){var E=k.nid,q=Y[(A.scheme||k.scheme||"urn")+":"+(A.nid||E)];q&&(k=q.serialize(k,A));var H=k;return H.path=(E||A.nid)+":"+k.nss,H}},ke=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Ge={scheme:"urn:uuid",parse(k,A){var E=k;return E.uuid=E.nss,E.nss=void 0,A.tolerant||E.uuid&&E.uuid.match(ke)||(E.error=E.error||"UUID is not valid."),E},serialize(k,A){var E=k;return E.nss=(k.uuid||"").toLowerCase(),E}};Y[Re.scheme]=Re,Y[et.scheme]=et,Y[at.scheme]=at,Y[ut.scheme]=ut,Y[U.scheme]=U,Y[ge.scheme]=ge,Y[Ge.scheme]=Ge,s.SCHEMES=Y,s.pctEncChar=ie,s.pctDecChars=le,s.parse=_,s.removeDotSegments=ce,s.serialize=ye,s.resolveComponents=we,s.resolve=function(k,A,E){var q=function(H,ee){var ve=H;if(ee)for(var be in ee)ve[be]=ee[be];return ve}({scheme:"null"},E);return ye(we(_(k,q),_(A,q),q,!0),q)},s.normalize=function(k,A){return typeof k=="string"?k=ye(_(k,A),A):l(k)==="object"&&(k=_(ye(k,A),A)),k},s.equal=function(k,A,E){return typeof k=="string"?k=ye(_(k,E),E):l(k)==="object"&&(k=ye(k,E)),typeof A=="string"?A=ye(_(A,E),E):l(A)==="object"&&(A=ye(A,E)),k===A},s.escapeComponent=function(k,A){return k&&k.toString().replace(A&&A.iri?f.ESCAPE:u.ESCAPE,ie)},s.unescapeComponent=me,Object.defineProperty(s,"__esModule",{value:!0})})},{}],ajv:[function(t,r,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CodeGen=i.Name=i.nil=i.stringify=i.str=i._=i.KeywordCxt=void 0;const s=t("./core"),o=t("./vocabularies/draft7"),a=t("./vocabularies/discriminator"),l=t("./refs/json-schema-draft-07.json"),h=["/properties"],c="http://json-schema.org/draft-07/schema";class u extends s.default{_addVocabularies(){super._addVocabularies(),o.default.forEach(g=>this.addVocabulary(g)),this.opts.discriminator&&this.addKeyword(a.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const g=this.opts.$data?this.$dataMetaSchema(l,h):l;this.addMetaSchema(g,c,!1),this.refs["http://json-schema.org/schema"]=c}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(c)?c:void 0)}}r.exports=i=u,Object.defineProperty(i,"__esModule",{value:!0}),i.default=u;var f=t("./compile/validate");Object.defineProperty(i,"KeywordCxt",{enumerable:!0,get(){return f.KeywordCxt}});var p=t("./compile/codegen");Object.defineProperty(i,"_",{enumerable:!0,get(){return p._}}),Object.defineProperty(i,"str",{enumerable:!0,get(){return p.str}}),Object.defineProperty(i,"stringify",{enumerable:!0,get(){return p.stringify}}),Object.defineProperty(i,"nil",{enumerable:!0,get(){return p.nil}}),Object.defineProperty(i,"Name",{enumerable:!0,get(){return p.Name}}),Object.defineProperty(i,"CodeGen",{enumerable:!0,get(){return p.CodeGen}})},{"./compile/codegen":2,"./compile/validate":15,"./core":18,"./refs/json-schema-draft-07.json":20,"./vocabularies/discriminator":46,"./vocabularies/draft7":48}]},{},[])("ajv")})})(rp);var np={};(function(n){(function(e){function t(b){return b!==null?Object.prototype.toString.call(b)==="[object Array]":!1}function r(b){return b!==null?Object.prototype.toString.call(b)==="[object Object]":!1}function i(b,O){if(b===O)return!0;var M=Object.prototype.toString.call(b);if(M!==Object.prototype.toString.call(O))return!1;if(t(b)===!0){if(b.length!==O.length)return!1;for(var j=0;j<b.length;j++)if(i(b[j],O[j])===!1)return!1;return!0}if(r(b)===!0){var U={};for(var re in b)if(hasOwnProperty.call(b,re)){if(i(b[re],O[re])===!1)return!1;U[re]=!0}for(var ge in O)if(hasOwnProperty.call(O,ge)&&U[ge]!==!0)return!1;return!0}return!1}function s(b){if(b===""||b===!1||b===null)return!0;if(t(b)&&b.length===0)return!0;if(r(b)){for(var O in b)if(b.hasOwnProperty(O))return!1;return!0}else return!1}function o(b){for(var O=Object.keys(b),M=[],j=0;j<O.length;j++)M.push(b[O[j]]);return M}var a;typeof String.prototype.trimLeft=="function"?a=function(b){return b.trimLeft()}:a=function(b){return b.match(/^\s*(.*)/)[1]};var l=0,h=1,c=2,u=3,f=4,p=5,d=6,g=7,S=8,m=9,y={0:"number",1:"any",2:"string",3:"array",4:"object",5:"boolean",6:"expression",7:"null",8:"Array<number>",9:"Array<string>"},w="EOF",x="UnquotedIdentifier",C="QuotedIdentifier",T="Rbracket",N="Rparen",z="Comma",D="Colon",R="Rbrace",W="Number",B="Current",F="Expref",se="Pipe",Y="Or",ie="And",le="EQ",fe="GT",K="LT",I="GTE",G="LTE",L="NE",$="Flatten",_="Star",v="Filter",P="Dot",V="Not",J="Lbrace",ne="Lbracket",ce="Lparen",ye="Literal",we={".":P,"*":_,",":z,":":D,"{":J,"}":R,"]":T,"(":ce,")":N,"@":B},me={"<":!0,">":!0,"=":!0,"!":!0},Re={" ":!0,"	":!0,"\n":!0};function et(b){return b>="a"&&b<="z"||b>="A"&&b<="Z"||b==="_"}function vt(b){return b>="0"&&b<="9"||b==="-"}function at(b){return b>="a"&&b<="z"||b>="A"&&b<="Z"||b>="0"&&b<="9"||b==="_"}function ut(){}ut.prototype={tokenize:function(b){var O=[];this._current=0;for(var M,j,U;this._current<b.length;)if(et(b[this._current]))M=this._current,j=this._consumeUnquotedIdentifier(b),O.push({type:x,value:j,start:M});else if(we[b[this._current]]!==void 0)O.push({type:we[b[this._current]],value:b[this._current],start:this._current}),this._current++;else if(vt(b[this._current]))U=this._consumeNumber(b),O.push(U);else if(b[this._current]==="[")U=this._consumeLBracket(b),O.push(U);else if(b[this._current]==='"')M=this._current,j=this._consumeQuotedIdentifier(b),O.push({type:C,value:j,start:M});else if(b[this._current]==="'")M=this._current,j=this._consumeRawStringLiteral(b),O.push({type:ye,value:j,start:M});else if(b[this._current]==="`"){M=this._current;var re=this._consumeLiteral(b);O.push({type:ye,value:re,start:M})}else if(me[b[this._current]]!==void 0)O.push(this._consumeOperator(b));else if(Re[b[this._current]]!==void 0)this._current++;else if(b[this._current]==="&")M=this._current,this._current++,b[this._current]==="&"?(this._current++,O.push({type:ie,value:"&&",start:M})):O.push({type:F,value:"&",start:M});else if(b[this._current]==="|")M=this._current,this._current++,b[this._current]==="|"?(this._current++,O.push({type:Y,value:"||",start:M})):O.push({type:se,value:"|",start:M});else{var ge=new Error("Unknown character:"+b[this._current]);throw ge.name="LexerError",ge}return O},_consumeUnquotedIdentifier:function(b){var O=this._current;for(this._current++;this._current<b.length&&at(b[this._current]);)this._current++;return b.slice(O,this._current)},_consumeQuotedIdentifier:function(b){var O=this._current;this._current++;for(var M=b.length;b[this._current]!=='"'&&this._current<M;){var j=this._current;b[j]==="\\"&&(b[j+1]==="\\"||b[j+1]==='"')?j+=2:j++,this._current=j}return this._current++,JSON.parse(b.slice(O,this._current))},_consumeRawStringLiteral:function(b){var O=this._current;this._current++;for(var M=b.length;b[this._current]!=="'"&&this._current<M;){var j=this._current;b[j]==="\\"&&(b[j+1]==="\\"||b[j+1]==="'")?j+=2:j++,this._current=j}this._current++;var U=b.slice(O+1,this._current-1);return U.replace("\\'","'")},_consumeNumber:function(b){var O=this._current;this._current++;for(var M=b.length;vt(b[this._current])&&this._current<M;)this._current++;var j=parseInt(b.slice(O,this._current));return{type:W,value:j,start:O}},_consumeLBracket:function(b){var O=this._current;return this._current++,b[this._current]==="?"?(this._current++,{type:v,value:"[?",start:O}):b[this._current]==="]"?(this._current++,{type:$,value:"[]",start:O}):{type:ne,value:"[",start:O}},_consumeOperator:function(b){var O=this._current,M=b[O];if(this._current++,M==="!")return b[this._current]==="="?(this._current++,{type:L,value:"!=",start:O}):{type:V,value:"!",start:O};if(M==="<")return b[this._current]==="="?(this._current++,{type:G,value:"<=",start:O}):{type:K,value:"<",start:O};if(M===">")return b[this._current]==="="?(this._current++,{type:I,value:">=",start:O}):{type:fe,value:">",start:O};if(M==="="&&b[this._current]==="=")return this._current++,{type:le,value:"==",start:O}},_consumeLiteral:function(b){this._current++;for(var O=this._current,M=b.length,j;b[this._current]!=="`"&&this._current<M;){var U=this._current;b[U]==="\\"&&(b[U+1]==="\\"||b[U+1]==="`")?U+=2:U++,this._current=U}var re=a(b.slice(O,this._current));return re=re.replace("\\`","`"),this._looksLikeJSON(re)?j=JSON.parse(re):j=JSON.parse('"'+re+'"'),this._current++,j},_looksLikeJSON:function(b){var O='[{"',M=["true","false","null"],j="-0123456789";if(b==="")return!1;if(O.indexOf(b[0])>=0)return!0;if(M.indexOf(b)>=0)return!0;if(j.indexOf(b[0])>=0)try{return JSON.parse(b),!0}catch{return!1}else return!1}};var ue={};ue[w]=0,ue[x]=0,ue[C]=0,ue[T]=0,ue[N]=0,ue[z]=0,ue[R]=0,ue[W]=0,ue[B]=0,ue[F]=0,ue[se]=1,ue[Y]=2,ue[ie]=3,ue[le]=5,ue[fe]=5,ue[K]=5,ue[I]=5,ue[G]=5,ue[L]=5,ue[$]=9,ue[_]=20,ue[v]=21,ue[P]=40,ue[V]=45,ue[J]=50,ue[ne]=55,ue[ce]=60;function xt(){}xt.prototype={parse:function(b){this._loadTokens(b),this.index=0;var O=this.expression(0);if(this._lookahead(0)!==w){var M=this._lookaheadToken(0),j=new Error("Unexpected token type: "+M.type+", value: "+M.value);throw j.name="ParserError",j}return O},_loadTokens:function(b){var O=new ut,M=O.tokenize(b);M.push({type:w,value:"",start:b.length}),this.tokens=M},expression:function(b){var O=this._lookaheadToken(0);this._advance();for(var M=this.nud(O),j=this._lookahead(0);b<ue[j];)this._advance(),M=this.led(j,M),j=this._lookahead(0);return M},_lookahead:function(b){return this.tokens[this.index+b].type},_lookaheadToken:function(b){return this.tokens[this.index+b]},_advance:function(){this.index++},nud:function(b){var O,M,j;switch(b.type){case ye:return{type:"Literal",value:b.value};case x:return{type:"Field",name:b.value};case C:var U={type:"Field",name:b.value};if(this._lookahead(0)===ce)throw new Error("Quoted identifier not allowed for function names.");return U;case V:return M=this.expression(ue.Not),{type:"NotExpression",children:[M]};case _:return O={type:"Identity"},M=null,this._lookahead(0)===T?M={type:"Identity"}:M=this._parseProjectionRHS(ue.Star),{type:"ValueProjection",children:[O,M]};case v:return this.led(b.type,{type:"Identity"});case J:return this._parseMultiselectHash();case $:return O={type:$,children:[{type:"Identity"}]},M=this._parseProjectionRHS(ue.Flatten),{type:"Projection",children:[O,M]};case ne:return this._lookahead(0)===W||this._lookahead(0)===D?(M=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},M)):this._lookahead(0)===_&&this._lookahead(1)===T?(this._advance(),this._advance(),M=this._parseProjectionRHS(ue.Star),{type:"Projection",children:[{type:"Identity"},M]}):this._parseMultiselectList();case B:return{type:B};case F:return j=this.expression(ue.Expref),{type:"ExpressionReference",children:[j]};case ce:for(var re=[];this._lookahead(0)!==N;)this._lookahead(0)===B?(j={type:B},this._advance()):j=this.expression(0),re.push(j);return this._match(N),re[0];default:this._errorToken(b)}},led:function(b,O){var M;switch(b){case P:var j=ue.Dot;return this._lookahead(0)!==_?(M=this._parseDotRHS(j),{type:"Subexpression",children:[O,M]}):(this._advance(),M=this._parseProjectionRHS(j),{type:"ValueProjection",children:[O,M]});case se:return M=this.expression(ue.Pipe),{type:se,children:[O,M]};case Y:return M=this.expression(ue.Or),{type:"OrExpression",children:[O,M]};case ie:return M=this.expression(ue.And),{type:"AndExpression",children:[O,M]};case ce:for(var U=O.name,re=[],ge,ke;this._lookahead(0)!==N;)this._lookahead(0)===B?(ge={type:B},this._advance()):ge=this.expression(0),this._lookahead(0)===z&&this._match(z),re.push(ge);return this._match(N),ke={type:"Function",name:U,children:re},ke;case v:var Ge=this.expression(0);return this._match(T),this._lookahead(0)===$?M={type:"Identity"}:M=this._parseProjectionRHS(ue.Filter),{type:"FilterProjection",children:[O,M,Ge]};case $:var k={type:$,children:[O]},A=this._parseProjectionRHS(ue.Flatten);return{type:"Projection",children:[k,A]};case le:case L:case fe:case I:case K:case G:return this._parseComparator(O,b);case ne:var E=this._lookaheadToken(0);return E.type===W||E.type===D?(M=this._parseIndexExpression(),this._projectIfSlice(O,M)):(this._match(_),this._match(T),M=this._parseProjectionRHS(ue.Star),{type:"Projection",children:[O,M]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(b){if(this._lookahead(0)===b)this._advance();else{var O=this._lookaheadToken(0),M=new Error("Expected "+b+", got: "+O.type);throw M.name="ParserError",M}},_errorToken:function(b){var O=new Error("Invalid token ("+b.type+'): "'+b.value+'"');throw O.name="ParserError",O},_parseIndexExpression:function(){if(this._lookahead(0)===D||this._lookahead(1)===D)return this._parseSliceExpression();var b={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match(T),b},_projectIfSlice:function(b,O){var M={type:"IndexExpression",children:[b,O]};return O.type==="Slice"?{type:"Projection",children:[M,this._parseProjectionRHS(ue.Star)]}:M},_parseSliceExpression:function(){for(var b=[null,null,null],O=0,M=this._lookahead(0);M!==T&&O<3;){if(M===D)O++,this._advance();else if(M===W)b[O]=this._lookaheadToken(0).value,this._advance();else{var j=this._lookahead(0),U=new Error("Syntax error, unexpected token: "+j.value+"("+j.type+")");throw U.name="Parsererror",U}M=this._lookahead(0)}return this._match(T),{type:"Slice",children:b}},_parseComparator:function(b,O){var M=this.expression(ue[O]);return{type:"Comparator",name:O,children:[b,M]}},_parseDotRHS:function(b){var O=this._lookahead(0),M=[x,C,_];if(M.indexOf(O)>=0)return this.expression(b);if(O===ne)return this._match(ne),this._parseMultiselectList();if(O===J)return this._match(J),this._parseMultiselectHash()},_parseProjectionRHS:function(b){var O;if(ue[this._lookahead(0)]<10)O={type:"Identity"};else if(this._lookahead(0)===ne)O=this.expression(b);else if(this._lookahead(0)===v)O=this.expression(b);else if(this._lookahead(0)===P)this._match(P),O=this._parseDotRHS(b);else{var M=this._lookaheadToken(0),j=new Error("Sytanx error, unexpected token: "+M.value+"("+M.type+")");throw j.name="ParserError",j}return O},_parseMultiselectList:function(){for(var b=[];this._lookahead(0)!==T;){var O=this.expression(0);if(b.push(O),this._lookahead(0)===z&&(this._match(z),this._lookahead(0)===T))throw new Error("Unexpected token Rbracket")}return this._match(T),{type:"MultiSelectList",children:b}},_parseMultiselectHash:function(){for(var b=[],O=[x,C],M,j,U,re;;){if(M=this._lookaheadToken(0),O.indexOf(M.type)<0)throw new Error("Expecting an identifier token, got: "+M.type);if(j=M.value,this._advance(),this._match(D),U=this.expression(0),re={type:"KeyValuePair",name:j,value:U},b.push(re),this._lookahead(0)===z)this._match(z);else if(this._lookahead(0)===R){this._match(R);break}}return{type:"MultiSelectHash",children:b}}};function lt(b){this.runtime=b}lt.prototype={search:function(b,O){return this.visit(b,O)},visit:function(b,O){var M,j,U,re,ge,ke,Ge,k,A,E;switch(b.type){case"Field":return O!==null&&r(O)?(ke=O[b.name],ke===void 0?null:ke):null;case"Subexpression":for(U=this.visit(b.children[0],O),E=1;E<b.children.length;E++)if(U=this.visit(b.children[1],U),U===null)return null;return U;case"IndexExpression":return Ge=this.visit(b.children[0],O),k=this.visit(b.children[1],Ge),k;case"Index":if(!t(O))return null;var q=b.value;return q<0&&(q=O.length+q),U=O[q],U===void 0&&(U=null),U;case"Slice":if(!t(O))return null;var H=b.children.slice(0),ee=this.computeSliceParams(O.length,H),ve=ee[0],be=ee[1],Se=ee[2];if(U=[],Se>0)for(E=ve;E<be;E+=Se)U.push(O[E]);else for(E=ve;E>be;E+=Se)U.push(O[E]);return U;case"Projection":var _e=this.visit(b.children[0],O);if(!t(_e))return null;for(A=[],E=0;E<_e.length;E++)j=this.visit(b.children[1],_e[E]),j!==null&&A.push(j);return A;case"ValueProjection":if(_e=this.visit(b.children[0],O),!r(_e))return null;A=[];var Be=o(_e);for(E=0;E<Be.length;E++)j=this.visit(b.children[1],Be[E]),j!==null&&A.push(j);return A;case"FilterProjection":if(_e=this.visit(b.children[0],O),!t(_e))return null;var de=[],Pe=[];for(E=0;E<_e.length;E++)M=this.visit(b.children[2],_e[E]),s(M)||de.push(_e[E]);for(var Oe=0;Oe<de.length;Oe++)j=this.visit(b.children[1],de[Oe]),j!==null&&Pe.push(j);return Pe;case"Comparator":switch(re=this.visit(b.children[0],O),ge=this.visit(b.children[1],O),b.name){case le:U=i(re,ge);break;case L:U=!i(re,ge);break;case fe:U=re>ge;break;case I:U=re>=ge;break;case K:U=re<ge;break;case G:U=re<=ge;break;default:throw new Error("Unknown comparator: "+b.name)}return U;case $:var qe=this.visit(b.children[0],O);if(!t(qe))return null;var $e=[];for(E=0;E<qe.length;E++)j=qe[E],t(j)?$e.push.apply($e,j):$e.push(j);return $e;case"Identity":return O;case"MultiSelectList":if(O===null)return null;for(A=[],E=0;E<b.children.length;E++)A.push(this.visit(b.children[E],O));return A;case"MultiSelectHash":if(O===null)return null;A={};var He;for(E=0;E<b.children.length;E++)He=b.children[E],A[He.name]=this.visit(He.value,O);return A;case"OrExpression":return M=this.visit(b.children[0],O),s(M)&&(M=this.visit(b.children[1],O)),M;case"AndExpression":return re=this.visit(b.children[0],O),s(re)===!0?re:this.visit(b.children[1],O);case"NotExpression":return re=this.visit(b.children[0],O),s(re);case"Literal":return b.value;case se:return Ge=this.visit(b.children[0],O),this.visit(b.children[1],Ge);case B:return O;case"Function":var pt=[];for(E=0;E<b.children.length;E++)pt.push(this.visit(b.children[E],O));return this.runtime.callFunction(b.name,pt);case"ExpressionReference":var bt=b.children[0];return bt.jmespathType=F,bt;default:throw new Error("Unknown node type: "+b.type)}},computeSliceParams:function(b,O){var M=O[0],j=O[1],U=O[2],re=[null,null,null];if(U===null)U=1;else if(U===0){var ge=new Error("Invalid slice, step cannot be 0");throw ge.name="RuntimeError",ge}var ke=U<0;return M===null?M=ke?b-1:0:M=this.capSliceRange(b,M,U),j===null?j=ke?-1:b:j=this.capSliceRange(b,j,U),re[0]=M,re[1]=j,re[2]=U,re},capSliceRange:function(b,O,M){return O<0?(O+=b,O<0&&(O=M<0?-1:0)):O>=b&&(O=M<0?b-1:b),O}};function Ht(b){this._interpreter=b,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[l]}]},avg:{_func:this._functionAvg,_signature:[{types:[S]}]},ceil:{_func:this._functionCeil,_signature:[{types:[l]}]},contains:{_func:this._functionContains,_signature:[{types:[c,u]},{types:[h]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[c]},{types:[c]}]},floor:{_func:this._functionFloor,_signature:[{types:[l]}]},length:{_func:this._functionLength,_signature:[{types:[c,u,f]}]},map:{_func:this._functionMap,_signature:[{types:[d]},{types:[u]}]},max:{_func:this._functionMax,_signature:[{types:[S,m]}]},merge:{_func:this._functionMerge,_signature:[{types:[f],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[u]},{types:[d]}]},sum:{_func:this._functionSum,_signature:[{types:[S]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[c]},{types:[c]}]},min:{_func:this._functionMin,_signature:[{types:[S,m]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[u]},{types:[d]}]},type:{_func:this._functionType,_signature:[{types:[h]}]},keys:{_func:this._functionKeys,_signature:[{types:[f]}]},values:{_func:this._functionValues,_signature:[{types:[f]}]},sort:{_func:this._functionSort,_signature:[{types:[m,S]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[u]},{types:[d]}]},join:{_func:this._functionJoin,_signature:[{types:[c]},{types:[m]}]},reverse:{_func:this._functionReverse,_signature:[{types:[c,u]}]},to_array:{_func:this._functionToArray,_signature:[{types:[h]}]},to_string:{_func:this._functionToString,_signature:[{types:[h]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[h]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[h],variadic:!0}]}}}Ht.prototype={callFunction:function(b,O){var M=this.functionTable[b];if(M===void 0)throw new Error("Unknown function: "+b+"()");return this._validateArgs(b,O,M._signature),M._func.call(this,O)},_validateArgs:function(b,O,M){var j;if(M[M.length-1].variadic){if(O.length<M.length)throw j=M.length===1?" argument":" arguments",new Error("ArgumentError: "+b+"() takes at least"+M.length+j+" but received "+O.length)}else if(O.length!==M.length)throw j=M.length===1?" argument":" arguments",new Error("ArgumentError: "+b+"() takes "+M.length+j+" but received "+O.length);for(var U,re,ge,ke=0;ke<M.length;ke++){ge=!1,U=M[ke].types,re=this._getTypeName(O[ke]);for(var Ge=0;Ge<U.length;Ge++)if(this._typeMatches(re,U[Ge],O[ke])){ge=!0;break}if(!ge){var k=U.map(function(A){return y[A]}).join(",");throw new Error("TypeError: "+b+"() expected argument "+(ke+1)+" to be type "+k+" but received type "+y[re]+" instead.")}}},_typeMatches:function(b,O,M){if(O===h)return!0;if(O===m||O===S||O===u){if(O===u)return b===u;if(b===u){var j;O===S?j=l:O===m&&(j=c);for(var U=0;U<M.length;U++)if(!this._typeMatches(this._getTypeName(M[U]),j,M[U]))return!1;return!0}}else return b===O},_getTypeName:function(b){switch(Object.prototype.toString.call(b)){case"[object String]":return c;case"[object Number]":return l;case"[object Array]":return u;case"[object Boolean]":return p;case"[object Null]":return g;case"[object Object]":return b.jmespathType===F?d:f}},_functionStartsWith:function(b){return b[0].lastIndexOf(b[1])===0},_functionEndsWith:function(b){var O=b[0],M=b[1];return O.indexOf(M,O.length-M.length)!==-1},_functionReverse:function(b){var O=this._getTypeName(b[0]);if(O===c){for(var M=b[0],j="",U=M.length-1;U>=0;U--)j+=M[U];return j}else{var re=b[0].slice(0);return re.reverse(),re}},_functionAbs:function(b){return Math.abs(b[0])},_functionCeil:function(b){return Math.ceil(b[0])},_functionAvg:function(b){for(var O=0,M=b[0],j=0;j<M.length;j++)O+=M[j];return O/M.length},_functionContains:function(b){return b[0].indexOf(b[1])>=0},_functionFloor:function(b){return Math.floor(b[0])},_functionLength:function(b){return r(b[0])?Object.keys(b[0]).length:b[0].length},_functionMap:function(b){for(var O=[],M=this._interpreter,j=b[0],U=b[1],re=0;re<U.length;re++)O.push(M.visit(j,U[re]));return O},_functionMerge:function(b){for(var O={},M=0;M<b.length;M++){var j=b[M];for(var U in j)O[U]=j[U]}return O},_functionMax:function(b){if(b[0].length>0){var O=this._getTypeName(b[0][0]);if(O===l)return Math.max.apply(Math,b[0]);for(var M=b[0],j=M[0],U=1;U<M.length;U++)j.localeCompare(M[U])<0&&(j=M[U]);return j}else return null},_functionMin:function(b){if(b[0].length>0){var O=this._getTypeName(b[0][0]);if(O===l)return Math.min.apply(Math,b[0]);for(var M=b[0],j=M[0],U=1;U<M.length;U++)M[U].localeCompare(j)<0&&(j=M[U]);return j}else return null},_functionSum:function(b){for(var O=0,M=b[0],j=0;j<M.length;j++)O+=M[j];return O},_functionType:function(b){switch(this._getTypeName(b[0])){case l:return"number";case c:return"string";case u:return"array";case f:return"object";case p:return"boolean";case d:return"expref";case g:return"null"}},_functionKeys:function(b){return Object.keys(b[0])},_functionValues:function(b){for(var O=b[0],M=Object.keys(O),j=[],U=0;U<M.length;U++)j.push(O[M[U]]);return j},_functionJoin:function(b){var O=b[0],M=b[1];return M.join(O)},_functionToArray:function(b){return this._getTypeName(b[0])===u?b[0]:[b[0]]},_functionToString:function(b){return this._getTypeName(b[0])===c?b[0]:JSON.stringify(b[0])},_functionToNumber:function(b){var O=this._getTypeName(b[0]),M;return O===l?b[0]:O===c&&(M=+b[0],!isNaN(M))?M:null},_functionNotNull:function(b){for(var O=0;O<b.length;O++)if(this._getTypeName(b[O])!==g)return b[O];return null},_functionSort:function(b){var O=b[0].slice(0);return O.sort(),O},_functionSortBy:function(b){var O=b[0].slice(0);if(O.length===0)return O;var M=this._interpreter,j=b[1],U=this._getTypeName(M.visit(j,O[0]));if([l,c].indexOf(U)<0)throw new Error("TypeError");for(var re=this,ge=[],ke=0;ke<O.length;ke++)ge.push([ke,O[ke]]);ge.sort(function(k,A){var E=M.visit(j,k[1]),q=M.visit(j,A[1]);if(re._getTypeName(E)!==U)throw new Error("TypeError: expected "+U+", received "+re._getTypeName(E));if(re._getTypeName(q)!==U)throw new Error("TypeError: expected "+U+", received "+re._getTypeName(q));return E>q?1:E<q?-1:k[0]-A[0]});for(var Ge=0;Ge<ge.length;Ge++)O[Ge]=ge[Ge][1];return O},_functionMaxBy:function(b){for(var O=b[1],M=b[0],j=this.createKeyFunction(O,[l,c]),U=-1/0,re,ge,ke=0;ke<M.length;ke++)ge=j(M[ke]),ge>U&&(U=ge,re=M[ke]);return re},_functionMinBy:function(b){for(var O=b[1],M=b[0],j=this.createKeyFunction(O,[l,c]),U=1/0,re,ge,ke=0;ke<M.length;ke++)ge=j(M[ke]),ge<U&&(U=ge,re=M[ke]);return re},createKeyFunction:function(b,O){var M=this,j=this._interpreter,U=function(re){var ge=j.visit(b,re);if(O.indexOf(M._getTypeName(ge))<0){var ke="TypeError: expected one of "+O+", received "+M._getTypeName(ge);throw new Error(ke)}return ge};return U}};function ni(b){var O=new xt,M=O.parse(b);return M}function si(b){var O=new ut;return O.tokenize(b)}function wt(b,O){var M=new xt,j=new Ht,U=new lt(j);j._interpreter=U;var re=M.parse(O);return U.search(re,b)}e.tokenize=si,e.compile=ni,e.search=wt,e.strictDeepEqual=i})(n)})(np);export{fm as $,ar as A,Wn as B,Je as C,We as D,xe as E,he as F,lf as G,ql as H,qp as I,im as J,jt as K,Ti as L,ft as M,Ae as N,Ne as O,hn as P,Hf as Q,mi as R,ho as S,rt as T,tm as U,ot as V,Ft as W,vi as X,nm as Y,sm as Z,Xp as _,ln as a,Lp as a$,Jp as a0,Yp as a1,hm as a2,Bd as a3,dm as a4,pm as a5,Zp as a6,em as a7,Qp as a8,um as a9,Ui as aA,kh as aB,lc as aC,up as aD,yn as aE,Gt as aF,pc as aG,Tp as aH,Rp as aI,Np as aJ,co as aK,jp as aL,Bp as aM,yc as aN,uo as aO,fc as aP,vc as aQ,Op as aR,yp as aS,Cp as aT,xp as aU,Sm as aV,Ep as aW,wp as aX,bp as aY,cc as aZ,gp as a_,td as aa,Yl as ab,yt as ac,Yf as ad,st as ae,it as af,od as ag,Q as ah,am as ai,xs as aj,vd as ak,lm as al,Td as am,cm as an,Up as ao,mm as ap,ap as aq,vm as ar,fp as as,cn as at,Os as au,Fp as av,zn as aw,Sp as ax,_p as ay,kp as az,lr as b,vp as b0,Ip as b1,ip as b2,hp as b3,op as b4,bm as b5,ym as b6,gm as b7,lp as b8,Vp as b9,Ea as ba,sp as bb,Mp as bc,wm as bd,Wp as be,dp as bf,Hp as bg,cp as bh,hc as bi,Ap as bj,Pp as bk,$p as bl,Dp as bm,lo as bn,zp as bo,Sc as bp,mp as bq,pp as br,Fr as c,kt as d,ae as e,Lt as f,nh as g,yd as h,gd as i,Me as j,rh as k,Ns as l,md as m,Ve as n,Pr as o,Eh as p,Rt as q,fa as r,Nt as s,Ee as t,rm as u,Te as v,It as w,Gp as x,Gi as y,Kp as z};
